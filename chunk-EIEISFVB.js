import{a as me}from"./chunk-Z5DH4N3X.js";import{b as L,c as D}from"./chunk-T7UWPKEK.js";import{b as oe,d as se,g as le,o as ce,p as pe,q as de,v as A}from"./chunk-7OTNPXYV.js";import{$ as T,$a as ae,A as _,B as S,C as V,Da as l,Ea as c,F as k,Fa as R,G as Y,Ia as X,K as i,N as F,Pa as Z,Qa as ee,Ra as te,S as $,Sa as ne,T as J,Ta as I,X as C,Y as w,Za as ie,a as N,aa as P,ab as re,ba as b,ca as a,da as r,ea as x,fa as y,ga as f,ha as g,ma as q,na as W,oa as h,pa as s,qa as m,ra as u,sa as E,va as j,wa as O,x as M,xa as B,ya as U,z as v}from"./chunk-4Y4AIMEU.js";function he(o,t){if(o&1&&(a(0,"span",9),s(1),l(2,"translate"),r()),o&2){let n=g();i(),E(" ",n.job.approvalRequests.length," ",c(2,2,"maintenance.pending")," ")}}function be(o,t){if(o&1&&(a(0,"div",13)(1,"div",23)(2,"span",24),s(3),l(4,"translate"),r(),a(5,"span",25),s(6),r()(),a(7,"div",26),x(8,"div",27),r()()),o&2){let n=g();i(3),m(c(4,4,"maintenance.progress")),i(3),u("",n.getTaskProgress(n.job),"%"),i(2),q("width",n.getTaskProgress(n.job),"%")}}function ve(o,t){if(o&1&&(a(0,"p",17),s(1),r()),o&2){let n=g();i(),m(n.job.description)}}function _e(o,t){if(o&1&&(a(0,"span"),s(1),l(2,"translate"),l(3,"date"),r()),o&2){let n=g();i(),E("",c(2,2,"maintenance.completed"),": ",R(3,4,n.job.completionDate,"short"))}}function xe(o,t){if(o&1&&(a(0,"span"),s(1),l(2,"translate"),l(3,"date"),r()),o&2){let n=g();i(),E("",c(2,2,"maintenance.started"),": ",R(3,4,n.job.startDate,"short"))}}function Ce(o,t){if(o&1){let n=y();a(0,"button",20),f("click",function(){v(n);let d=g();return _(d.edit.emit(d.job.id))}),s(1),l(2,"translate"),r()}if(o&2){let n=g();h(n.view==="list"?"btn-warning btn-sm":"flex-1 btn-warning"),i(),u(" ",c(2,3,"maintenance.actions.edit")," ")}}function we(o,t){if(o&1){let n=y();a(0,"button",28),l(1,"translate"),f("click",function(){v(n);let d=g();return _(d.changeStatus("in-progress"))}),S(),a(2,"svg",29),x(3,"path",30),r()()}if(o&2){let n=g();h(n.view==="list"?"btn-success btn-sm btn-icon":"btn-success btn-icon"),b("title",c(1,5,"maintenance.startJob")),i(2),h(n.view==="list"?"w-3 h-3":"w-4 h-4")}}function ye(o,t){if(o&1){let n=y();a(0,"button",28),l(1,"translate"),f("click",function(){v(n);let d=g();return _(d.changeStatus("completed"))}),S(),a(2,"svg",29),x(3,"path",31),r()()}if(o&2){let n=g();h(n.view==="list"?"btn-success btn-sm btn-icon":"btn-success btn-icon"),b("title",c(1,5,"maintenance.completeJob")),i(2),h(n.view==="list"?"w-3 h-3":"w-4 h-4")}}var z=class o{translationService=M(L);job;view="grid";statusChange=new J;edit=new J;viewDetails=new J;getStatusLabel(t){let e={waiting:"waiting","in-progress":"inProgress","waiting-approval":"needsApproval","waiting-parts":"waitingParts",completed:"completed",cancelled:"cancelled"}[t]||"completed";return this.translationService.instant(`maintenance.status.${e}`)}getStatusColor(t){return{waiting:"bg-yellow-400","in-progress":"bg-blue-500","waiting-approval":"bg-orange-500","waiting-parts":"bg-purple-500",completed:"bg-green-500",cancelled:"bg-gray-500"}[t]||"bg-gray-500"}getStatusTextColor(t){return{waiting:"text-yellow-700 dark:text-yellow-300","in-progress":"text-blue-700 dark:text-blue-300","waiting-approval":"text-orange-700 dark:text-orange-300","waiting-parts":"text-purple-700 dark:text-purple-300",completed:"text-green-700 dark:text-green-300",cancelled:"text-gray-700 dark:text-gray-300"}[t]||"text-gray-700 dark:text-gray-300"}getPriorityBadgeClass(t){return{low:"badge badge-priority-low",medium:"badge badge-priority-medium",high:"badge badge-priority-high",urgent:"badge badge-priority-urgent"}[t]||"badge badge-priority-medium"}getTaskProgress(t){if(t.tasks.length===0)return 0;let n=t.tasks.filter(e=>e.status==="completed").length;return Math.round(n/t.tasks.length*100)}formatCurrency(t){return new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND",minimumFractionDigits:0}).format(t)}changeStatus(t){this.statusChange.emit({jobId:this.job.id,status:t})}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=F({type:o,selectors:[["app-maintenance-job-card"]],inputs:{job:"job",view:"view"},outputs:{statusChange:"statusChange",edit:"edit",viewDetails:"viewDetails"},decls:59,vars:51,consts:[[1,"glass-card"],[1,"flex","items-start","justify-between","mb-4"],[1,"flex-1","min-w-0"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-500","dark:text-gray-400","mt-1"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center"],[1,"w-3","h-3","rounded-full","mr-2"],[1,"text-sm","font-medium"],[1,"approval-badge"],[1,"grid","grid-cols-2","gap-4","mb-4"],[1,"text-xs","text-gray-500","dark:text-gray-400","uppercase","tracking-wide"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mb-4"],[1,"grid","grid-cols-2","gap-4","mb-4","text-sm"],[1,"text-gray-500","dark:text-gray-400"],[1,"font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-600","dark:text-gray-300","mb-4"],[1,"flex","justify-between","text-xs","text-gray-500","dark:text-gray-400","mb-4"],[1,"flex","space-x-2"],[3,"click"],[3,"class"],[3,"class","title"],[1,"flex","justify-between","text-sm","mb-1"],[1,"text-gray-600","dark:text-gray-400"],[1,"text-gray-900","dark:text-white"],[1,"w-full","bg-gray-200","dark:bg-gray-700","rounded-full","h-2"],[1,"bg-gradient-to-r","from-blue-500","to-green-500","h-2","rounded-full","transition-all"],[3,"click","title"],["fill","none","viewBox","0 0 24 24","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h8m-3-5h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(n,e){if(n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),s(4),r(),a(5,"p",4),s(6),r()(),a(7,"span"),s(8),l(9,"translate"),r()(),a(10,"div",5)(11,"div",6),x(12,"div",7),a(13,"span",8),s(14),r()(),C(15,he,3,4,"span",9),r(),a(16,"div",10)(17,"div")(18,"p",11),s(19),l(20,"translate"),r(),a(21,"p",12),s(22),r()(),a(23,"div")(24,"p",11),s(25),l(26,"translate"),r(),a(27,"p",12),s(28),r()()(),C(29,be,9,6,"div",13),a(30,"div",14)(31,"div")(32,"p",15),s(33),l(34,"translate"),r(),a(35,"p",16),s(36),l(37,"number"),r()(),a(38,"div")(39,"p",15),s(40),l(41,"translate"),r(),a(42,"p",16),s(43),r()()(),C(44,ve,2,1,"p",17),a(45,"div",18)(46,"span"),s(47),l(48,"translate"),l(49,"date"),r(),C(50,_e,4,7,"span")(51,xe,4,7,"span"),r(),a(52,"div",19)(53,"button",20),f("click",function(){return e.viewDetails.emit(e.job.id)}),s(54),l(55,"translate"),r(),C(56,Ce,3,5,"button",21),C(57,we,4,7,"button",22)(58,ye,4,7,"button",22),r()()),n&2){let d;i(4),u(" ",e.job.jobTitle," "),i(2),E(" ",e.job.carDetails," \u2022 ",e.job.licensePlate," "),i(),h(e.getPriorityBadgeClass(e.job.priority)),i(),u(" ",c(9,32,"maintenance.priority."+e.job.priority)," "),i(4),h(e.getStatusColor(e.job.status)),i(),h(e.getStatusTextColor(e.job.status)),i(),u(" ",e.getStatusLabel(e.job.status)," "),i(),w(e.job.status==="waiting-approval"&&e.job.approvalRequests.length>0?15:-1),i(4),m(c(20,34,"maintenance.customer")),i(3),m(e.job.customerName),i(3),m(c(26,36,"maintenance.mechanic")),i(3),m(e.job.mechanicName),i(),w(e.job.tasks.length>0?29:-1),i(4),m(c(34,38,"maintenance.mileage")),i(3),u("",c(37,40,e.job.currentMileage)," km"),i(4),m(c(41,42,"maintenance.estimatedCost")),i(3),m(e.formatCurrency(e.job.estimatedCost)),i(),w(e.view==="list"||e.job.description.length<100?44:-1),i(3),E("",c(48,44,"maintenance.created"),": ",R(49,46,e.job.createdAt,"short")),i(3),w(e.job.completionDate?50:e.job.startDate?51:-1),i(2),h(e.view==="list"?"justify-end":""),i(),h(e.view==="list"?"btn-tertiary btn-sm":"flex-1 btn-tertiary"),i(),u(" ",c(55,49,"maintenance.actions.viewDetails")," "),i(2),w(e.job.status!=="completed"&&e.job.status!=="cancelled"?56:-1),i(),w((d=e.job.status)==="waiting"?57:d==="in-progress"?58:-1)}},dependencies:[I,ne,te,D],styles:[".glass-card[_ngcontent-%COMP%]{cursor:pointer}.glass-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d1d5db!important}.glass-card[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-400[_ngcontent-%COMP%]{color:#9ca3af!important}.glass-card[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   .text-gray-600[_ngcontent-%COMP%]{color:#d1d5db!important}.approval-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .75rem;font-size:.75rem;font-weight:600;border-radius:16px;background:linear-gradient(135deg,#f59e0be6,#d97706e6)!important;color:#fff!important;border:1px solid rgba(245,158,11,.6)!important;box-shadow:0 2px 8px #f59e0b66;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.8}}"]})};function Me(o,t){if(o&1&&(a(0,"div",6)(1,"div",1)(2,"div",7)(3,"p",3),s(4),l(5,"translate"),r(),a(6,"p",8),s(7),r()()(),a(8,"div",1)(9,"div",7)(10,"p",3),s(11),l(12,"translate"),r(),a(13,"p",8),s(14),r()()(),a(15,"div",1)(16,"div",7)(17,"p",3),s(18),l(19,"translate"),r(),a(20,"p",8),s(21),r()()()()),o&2){let n=g();i(4),m(c(5,6,"maintenance.avgCompletionTime")),i(3),u("",((n.stats==null?null:n.stats.averageCompletionTime)||0).toFixed(1),"h"),i(4),m(c(12,8,"maintenance.revenueToday")),i(3),m(n.formatCurrency((n.stats==null?null:n.stats.revenueToday)||0)),i(4),m(c(19,10,"maintenance.weeklyEfficiency")),i(3),u("",((n.stats==null?null:n.stats.efficiency)||0).toFixed(1),"%")}}var G=class o{stats=null;view="grid";formatCurrency(t){return new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND",minimumFractionDigits:0}).format(t)}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=F({type:o,selectors:[["app-maintenance-stats"]],inputs:{stats:"stats",view:"view"},decls:42,vars:17,consts:[[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"glass-card"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-300"],[1,"text-2xl","font-bold","text-white"],[1,"text-2xl"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mt-4"],[1,"text-center"],[1,"text-xl","font-bold","text-white"]],template:function(n,e){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"p",3),s(5),l(6,"translate"),r(),a(7,"p",4),s(8),r()(),a(9,"div",5),s(10,"\u{1F4CB}"),r()()(),a(11,"div",1)(12,"div",2)(13,"div")(14,"p",3),s(15),l(16,"translate"),r(),a(17,"p",4),s(18),r()(),a(19,"div",5),s(20,"\u23F1\uFE0F"),r()()(),a(21,"div",1)(22,"div",2)(23,"div")(24,"p",3),s(25),l(26,"translate"),r(),a(27,"p",4),s(28),r()(),a(29,"div",5),s(30,"\u2705"),r()()(),a(31,"div",1)(32,"div",2)(33,"div")(34,"p",3),s(35),l(36,"translate"),r(),a(37,"p",4),s(38),r()(),a(39,"div",5),s(40,"\u26A0\uFE0F"),r()()()(),C(41,Me,22,12,"div",6)),n&2&&(i(5),m(c(6,9,"maintenance.totalJobs")),i(3),m((e.stats==null?null:e.stats.totalJobs)||0),i(7),m(c(16,11,"maintenance.activeJobs")),i(3),m((e.stats==null?null:e.stats.activeJobs)||0),i(7),m(c(26,13,"maintenance.completedToday")),i(3),m((e.stats==null?null:e.stats.completedToday)||0),i(7),m(c(36,15,"maintenance.pendingApprovals")),i(3),m((e.stats==null?null:e.stats.pendingApprovals)||0),i(3),w(e.view==="list"||e.view==="dashboard"?41:-1))},dependencies:[I,D],encapsulation:2})};var ge=(o,t)=>t.value,Se=(o,t)=>t.id,ke=(o,t)=>t.key;function Fe(o,t){if(o&1&&(a(0,"option",11),s(1),r()),o&2){let n=t.$implicit,e=g();b("value",n.value),i(),m(e.getStatusLabel(n.value))}}function Te(o,t){if(o&1&&(a(0,"option",11),s(1),r()),o&2){let n=t.$implicit,e=g();b("value",n.value),i(),m(e.getPriorityLabel(n.value))}}function Pe(o,t){if(o&1&&(a(0,"option",11),s(1),r()),o&2){let n=t.$implicit;b("value",n.id),i(),m(n.name)}}function Ee(o,t){if(o&1){let n=y();a(0,"button",17),f("click",function(){let d=v(n).$implicit,p=g();return _(p.applyQuickFilter(d))}),s(1),r()}if(o&2){let n=t.$implicit,e=g();h(e.isQuickFilterActive(n)?"btn-filter-chip active":"btn-filter-chip"),i(),u(" ",e.getQuickFilterLabel(n.key)," ")}}var H=class o{translationService=M(L);filters={};filtersChange=new J;localFilters={};selectedStatus="";selectedPriority="";startDate="";endDate="";statusOptions=[{value:"waiting",key:"waiting"},{value:"in-progress",key:"inProgress"},{value:"waiting-approval",key:"needsApproval"},{value:"waiting-parts",key:"waitingParts"},{value:"completed",key:"completed"},{value:"cancelled",key:"cancelled"}];priorityOptions=[{value:"urgent",key:"urgent"},{value:"high",key:"high"},{value:"medium",key:"medium"},{value:"low",key:"low"}];mechanicOptions=[{id:"mechanic-001",name:"Mohamed Trabelsi"},{id:"mechanic-002",name:"Ali Sassi"},{id:"mechanic-003",name:"Ahmed Bouzid"}];quickFilters=[{key:"highPriority",filter:{priority:["high","urgent"]}},{key:"needsApproval",filter:{status:["waiting-approval"]}},{key:"inProgress",filter:{status:["in-progress"]}},{key:"today",filter:{dateRange:this.getTodayRange()}},{key:"thisWeek",filter:{dateRange:this.getThisWeekRange()}}];ngOnInit(){this.localFilters=N({},this.filters),this.initializeFormFields()}ngOnChanges(){this.localFilters=N({},this.filters),this.initializeFormFields()}initializeFormFields(){this.selectedStatus=this.localFilters.status?.[0]||"",this.selectedPriority=this.localFilters.priority?.[0]||"",this.localFilters.dateRange&&(this.startDate=this.formatDateForInput(this.localFilters.dateRange.start),this.endDate=this.formatDateForInput(this.localFilters.dateRange.end))}onFilterChange(){this.filtersChange.emit(this.localFilters)}onStatusChange(t){t?this.localFilters.status=[t]:delete this.localFilters.status,this.onFilterChange()}onPriorityChange(t){t?this.localFilters.priority=[t]:delete this.localFilters.priority,this.onFilterChange()}onDateRangeChange(){this.startDate&&this.endDate?this.localFilters.dateRange={start:new Date(this.startDate),end:new Date(this.endDate)}:delete this.localFilters.dateRange,this.onFilterChange()}clearFilters(){this.localFilters={},this.selectedStatus="",this.selectedPriority="",this.startDate="",this.endDate="",this.onFilterChange()}applyQuickFilter(t){this.localFilters=N({},t.filter),this.initializeFormFields(),this.onFilterChange()}isQuickFilterActive(t){return t.filter.status?this.localFilters.status?.includes(t.filter.status[0])||!1:t.filter.priority&&this.localFilters.priority?.some(n=>t.filter.priority.includes(n))||!1}getTodayRange(){let t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59);return{start:n,end:e}}getThisWeekRange(){let t=new Date,n=new Date(t);n.setDate(t.getDate()-t.getDay()),n.setHours(0,0,0,0);let e=new Date(n);return e.setDate(n.getDate()+6),e.setHours(23,59,59,999),{start:n,end:e}}formatDateForInput(t){return t.toISOString().split("T")[0]}getStatusLabel(t){let e={waiting:"waiting","in-progress":"inProgress","waiting-approval":"needsApproval","waiting-parts":"waitingParts",completed:"completed",cancelled:"cancelled"}[t]||"completed";return this.translationService.instant(`maintenance.status.${e}`)}getPriorityLabel(t){let e={urgent:"urgent",high:"high",medium:"medium",low:"low"}[t]||"medium";return this.translationService.instant(`maintenance.priority.${e}`)}getQuickFilterLabel(t){return this.translationService.instant(`maintenance.filters.quickFilters.${t}`)}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=F({type:o,selectors:[["app-maintenance-filters"]],inputs:{filters:"filters"},outputs:{filtersChange:"filtersChange"},features:[Y],decls:61,vars:43,consts:[[1,"glass-card"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-medium","text-white"],[1,"btn-clear-filters",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-300","mb-1"],["type","text",1,"form-input",3,"ngModelChange","ngModel","placeholder"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"mt-4","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:text-white","text-sm",3,"ngModelChange","ngModel"],[1,"mt-4","flex","flex-wrap","gap-2"],[3,"class"],[3,"click"]],template:function(n,e){n&1&&(a(0,"div",0)(1,"div",1)(2,"h3",2),s(3),l(4,"translate"),r(),a(5,"button",3),f("click",function(){return e.clearFilters()}),S(),a(6,"svg",4),x(7,"path",5),r(),s(8),l(9,"translate"),r()(),V(),a(10,"div",6)(11,"div")(12,"label",7),s(13),l(14,"translate"),r(),a(15,"input",8),l(16,"translate"),B("ngModelChange",function(p){return O(e.localFilters.searchTerm,p)||(e.localFilters.searchTerm=p),p}),f("ngModelChange",function(){return e.onFilterChange()}),r()(),a(17,"div")(18,"label",7),s(19),l(20,"translate"),r(),a(21,"select",9),B("ngModelChange",function(p){return O(e.selectedStatus,p)||(e.selectedStatus=p),p}),f("ngModelChange",function(p){return e.onStatusChange(p)}),a(22,"option",10),s(23),l(24,"translate"),r(),T(25,Fe,2,2,"option",11,ge),r()(),a(27,"div")(28,"label",7),s(29),l(30,"translate"),r(),a(31,"select",9),B("ngModelChange",function(p){return O(e.selectedPriority,p)||(e.selectedPriority=p),p}),f("ngModelChange",function(p){return e.onPriorityChange(p)}),a(32,"option",10),s(33),l(34,"translate"),r(),T(35,Te,2,2,"option",11,ge),r()(),a(37,"div")(38,"label",7),s(39),l(40,"translate"),r(),a(41,"select",9),B("ngModelChange",function(p){return O(e.localFilters.mechanicId,p)||(e.localFilters.mechanicId=p),p}),f("ngModelChange",function(){return e.onFilterChange()}),a(42,"option",10),s(43),l(44,"translate"),r(),T(45,Pe,2,2,"option",11,Se),r()()(),a(47,"div",12)(48,"div")(49,"label",13),s(50),l(51,"translate"),r(),a(52,"input",14),B("ngModelChange",function(p){return O(e.startDate,p)||(e.startDate=p),p}),f("ngModelChange",function(){return e.onDateRangeChange()}),r()(),a(53,"div")(54,"label",13),s(55),l(56,"translate"),r(),a(57,"input",14),B("ngModelChange",function(p){return O(e.endDate,p)||(e.endDate=p),p}),f("ngModelChange",function(){return e.onDateRangeChange()}),r()()(),a(58,"div",15),T(59,Ee,2,3,"button",16,ke),r()()),n&2&&(i(3),m(c(4,19,"maintenance.filters.title")),i(5),u(" ",c(9,21,"maintenance.filters.clearAll")," "),i(5),u(" ",c(14,23,"maintenance.filters.search")," "),i(2),b("placeholder",U(c(16,25,"maintenance.filters.searchPlaceholder"))),j("ngModel",e.localFilters.searchTerm),i(4),u(" ",c(20,27,"maintenance.filters.status")," "),i(2),j("ngModel",e.selectedStatus),i(2),m(c(24,29,"maintenance.filters.allStatuses")),i(2),P(e.statusOptions),i(4),u(" ",c(30,31,"maintenance.filters.priority")," "),i(2),j("ngModel",e.selectedPriority),i(2),m(c(34,33,"maintenance.filters.allPriorities")),i(2),P(e.priorityOptions),i(4),u(" ",c(40,35,"maintenance.filters.mechanic")," "),i(2),j("ngModel",e.localFilters.mechanicId),i(2),m(c(44,37,"maintenance.filters.allMechanics")),i(2),P(e.mechanicOptions),i(5),u(" ",c(51,39,"maintenance.filters.fromDate")," "),i(2),j("ngModel",e.startDate),i(3),u(" ",c(56,41,"maintenance.filters.toDate")," "),i(2),j("ngModel",e.endDate),i(2),P(e.quickFilters))},dependencies:[I,A,pe,de,oe,ce,se,le,D],styles:[".glass-card[_ngcontent-%COMP%]{background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.6);border-radius:20px;padding:1.5rem;box-shadow:0 8px 32px #000000b3;transition:all .3s cubic-bezier(.4,0,.2,1);margin-bottom:1rem}.glass-card[_ngcontent-%COMP%]:hover{background:#1f2937fa;box-shadow:0 12px 40px #000c;border-color:#3b82f6b3;transform:translateY(-2px)}.glass-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   .text-gray-700[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-600[_ngcontent-%COMP%]{color:#d1d5db!important}.glass-card[_ngcontent-%COMP%]   .text-gray-300[_ngcontent-%COMP%]{color:#9ca3af!important}"]})};var Ie=(o,t)=>t.value,De=(o,t)=>t.id;function je(o,t){if(o&1){let n=y();a(0,"div",21)(1,"app-maintenance-filters",22),f("filtersChange",function(d){v(n);let p=g();return _(p.onFiltersChange(d))}),r()()}if(o&2){let n=g();i(),b("filters",n.filters())}}function Oe(o,t){if(o&1){let n=y();a(0,"button",23),f("click",function(){let d=v(n).$implicit,p=g();return _(p.setView(d.value))}),s(1),l(2,"titlecase"),l(3,"translate"),r()}if(o&2){let n=t.$implicit,e=g();W("active",e.currentView()===n.value),i(),u(" ",c(3,5,"maintenance.view"+c(2,3,n.value))," ")}}function Be(o,t){o&1&&(a(0,"div",19),S(),a(1,"svg",24),x(2,"path",25),r(),V(),a(3,"h3",26),s(4),l(5,"translate"),r(),a(6,"p",27),s(7),l(8,"translate"),r()()),o&2&&(i(4),m(c(5,2,"maintenance.noJobs")),i(3),m(c(8,4,"maintenance.noJobsMessage")))}function Ve(o,t){if(o&1){let n=y();a(0,"app-maintenance-job-card",30),f("statusChange",function(d){v(n);let p=g(2);return _(p.onStatusChange(d))})("edit",function(d){v(n);let p=g(2);return _(p.editJob(d))})("viewDetails",function(d){v(n);let p=g(2);return _(p.viewJob(d))}),r()}if(o&2){let n=t.$implicit,e=g(2);b("job",n)("view",e.getViewForCard())}}function Je(o,t){if(o&1&&(a(0,"div",28),T(1,Ve,1,2,"app-maintenance-job-card",29,De),r()),o&2){let n=g();h(n.getGridClasses()),i(),P(n.filteredJobs())}}var ue=class o{maintenanceService=M(me);router=M(ae);route=M(ie);translationService=M(L);maintenanceJobs=k([]);stats=k(null);filters=k({});showFilters=k(!1);currentView=k("grid");loading=k(!1);isMobile=k(!1);viewOptions=[{value:"grid",label:"Grid"},{value:"list",label:"List"}];filteredJobs=X(()=>{let t=this.maintenanceJobs(),n=this.filters(),e=this.getViewFilter(),d=t.filter(p=>!(e.status&&!e.status.includes(p.status)));return this.applyAdditionalFilters(d,n)});ngOnInit(){this.loadMaintenanceData(),this.loadStats(),this.checkMobileView();let t=this.route.snapshot.url[1]?.path;t&&this.setViewFromRoute(t),typeof window<"u"&&window.addEventListener("resize",()=>this.checkMobileView())}checkMobileView(){typeof window<"u"&&this.isMobile.set(window.innerWidth<1024)}loadMaintenanceData(){this.loading.set(!0),this.maintenanceService.getMaintenanceJobs(this.filters()).subscribe({next:t=>{this.maintenanceJobs.set(t),this.loading.set(!1)},error:t=>{console.error("Error loading maintenance jobs:",t),this.loading.set(!1)}})}loadStats(){this.maintenanceService.getMaintenanceStats().subscribe({next:t=>this.stats.set(t),error:t=>console.error("Error loading stats:",t)})}setViewFromRoute(t){switch(t){case"active":this.filters.set({status:["waiting","in-progress","waiting-approval","waiting-parts"]});break;case"history":this.filters.set({status:["completed"]}),this.currentView.set("list");break;case"schedule":this.filters.set({status:["waiting"]});break}}getViewFilter(){switch(this.route.snapshot.url[1]?.path){case"active":return{status:["waiting","in-progress","waiting-approval","waiting-parts"]};case"history":return{status:["completed","cancelled"]};case"schedule":return{status:["waiting"]};default:return{}}}applyAdditionalFilters(t,n){return t.filter(e=>{if(n.priority&&n.priority.length>0&&!n.priority.includes(e.priority)||n.mechanicId&&e.mechanicId!==n.mechanicId)return!1;if(n.searchTerm){let d=n.searchTerm.toLowerCase();if(![e.jobTitle,e.description,e.licensePlate,e.customerName].join(" ").toLowerCase().includes(d))return!1}return!0})}getPageTitle(){switch(this.route.snapshot.url[1]?.path){case"active":return this.translationService.instant("maintenance.activeTitle");case"history":return this.translationService.instant("maintenance.historyTitle");case"schedule":return this.translationService.instant("maintenance.scheduleTitle");default:return this.translationService.instant("maintenance.title")}}getPageDescription(){switch(this.route.snapshot.url[1]?.path){case"active":return this.translationService.instant("maintenance.activeSubtitle");case"history":return this.translationService.instant("maintenance.historySubtitle");case"schedule":return this.translationService.instant("maintenance.scheduleSubtitle");default:return this.translationService.instant("maintenance.subtitle")}}getJobsTitle(){switch(this.route.snapshot.url[1]?.path){case"active":return this.translationService.instant("maintenance.activeJobs");case"history":return this.translationService.instant("maintenance.completedJobs");case"schedule":return this.translationService.instant("maintenance.scheduledJobs");default:return this.translationService.instant("maintenance.allJobs")}}setView(t){this.currentView.set(t)}getGridClasses(){return this.isMobile()?"grid-cols-1":this.currentView()==="grid"?"grid-cols-1 lg:grid-cols-2 xl:grid-cols-3":"grid-cols-1"}getViewForCard(){return this.isMobile()?"list":this.currentView()}onFiltersChange(t){this.filters.set(t),this.loadMaintenanceData()}onStatusChange(t){this.maintenanceService.updateJobStatus(t.jobId,t.status).subscribe({next:()=>this.loadMaintenanceData(),error:n=>console.error("Error updating job status:",n)})}createNewJob(){this.router.navigate(["/maintenance/new"])}editJob(t){this.router.navigate(["/maintenance/edit",t])}viewJob(t){this.router.navigate(["/maintenance/details",t])}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=F({type:o,selectors:[["app-maintenance"]],decls:33,vars:18,consts:[[1,"min-h-screen","maintenance-container","p-4","lg:p-6"],[1,"glass-card","maintenance-header"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4"],[1,"flex-1"],[1,"text-2xl","lg:text-3xl","font-bold","text-white","mb-1"],[1,"text-gray-300"],[1,"flex","items-center","gap-3"],[1,"btn-filter-toggle",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],[1,"btn-primary",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["class","glass-card filters-panel",4,"ngIf"],[1,"glass-card"],[3,"stats","view"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-white"],[1,"view-toggle"],[1,"view-toggle-btn",3,"active"],[1,"empty-state","text-center","py-12"],[1,"grid","gap-4",3,"class"],[1,"glass-card","filters-panel"],[3,"filtersChange","filters"],[1,"view-toggle-btn",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"mt-2","text-sm","font-medium","text-white"],[1,"mt-1","text-sm","text-gray-300"],[1,"grid","gap-4"],[3,"job","view"],[3,"statusChange","edit","viewDetails","job","view"]],template:function(n,e){n&1&&(a(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"h1",4),s(5),r(),a(6,"p",5),s(7),r()(),a(8,"div",6)(9,"button",7),f("click",function(){return e.showFilters.set(!e.showFilters())}),S(),a(10,"svg",8),x(11,"path",9),r(),V(),a(12,"span"),s(13),l(14,"translate"),r()(),a(15,"button",10),f("click",function(){return e.createNewJob()}),S(),a(16,"svg",8),x(17,"path",11),r(),V(),a(18,"span"),s(19),l(20,"translate"),r()()()()(),$(21,je,2,1,"div",12),a(22,"div",13),x(23,"app-maintenance-stats",14),r(),a(24,"div",13)(25,"div",15)(26,"h2",16),s(27),r(),a(28,"div",17),T(29,Oe,4,7,"button",18,Ie),r()(),C(31,Be,9,6,"div",19)(32,Je,3,2,"div",20),r()()),n&2&&(i(5),u(" ",e.getPageTitle()," "),i(2),m(e.getPageDescription()),i(2),W("active",e.showFilters()),i(4),m(c(14,14,"common.filters")),i(6),m(c(20,16,"maintenance.newJob")),i(2),b("ngIf",e.showFilters()),i(2),b("stats",e.stats())("view",e.currentView()),i(4),E(" ",e.getJobsTitle()," (",e.filteredJobs().length,") "),i(),W("hidden",e.isMobile()),i(),P(e.viewOptions),i(2),w(e.filteredJobs().length===0?31:32))},dependencies:[I,Z,ee,re,A,z,G,H,D],styles:[".maintenance-container[_ngcontent-%COMP%]{min-height:100vh;background:transparent}.glass-card[_ngcontent-%COMP%]{background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.6);border-radius:20px;padding:1.5rem;box-shadow:0 8px 32px #000000b3;transition:all .3s cubic-bezier(.4,0,.2,1);margin-bottom:1rem}.glass-card[_ngcontent-%COMP%]:hover{background:#1f2937fa;box-shadow:0 12px 40px #000c;border-color:#3b82f6b3;transform:translateY(-2px)}.filters-panel[_ngcontent-%COMP%]{background:#111827e6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.4);border-radius:20px;box-shadow:0 8px 32px #00000080;transition:all .3s cubic-bezier(.4,0,.2,1)}.filters-panel[_ngcontent-%COMP%]:hover{transform:translateY(-2px);background:#1f2937f2;box-shadow:0 12px 40px #0009}.view-toggle[_ngcontent-%COMP%]{display:flex;background:#1f293799;border-radius:12px;padding:.25rem;gap:.25rem}.view-toggle.hidden[_ngcontent-%COMP%]{display:none!important}.view-toggle-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem;font-weight:500;border-radius:8px;transition:all .2s ease;color:#9ca3af;cursor:pointer}.view-toggle-btn.active[_ngcontent-%COMP%]{background:#3b82f6cc;color:#fff;box-shadow:0 2px 8px #3b82f64d}.view-toggle-btn[_ngcontent-%COMP%]:not(.active):hover{background:#4b556366;color:#d1d5db}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff!important}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d1d5db!important}"]})};export{ue as MaintenanceComponent};
