import{Fa as m,Jb as v,P as c,U as u,ca as b,ga as L,gc as S,j as g,m as d,q as f,y as h}from"./chunk-DMTVNCDT.js";var l=class o{STORAGE_KEY="opauth_language";supportedLanguages=[{code:"en",name:"English",nativeName:"English",flag:"\u{1F1FA}\u{1F1F8}"},{code:"fr",name:"French",nativeName:"Fran\xE7ais",flag:"\u{1F1EB}\u{1F1F7}"},{code:"ar",name:"Arabic",nativeName:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",flag:"\u{1F1F8}\u{1F1E6}"}];currentLanguageSubject=new g("en");currentLanguage$=this.currentLanguageSubject.asObservable();currentLanguage=L("en");constructor(){let e=this.getStoredLanguage();this.currentLanguage.set(e),this.currentLanguageSubject.next(e),this.setLanguage(e,!1)}setLanguage(e,t=!0){this.currentLanguage.set(e),this.currentLanguageSubject.next(e),t&&localStorage.setItem(this.STORAGE_KEY,e),this.updateDocumentDirection(e),document.documentElement.lang=e}getCurrentLanguage(){return this.currentLanguage()}getLanguageOption(e){return this.supportedLanguages.find(t=>t.code===e)}getNextLanguage(){let t=(this.supportedLanguages.findIndex(n=>n.code===this.currentLanguage())+1)%this.supportedLanguages.length;return this.supportedLanguages[t].code}cycleLanguage(){let e=this.getNextLanguage();this.setLanguage(e)}getStoredLanguage(){if(typeof window>"u")return"en";let e=localStorage.getItem(this.STORAGE_KEY),t=["en","fr","ar"];if(e&&t.includes(e))return e;let n=navigator.language.substr(0,2);return t.includes(n)?n:"en"}updateDocumentDirection(e){document.documentElement.dir="ltr",document.documentElement.setAttribute("data-direction","ltr")}isRTL(){return!1}formatText(e,t=e){return t}static \u0275fac=function(t){return new(t||o)};static \u0275prov=c({token:o,factory:o.\u0275fac,providedIn:"root"})};var p=class o{http=u(S);languageService=u(l);document=u(b);translationsSubject=new g({});translations$=this.translationsSubject.asObservable();loadedLanguages=new Set;translationsCache=new Map;constructor(){this.loadedLanguages.clear(),this.translationsCache.clear(),this.languageService.currentLanguage$.subscribe(e=>{this.loadTranslations(e)}),this.loadTranslations(this.languageService.getCurrentLanguage())}loadTranslations(e){if(this.loadedLanguages.has(e)){let r=this.translationsCache.get(e)||{};this.translationsSubject.next(r),console.log(`Using cached translations for ${e}`,Object.keys(r).length,"keys");return}let n=(this.document.getElementsByTagName("base")[0]?.getAttribute("href")||"/")+"assets/i18n/"+e+".json";console.log(`Loading translations from: ${n}`),this.http.get(n).pipe(h(r=>(console.error(`Failed to load translations for ${e} from ${n}:`,r),d({})))).subscribe(r=>{console.log(`Loaded translations for ${e}:`,Object.keys(r).length,"root keys"),this.loadedLanguages.add(e),this.translationsCache.set(e,r),this.translationsSubject.next(r)})}translate(e,t){return this.translations$.pipe(f(n=>{let r=e.split("."),a=n;for(let s of r)if(a&&typeof a=="object"&&s in a)a=a[s];else return e;let i=typeof a=="string"?a:e;return t&&typeof i=="string"&&Object.keys(t).forEach(s=>{i=i.replace(new RegExp(`{{${s}}}`,"g"),t[s])}),i}))}forceReloadTranslations(){this.loadedLanguages.clear(),this.translationsCache.clear(),this.loadTranslations(this.languageService.getCurrentLanguage())}getCurrentTranslations(){return this.translationsSubject.value}instant(e,t){let n=this.translationsSubject.value;if(!n||Object.keys(n).length===0)return console.warn("Translations not loaded yet for key:",e),e;let r=e.split("."),a=n;for(let s of r)if(a&&typeof a=="object"&&s in a)a=a[s];else return console.warn("Translation key not found:",e),e;let i=typeof a=="string"?a:e;return t&&typeof i=="string"&&Object.keys(t).forEach(s=>{i=i.replace(new RegExp(`{{${s}}}`,"g"),t[s])}),i}static \u0275fac=function(t){return new(t||o)};static \u0275prov=c({token:o,factory:o.\u0275fac,providedIn:"root"})};var j=class o{translationService=u(p);cdr=u(v);subscription;lastValue="";transform(e,t){if(!e)return"";this.subscription||(this.subscription=this.translationService.translations$.subscribe(()=>{this.cdr.markForCheck()}));let n=this.translationService.instant(e,t);return this.lastValue=n,n}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static \u0275fac=function(t){return new(t||o)};static \u0275pipe=m({name:"translate",type:o,pure:!1})};export{l as a,p as b,j as c};
