import{a as oe}from"./chunk-UJO3757W.js";import{b as ie,d as ne,e as be,g as we,h as re,i as Ue,p as Se,q as ye,r as Ie,u as Me,v as Ee,y as ae}from"./chunk-O3CTDYVO.js";import{c as L}from"./chunk-ECECQ7NF.js";import{e as Ce,f as he}from"./chunk-5NENZ4M5.js";import{$ as w,$a as h,Ab as p,Bb as T,C as k,Ca as B,Fb as xe,Ja as V,K as Y,P as ge,Sa as v,T as _e,Ta as x,U as Z,Va as R,Wa as M,Xa as E,Ya as U,Z as f,Za as r,_ as C,_a as o,_b as H,a as $,aa as S,ab as I,ac as P,b as W,bb as b,cb as u,ga as y,gb as J,hb as fe,j as ve,jb as K,kb as s,lb as g,m as O,mb as c,n as j,nb as A,ob as G,q,qb as N,ra as ee,rb as F,sa as a,sb as z,ub as Q,xb as D,yb as te,zb as d}from"./chunk-DMTVNCDT.js";var se=class i{constructor(t){this.subscriptionService=t}mockUsers=[{id:"user-001",email:"ala@opauto.tn",firstName:"Ala",lastName:"Ben Khlifa",fullName:"Ala Ben Khlifa",role:"owner",status:"active",joinedAt:new Date("2023-01-01"),lastActiveAt:new Date,permissions:{canManageUsers:!0,canManageSettings:!0,canViewReports:!0,canManageInventory:!0,canManageAppointments:!0,canManageInvoices:!0,canManageMaintenance:!0}},{id:"user-002",email:"sarah@opauto.tn",firstName:"Sarah",lastName:"Manager",fullName:"Sarah Manager",role:"admin",status:"active",joinedAt:new Date("2023-02-15"),lastActiveAt:new Date(Date.now()-2*60*60*1e3),invitedBy:"user-001",permissions:{canManageUsers:!0,canManageSettings:!1,canViewReports:!0,canManageInventory:!0,canManageAppointments:!0,canManageInvoices:!0,canManageMaintenance:!0}}];mockInvitations=[{id:"inv-001",email:"new.user@example.com",role:"mechanic",invitedBy:"user-001",invitedAt:new Date(Date.now()-24*60*60*1e3),expiresAt:new Date(Date.now()+6*24*60*60*1e3),status:"pending",token:"mock-invitation-token"}];usersSubject=new ve(this.mockUsers);invitationsSubject=new ve(this.mockInvitations);users$=this.usersSubject.asObservable();invitations$=this.invitationsSubject.asObservable();getUsers(t){return this.users$.pipe(q(e=>this.applyFilters(e,t)),k(200))}getUserById(t){return this.users$.pipe(q(e=>e.find(n=>n.id===t)||null),k(100))}getCurrentUser(){return this.getUserById("user-001")}getUserStats(){return this.users$.pipe(Y(t=>this.subscriptionService.getCurrentSubscriptionStatus().pipe(q(e=>({totalUsers:t.length,activeUsers:t.filter(l=>l.status==="active").length,pendingUsers:this.mockInvitations.filter(l=>l.status==="pending").length,roleDistribution:{owner:t.filter(l=>l.role==="owner").length,admin:t.filter(l=>l.role==="admin").length,mechanic:t.filter(l=>l.role==="mechanic").length,viewer:t.filter(l=>l.role==="viewer").length},recentJoins:t.filter(l=>l.joinedAt>new Date(Date.now()-2592e6)).sort((l,m)=>m.joinedAt.getTime()-l.joinedAt.getTime()).slice(0,5),tierInfo:{current:e.currentTier,limits:this.calculateUserLimits(t.length,e.currentTier)}})))),k(150))}getUserLimits(){return this.users$.pipe(Y(t=>this.subscriptionService.getCurrentSubscriptionStatus().pipe(q(e=>this.calculateUserLimits(t.length,e.currentTier)))))}inviteUser(t){return this.getUserLimits().pipe(Y(e=>{if(!e.canAddUser)return j(()=>new Error("User limit reached for current tier"));let n={id:`inv-${Date.now()}`,email:t.email,role:t.role,invitedBy:"user-001",invitedAt:new Date,expiresAt:new Date(Date.now()+7*24*60*60*1e3),status:"pending",token:`mock-token-${Date.now()}`},l=this.invitationsSubject.value;return this.invitationsSubject.next([...l,n]),O(n).pipe(k(300))}))}resendInvitation(t){let e=this.invitationsSubject.value,n=e.findIndex(_=>_.id===t);if(n===-1)return j(()=>new Error("Invitation not found"));let l=W($({},e[n]),{invitedAt:new Date,expiresAt:new Date(Date.now()+7*24*60*60*1e3),status:"pending"}),m=[...e];return m[n]=l,this.invitationsSubject.next(m),O(l).pipe(k(200))}cancelInvitation(t){let e=this.invitationsSubject.value,n=e.findIndex(_=>_.id===t);if(n===-1)return j(()=>new Error("Invitation not found"));let l=W($({},e[n]),{status:"cancelled"}),m=[...e];return m[n]=l,this.invitationsSubject.next(m),O(!0).pipe(k(200))}updateUserRole(t,e){let n=this.usersSubject.value,l=n.findIndex(ue=>ue.id===t);if(l===-1)return j(()=>new Error("User not found"));let m=W($({},n[l]),{role:e,permissions:this.getPermissionsForRole(e)}),_=[...n];return _[l]=m,this.usersSubject.next(_),O(m).pipe(k(300))}updateUserStatus(t,e){let n=this.usersSubject.value,l=n.findIndex(ue=>ue.id===t);if(l===-1)return j(()=>new Error("User not found"));let m=W($({},n[l]),{status:e}),_=[...n];return _[l]=m,this.usersSubject.next(_),O(m).pipe(k(300))}removeUser(t){let e=this.usersSubject.value,n=e.find(m=>m.id===t);if(!n)return j(()=>new Error("User not found"));if(n.role==="owner")return j(()=>new Error("Cannot remove owner"));let l=e.filter(m=>m.id!==t);return this.usersSubject.next(l),O(!0).pipe(k(200))}applyFilters(t,e){return e?t.filter(n=>{if(e.searchTerm){let l=e.searchTerm.toLowerCase();if(![n.fullName,n.email,n.role].join(" ").toLowerCase().includes(l))return!1}return!(e.role&&e.role.length>0&&!e.role.includes(n.role)||e.status&&e.status.length>0&&!e.status.includes(n.status)||e.joinedAfter&&n.joinedAt<e.joinedAfter||e.joinedBefore&&n.joinedAt>e.joinedBefore)}):t}calculateUserLimits(t,e){let n=e.limits.users,l=n===null||t<n,m;return e.id==="solo"?m={id:"starter",name:"Starter",price:2e3,currency:"TND",limits:{users:3,cars:200,serviceBays:2},features:[]}:e.id==="starter"&&(m={id:"professional",name:"Professional",price:6e3,currency:"TND",limits:{users:null,cars:null,serviceBays:null},features:[]}),{current:t,limit:n,canAddUser:l,nextTier:m}}getPermissionsForRole(t){switch(t){case"owner":return{canManageUsers:!0,canManageSettings:!0,canViewReports:!0,canManageInventory:!0,canManageAppointments:!0,canManageInvoices:!0,canManageMaintenance:!0};case"admin":return{canManageUsers:!0,canManageSettings:!1,canViewReports:!0,canManageInventory:!0,canManageAppointments:!0,canManageInvoices:!0,canManageMaintenance:!0};case"mechanic":return{canManageUsers:!1,canManageSettings:!1,canViewReports:!1,canManageInventory:!0,canManageAppointments:!0,canManageInvoices:!1,canManageMaintenance:!0};case"viewer":return{canManageUsers:!1,canManageSettings:!1,canViewReports:!0,canManageInventory:!1,canManageAppointments:!1,canManageInvoices:!1,canManageMaintenance:!1}}}static \u0275fac=function(e){return new(e||i)(_e(oe))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})};var Pe=i=>({date:i}),Le=(i,t)=>t.key,Ae=(i,t)=>t.id;function je(i,t){if(i&1&&(r(0,"p",20),s(1),d(2,"translate"),o()),i&2){let e=u();a(),G(" ",e.stats.tierInfo.limits.current,"/",e.stats.tierInfo.limits.limit," ",p(2,3,"users.users")," ")}}function Re(i,t){i&1&&(r(0,"p",20),s(1),d(2,"translate"),o()),i&2&&(a(),g(p(2,1,"tiers.unlimited")))}function Ne(i,t){i&1&&(r(0,"span"),s(1),o()),i&2&&(a(),g("s"))}function Fe(i,t){if(i&1&&(r(0,"div",24)(1,"div",9),s(2),o(),r(3,"div",25),s(4),d(5,"translate"),v(6,Ne,2,1,"span"),o()()),i&2){let e=u().$implicit;a(2),g(e.value),a(2),c(" ",p(5,3,"roles."+e.key)," "),a(2),x(e.value!==1?6:-1)}}function ze(i,t){if(i&1&&v(0,Fe,7,5,"div",24),i&2){let e=t.$implicit;x(e.value>0?0:-1)}}function Oe(i,t){if(i&1&&(r(0,"div",21)(1,"h3",22),s(2),d(3,"translate"),o(),r(4,"div",23),M(5,ze,1,1,null,null,Le),o()()),i&2){let e=u();a(2),g(p(3,1,"users.roleDistribution")),a(3),E(e.roleEntries())}}function Ge(i,t){if(i&1&&h(0,"img",29),i&2){let e=u().$implicit;U("src",e.avatar,ee)("alt",e.fullName)}}function He(i,t){if(i&1&&(r(0,"span",30),s(1),o()),i&2){let e=u().$implicit;a(),A(" ",e.firstName.charAt(0),"",e.lastName.charAt(0)," ")}}function $e(i,t){if(i&1&&(r(0,"div",27)(1,"div",28),v(2,Ge,1,2,"img",29)(3,He,2,2,"span",30),o(),r(4,"div",31)(5,"p",32),s(6),o(),r(7,"p",20),s(8),d(9,"date"),d(10,"translate"),o()(),r(11,"div",3)(12,"span"),s(13),d(14,"translate"),o()()()),i&2){let e=t.$implicit,n=u(2);a(2),x(e.avatar?2:3),a(4),g(e.fullName),a(2),c(" ",T(10,9,"users.joinedOn",D(14,Pe,p(9,7,e.joinedAt)))," "),a(4),K(Q("badge badge-",n.getRoleBadgeClass(e.role))),a(),c(" ",p(14,12,"roles."+e.role)," ")}}function We(i,t){if(i&1&&(r(0,"div",21)(1,"h3",22),s(2),d(3,"translate"),o(),r(4,"div",26),M(5,$e,15,16,"div",27,Ae),o()()),i&2){let e=u();a(2),g(p(3,1,"users.recentJoins")),a(3),E(e.stats.recentJoins)}}var le=class i{stats;hasRoleData(){return Object.values(this.stats.roleDistribution).some(t=>t>0)}roleEntries(){return Object.entries(this.stats.roleDistribution).map(([t,e])=>({key:t,value:e}))}getRoleBadgeClass(t){switch(t){case"owner":return"primary";case"admin":return"success";case"mechanic":return"info";case"viewer":return"secondary";default:return"secondary"}}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=B({type:i,selectors:[["app-user-stats"]],inputs:{stats:"stats"},decls:54,vars:21,consts:[[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"glass-card","p-4"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"w-8","h-8","bg-blue-500/20","rounded-lg","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","text-blue-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-300"],[1,"text-2xl","font-bold","text-white"],[1,"w-8","h-8","bg-green-500/20","rounded-lg","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"w-8","h-8","bg-yellow-500/20","rounded-lg","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","text-yellow-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"w-8","h-8","bg-purple-500/20","rounded-lg","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","text-purple-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"],[1,"text-xl","font-bold","text-white","capitalize"],[1,"text-xs","text-gray-400"],[1,"glass-card","p-6","mt-6"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"text-center"],[1,"text-sm","text-gray-400"],[1,"space-y-3"],[1,"flex","items-center","space-x-3"],[1,"w-8","h-8","bg-gray-600","rounded-full","flex","items-center","justify-center"],[1,"w-8","h-8","rounded-full",3,"src","alt"],[1,"text-white","text-sm","font-medium"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-white","truncate"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),w(),r(5,"svg",5),h(6,"path",6),o()()(),S(),r(7,"div",7)(8,"p",8),s(9),d(10,"translate"),o(),r(11,"p",9),s(12),o()()()(),r(13,"div",1)(14,"div",2)(15,"div",3)(16,"div",10),w(),r(17,"svg",11),h(18,"path",12),o()()(),S(),r(19,"div",7)(20,"p",8),s(21),d(22,"translate"),o(),r(23,"p",9),s(24),o()()()(),r(25,"div",1)(26,"div",2)(27,"div",3)(28,"div",13),w(),r(29,"svg",14),h(30,"path",15),o()()(),S(),r(31,"div",7)(32,"p",8),s(33),d(34,"translate"),o(),r(35,"p",9),s(36),o()()()(),r(37,"div",1)(38,"div",2)(39,"div",3)(40,"div",16),w(),r(41,"svg",17),h(42,"path",18),o()()(),S(),r(43,"div",7)(44,"p",8),s(45),d(46,"translate"),o(),r(47,"p",19),s(48),d(49,"translate"),o(),v(50,je,3,5,"p",20)(51,Re,3,3,"p",20),o()()()(),v(52,Oe,7,3,"div",21),v(53,We,7,3,"div",21)),e&2&&(a(9),g(p(10,11,"users.totalUsers")),a(3),g(n.stats.totalUsers),a(9),g(p(22,13,"users.activeUsers")),a(3),g(n.stats.activeUsers),a(9),g(p(34,15,"users.pendingInvitations")),a(3),g(n.stats.pendingUsers),a(9),g(p(46,17,"tiers.currentPlan")),a(3),c(" ",p(49,19,"tiers."+n.stats.tierInfo.current.id)," "),a(2),x(n.stats.tierInfo.limits.limit!==null?50:51),a(2),x(n.hasRoleData()?52:-1),a(),x(n.stats.recentJoins.length>0?53:-1))},dependencies:[P,H,L],encapsulation:2})};var ke=i=>({date:i});function qe(i,t){if(i&1&&h(0,"img",4),i&2){let e=u();U("src",e.user.avatar,ee)("alt",e.user.fullName)}}function Je(i,t){if(i&1&&(r(0,"span",5),s(1),o()),i&2){let e=u();a(),A(" ",e.user.firstName.charAt(0),"",e.user.lastName.charAt(0)," ")}}function Ke(i,t){if(i&1){let e=I();r(0,"button",23),b("click",function(){f(e);let l=u().$implicit,m=u(4);return C(m.changeRole(l))}),s(1),d(2,"translate"),o()}if(i&2){let e=u().$implicit;a(),c(" ",p(2,1,"roles."+e)," ")}}function Qe(i,t){if(i&1&&v(0,Ke,3,3,"button",22),i&2){let e=t.$implicit,n=u(4);x(e!==n.user.role?0:-1)}}function Xe(i,t){if(i&1&&(r(0,"div",19)(1,"div",20),s(2),d(3,"translate"),o(),M(4,Qe,1,1,null,null,R),o(),h(6,"div",21)),i&2){let e=u(3);a(2),c(" ",p(3,1,"users.changeRole")," "),a(2),E(e.availableRoles)}}function Ye(i,t){if(i&1){let e=I();r(0,"button",23),b("click",function(){f(e);let l=u().$implicit,m=u(4);return C(m.changeStatus(l))}),s(1),d(2,"translate"),o()}if(i&2){let e=u().$implicit;a(),c(" ",p(2,1,"status."+e)," ")}}function Ze(i,t){if(i&1&&v(0,Ye,3,3,"button",22),i&2){let e=t.$implicit,n=u(4);x(e!==n.user.status?0:-1)}}function et(i,t){if(i&1&&(r(0,"div",19)(1,"div",20),s(2),d(3,"translate"),o(),M(4,Ze,1,1,null,null,R),o(),h(6,"div",21)),i&2){let e=u(3);a(2),c(" ",p(3,1,"users.changeStatus")," "),a(2),E(e.availableStatuses)}}function tt(i,t){if(i&1){let e=I();r(0,"div",19)(1,"button",24),b("click",function(){f(e);let l=u(3);return C(l.confirmRemoveUser())}),s(2),d(3,"translate"),o()()}i&2&&(a(2),c(" ",p(3,1,"users.removeUser")," "))}function it(i,t){if(i&1&&(r(0,"div",18),v(1,Xe,7,3),v(2,et,7,3),v(3,tt,4,3,"div",19),o()),i&2){let e=u(2);a(),x(e.user.role!=="owner"&&(e.currentUser==null?null:e.currentUser.role)==="owner"?1:-1),a(),x(e.user.id!==(e.currentUser==null?null:e.currentUser.id)?2:-1),a(),x(e.user.role!=="owner"&&e.user.id!==(e.currentUser==null?null:e.currentUser.id)?3:-1)}}function nt(i,t){if(i&1){let e=I();r(0,"div",10)(1,"button",15),b("click",function(){f(e);let l=u();return C(l.showActions.set(!l.showActions()))}),w(),r(2,"svg",16),h(3,"path",17),o()(),v(4,it,4,3,"div",18),o()}if(i&2){let e=u();a(4),x(e.showActions()?4:-1)}}function rt(i,t){if(i&1&&(r(0,"span"),s(1),d(2,"date"),d(3,"translate"),o()),i&2){let e=u();a(),g(T(3,4,"users.lastActive",D(7,ke,T(2,1,e.user.lastActiveAt,"short"))))}}function at(i,t){if(i&1&&(r(0,"span",27),s(1),d(2,"translate"),o()),i&2){let e=t.$implicit;a(),c(" ",p(2,1,"permissions."+e)," ")}}function ot(i,t){if(i&1&&(r(0,"div",13)(1,"div",25),s(2),d(3,"translate"),o(),r(4,"div",26),M(5,at,3,3,"span",27,R),o()()),i&2){let e=u();a(2),c("",p(3,1,"users.permissions"),":"),a(3),E(e.getActivePermissions())}}function st(i,t){if(i&1){let e=I();r(0,"div",28),b("click",function(){f(e);let l=u();return C(l.showActions.set(!1))}),o()}}var pe=class i{user;currentUser=null;updateRole=new V;updateStatus=new V;removeUser=new V;showActions=y(!1);availableRoles=["admin","mechanic","viewer"];availableStatuses=["active","inactive","suspended"];canManageUser(){return!this.currentUser||this.user.role==="owner"?!1:this.currentUser.role==="owner"||this.currentUser.role==="admin"}getRoleBadgeClass(t){switch(t){case"owner":return"primary";case"admin":return"success";case"mechanic":return"info";case"viewer":return"secondary";default:return"secondary"}}getStatusBadgeClass(t){switch(t){case"active":return"success";case"pending":return"warning";case"inactive":return"secondary";case"suspended":return"danger";default:return"secondary"}}getActivePermissions(){let t=[],e=this.user.permissions;return e.canManageUsers&&t.push("manageUsers"),e.canManageSettings&&t.push("manageSettings"),e.canViewReports&&t.push("viewReports"),e.canManageInventory&&t.push("manageInventory"),e.canManageAppointments&&t.push("manageAppointments"),e.canManageInvoices&&t.push("manageInvoices"),e.canManageMaintenance&&t.push("manageMaintenance"),t.slice(0,4)}changeRole(t){this.updateRole.emit({userId:this.user.id,role:t}),this.showActions.set(!1)}changeStatus(t){this.updateStatus.emit({userId:this.user.id,status:t}),this.showActions.set(!1)}confirmRemoveUser(){confirm(`Are you sure you want to remove ${this.user.fullName} from your team?`)&&this.removeUser.emit(this.user.id),this.showActions.set(!1)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=B({type:i,selectors:[["app-user-card"]],inputs:{user:"user",currentUser:"currentUser"},outputs:{updateRole:"updateRole",updateStatus:"updateStatus",removeUser:"removeUser"},decls:28,vars:27,consts:[[1,"glass-card","p-4","hover:bg-gray-800/40","transition-all","duration-200"],[1,"flex","items-start","justify-between"],[1,"flex","items-start","space-x-3"],[1,"w-10","h-10","bg-gray-600","rounded-full","flex","items-center","justify-center"],[1,"w-10","h-10","rounded-full",3,"src","alt"],[1,"text-white","text-sm","font-medium"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-white","truncate"],[1,"text-xs","text-gray-400","truncate"],[1,"flex","items-center","space-x-2","mt-1"],[1,"relative"],[1,"mt-3","pt-3","border-t","border-gray-700"],[1,"flex","items-center","justify-between","text-xs","text-gray-400"],[1,"mt-2"],[1,"fixed","inset-0","z-0"],[1,"text-gray-400","hover:text-white","p-1","rounded",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"],[1,"absolute","right-0","mt-2","w-48","bg-gray-800","rounded-md","shadow-lg","z-10","border","border-gray-700"],[1,"py-1"],[1,"px-4","py-2","text-xs","font-medium","text-gray-400","uppercase","tracking-wide"],[1,"border-t","border-gray-700"],[1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-300","hover:bg-gray-700"],[1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-300","hover:bg-gray-700",3,"click"],[1,"block","w-full","text-left","px-4","py-2","text-sm","text-red-400","hover:bg-gray-700",3,"click"],[1,"text-xs","text-gray-400","mb-1"],[1,"flex","flex-wrap","gap-1"],[1,"inline-flex","items-center","px-2","py-0.5","rounded","text-xs","bg-gray-700","text-gray-300"],[1,"fixed","inset-0","z-0",3,"click"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),v(4,qe,1,2,"img",4)(5,Je,2,2,"span",5),o(),r(6,"div",6)(7,"h3",7),s(8),o(),r(9,"p",8),s(10),o(),r(11,"div",9)(12,"span"),s(13),d(14,"translate"),o(),r(15,"span"),s(16),d(17,"translate"),o()()()(),v(18,nt,5,1,"div",10),o(),r(19,"div",11)(20,"div",12)(21,"span"),s(22),d(23,"date"),d(24,"translate"),o(),v(25,rt,4,9,"span"),o(),v(26,ot,7,3,"div",13),o()(),v(27,st,1,0,"div",14)),e&2&&(a(4),x(n.user.avatar?4:5),a(4),g(n.user.fullName),a(2),g(n.user.email),a(2),K(Q("badge badge-",n.getRoleBadgeClass(n.user.role)," text-xs")),a(),c(" ",p(14,16,"roles."+n.user.role)," "),a(2),K(Q("badge badge-",n.getStatusBadgeClass(n.user.status)," text-xs")),a(),c(" ",p(17,18,"status."+n.user.status)," "),a(2),x(n.canManageUser()?18:-1),a(4),g(T(24,22,"users.joinedOn",D(25,ke,p(23,20,n.user.joinedAt)))),a(3),x(n.user.lastActiveAt?25:-1),a(),x(n.user.role!=="owner"?26:-1),a(),x(n.showActions()?27:-1))},dependencies:[P,H,L],encapsulation:2})};var dt=(i,t)=>({remaining:i,total:t}),pt=(i,t)=>t.value;function ct(i,t){if(i&1&&(s(0),d(1,"translate")),i&2){let e=u(2);c(" ",T(1,1,"users.inviteLimit",te(4,dt,e.userLimits.limit-e.userLimits.current,e.userLimits.limit))," ")}}function mt(i,t){i&1&&(s(0),d(1,"translate")),i&2&&c(" ",p(1,1,"users.unlimitedInvites")," ")}function ut(i,t){if(i&1&&(r(0,"div",12)(1,"div",35),w(),r(2,"svg",36),h(3,"path",37),o(),S(),r(4,"div",38),v(5,ct,2,7)(6,mt,2,3),o()()()),i&2){let e=u();a(5),x(e.userLimits.limit!==null?5:6)}}function vt(i,t){i&1&&(s(0),d(1,"translate")),i&2&&c(" ",p(1,1,"validation.emailRequired")," ")}function xt(i,t){i&1&&(s(0),d(1,"translate")),i&2&&c(" ",p(1,1,"validation.emailInvalid")," ")}function gt(i,t){if(i&1&&(r(0,"div",18),v(1,vt,2,3),v(2,xt,2,3),o()),i&2){u();let e=J(21);a(),x(e.errors!=null&&e.errors.required?1:-1),a(),x(e.errors!=null&&e.errors.email?2:-1)}}function _t(i,t){if(i&1&&(r(0,"option",26),s(1),d(2,"translate"),o()),i&2){let e=t.$implicit;U("value",e.value),a(),g(p(2,2,e.label))}}function ft(i,t){i&1&&(r(0,"div",18),s(1),d(2,"translate"),o()),i&2&&(a(),c(" ",p(2,1,"validation.roleRequired")," "))}function Ct(i,t){if(i&1&&(r(0,"li"),s(1),d(2,"translate"),o()),i&2){let e=t.$implicit;a(),c("\u2022 ",p(2,1,"permissions."+e))}}function ht(i,t){if(i&1&&(r(0,"div",27)(1,"div",39)(2,"div",40),s(3),d(4,"translate"),d(5,"translate"),o(),r(6,"ul",41),M(7,Ct,3,3,"li",null,R),o()()()),i&2){let e=u();a(3),A(" ",p(4,2,"roles."+e.formData.role)," ",p(5,4,"users.permissions"),": "),a(4),E(e.getRolePermissions(e.formData.role))}}function bt(i,t){i&1&&(w(),r(0,"svg",42),h(1,"circle",43)(2,"path",44),o(),s(3),d(4,"translate")),i&2&&(a(3),c(" ",p(4,1,"users.sending")," "))}function wt(i,t){i&1&&(s(0),d(1,"translate")),i&2&&c(" ",p(1,1,"users.sendInvitation")," ")}var ce=class i{userLimits=null;close=new V;invite=new V;submitting=y(!1);formData={email:"",role:"",firstName:"",lastName:"",message:""};availableRoles=[{value:"admin",label:"roles.admin"},{value:"mechanic",label:"roles.mechanic"},{value:"viewer",label:"roles.viewer"}];onClose(){this.close.emit()}onSubmit(){!this.formData.email||!this.formData.role||(this.submitting.set(!0),setTimeout(()=>{this.invite.emit(this.formData),this.submitting.set(!1)},1e3))}getRolePermissions(t){switch(t){case"admin":return["manageUsers","viewReports","manageInventory","manageAppointments","manageInvoices","manageMaintenance"];case"mechanic":return["manageInventory","manageAppointments","manageMaintenance"];case"viewer":return["viewReports"];default:return[]}}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=B({type:i,selectors:[["app-user-invite-modal"]],inputs:{userLimits:"userLimits"},outputs:{close:"close",invite:"invite"},decls:68,vars:50,consts:[["inviteForm","ngForm"],["emailInput","ngModel"],["roleSelect","ngModel"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","min-h-screen","items-center","justify-center","px-4","pt-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-black/75","transition-opacity",3,"click"],[1,"relative","inline-block","transform","overflow-hidden","rounded-lg","bg-gray-800","px-4","pt-5","pb-4","text-left","align-bottom","shadow-xl","transition-all","sm:my-8","sm:w-full","sm:max-w-lg","sm:p-6","sm:align-middle","border","border-gray-600"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-white"],[1,"text-gray-400","hover:text-white",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"mb-6","p-3","bg-blue-900/20","border","border-blue-500/30","rounded-lg"],[3,"ngSubmit"],[1,"mb-4"],["for","email",1,"block","text-sm","font-medium","text-gray-300","mb-2"],[1,"text-red-400"],["id","email","type","email","name","email","required","","email","",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel","placeholder"],[1,"mt-1","text-sm","text-red-400"],["for","firstName",1,"block","text-sm","font-medium","text-gray-300","mb-2"],["id","firstName","type","text","name","firstName",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel","placeholder"],["for","lastName",1,"block","text-sm","font-medium","text-gray-300","mb-2"],["id","lastName","type","text","name","lastName",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel","placeholder"],["for","role",1,"block","text-sm","font-medium","text-gray-300","mb-2"],["id","role","name","role","required","",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"mb-4","p-3","bg-gray-700/50","rounded-lg"],[1,"mb-6"],["for","message",1,"block","text-sm","font-medium","text-gray-300","mb-2"],[1,"text-gray-500"],["id","message","name","message","rows","3",1,"w-full","px-3","py-2","bg-gray-700","border","border-gray-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent","resize-none",3,"ngModelChange","ngModel","placeholder"],[1,"flex","justify-end","space-x-3"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[1,"flex","items-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","text-blue-400","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-blue-300"],[1,"text-sm","text-gray-300"],[1,"font-medium","mb-1"],[1,"text-xs","text-gray-400","space-y-0.5"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,n){if(e&1){let l=I();r(0,"div",3)(1,"div",4)(2,"div",5),b("click",function(){return f(l),C(n.onClose())}),o(),r(3,"div",6)(4,"div",7)(5,"h3",8),s(6),d(7,"translate"),o(),r(8,"button",9),b("click",function(){return f(l),C(n.onClose())}),w(),r(9,"svg",10),h(10,"path",11),o()()(),v(11,ut,7,1,"div",12),S(),r(12,"form",13,0),b("ngSubmit",function(){return f(l),C(n.onSubmit())}),r(14,"div",14)(15,"label",15),s(16),d(17,"translate"),r(18,"span",16),s(19,"*"),o()(),r(20,"input",17,1),d(22,"translate"),z("ngModelChange",function(_){return f(l),F(n.formData.email,_)||(n.formData.email=_),C(_)}),o(),v(23,gt,3,2,"div",18),o(),r(24,"div",14)(25,"label",19),s(26),d(27,"translate"),o(),r(28,"input",20),d(29,"translate"),z("ngModelChange",function(_){return f(l),F(n.formData.firstName,_)||(n.formData.firstName=_),C(_)}),o()(),r(30,"div",14)(31,"label",21),s(32),d(33,"translate"),o(),r(34,"input",22),d(35,"translate"),z("ngModelChange",function(_){return f(l),F(n.formData.lastName,_)||(n.formData.lastName=_),C(_)}),o()(),r(36,"div",14)(37,"label",23),s(38),d(39,"translate"),r(40,"span",16),s(41,"*"),o()(),r(42,"select",24,2),z("ngModelChange",function(_){return f(l),F(n.formData.role,_)||(n.formData.role=_),C(_)}),r(44,"option",25),s(45),d(46,"translate"),o(),M(47,_t,3,4,"option",26,pt),o(),v(49,ft,3,3,"div",18),o(),v(50,ht,9,6,"div",27),r(51,"div",28)(52,"label",29),s(53),d(54,"translate"),r(55,"span",30),s(56),d(57,"translate"),o()(),r(58,"textarea",31),d(59,"translate"),z("ngModelChange",function(_){return f(l),F(n.formData.message,_)||(n.formData.message=_),C(_)}),s(60,"              "),o()(),r(61,"div",32)(62,"button",33),b("click",function(){return f(l),C(n.onClose())}),s(63),d(64,"translate"),o(),r(65,"button",34),v(66,bt,5,3)(67,wt,2,3),o()()()()()()}if(e&2){let l=J(13),m=J(21),_=J(43);a(6),c(" ",p(7,24,"users.inviteTeamMember")," "),a(5),x(n.userLimits?11:-1),a(5),c(" ",p(17,26,"users.emailAddress")," "),a(4),N("ngModel",n.formData.email),U("placeholder",p(22,28,"users.emailPlaceholder")),a(3),x(m.invalid&&m.touched?23:-1),a(3),c(" ",p(27,30,"users.firstName")," "),a(2),N("ngModel",n.formData.firstName),U("placeholder",p(29,32,"users.firstNamePlaceholder")),a(4),c(" ",p(33,34,"users.lastName")," "),a(2),N("ngModel",n.formData.lastName),U("placeholder",p(35,36,"users.lastNamePlaceholder")),a(4),c(" ",p(39,38,"users.role")," "),a(4),N("ngModel",n.formData.role),a(3),g(p(46,40,"users.selectRole")),a(2),E(n.availableRoles),a(2),x(_.invalid&&_.touched?49:-1),a(),x(n.formData.role?50:-1),a(3),c(" ",p(54,42,"users.personalMessage")," "),a(3),c("(",p(57,44,"common.optional"),")"),a(2),N("ngModel",n.formData.message),U("placeholder",p(59,46,"users.messagePlaceholder")),a(5),c(" ",p(64,48,"common.cancel")," "),a(2),U("disabled",l.invalid||n.submitting()),a(),x(n.submitting()?66:67)}},dependencies:[P,ae,Ue,ye,Ie,ie,Se,ne,be,Me,Ee,re,we,L],encapsulation:2})};function Ut(i,t){if(i&1&&(r(0,"div",39),w(),r(1,"svg",40),h(2,"path",41),o(),s(3),o()),i&2){let e=t.$implicit;a(3),c(" ",e," ")}}function St(i,t){if(i&1&&(r(0,"div",25)(1,"h4",37),s(2),d(3,"translate"),o(),r(4,"div",38),M(5,Ut,4,1,"div",39,R),o()()),i&2){let e=u();a(2),c(" ",p(3,1,"tiers.whatsIncluded")," "),a(3),E(e.upgradePrompt.benefits)}}function yt(i,t){i&1&&(w(),r(0,"svg",42),h(1,"circle",43)(2,"path",44),o(),s(3),d(4,"translate")),i&2&&(a(3),c(" ",p(4,1,"tiers.upgrading")," "))}function It(i,t){i&1&&(s(0),d(1,"translate")),i&2&&c(" ",p(1,1,"tiers.upgradeNow")," ")}var me=class i{upgradePrompt;close=new V;upgrade=new V;upgrading=y(!1);onClose(){this.close.emit()}onUpgrade(){this.upgrading.set(!0),setTimeout(()=>{this.upgrade.emit(this.upgradePrompt.suggestedTier.id),this.upgrading.set(!1)},2e3)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=B({type:i,selectors:[["app-upgrade-prompt-modal"]],inputs:{upgradePrompt:"upgradePrompt"},outputs:{close:"close",upgrade:"upgrade"},decls:81,vars:61,consts:[[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","min-h-screen","items-center","justify-center","px-4","pt-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-black/75","transition-opacity",3,"click"],[1,"relative","inline-block","transform","overflow-hidden","rounded-lg","bg-gray-800","px-4","pt-5","pb-4","text-left","align-bottom","shadow-xl","transition-all","sm:my-8","sm:w-full","sm:max-w-2xl","sm:p-6","sm:align-middle","border","border-gray-600"],[1,"text-center","mb-6"],[1,"mx-auto","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100/10","mb-4"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-blue-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"text-gray-300"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mb-6"],[1,"border","border-gray-600","rounded-lg","p-4"],[1,"text-center","mb-4"],[1,"text-lg","font-semibold","text-gray-300"],[1,"text-2xl","font-bold","text-white","mt-2","capitalize"],[1,"text-gray-400"],[1,"space-y-2"],[1,"flex","items-center","justify-between","text-sm"],[1,"text-white"],[1,"border-2","border-blue-500","rounded-lg","p-4","relative"],[1,"absolute","-top-3","left-1/2","transform","-translate-x-1/2"],[1,"bg-blue-500","text-white","px-3","py-1","rounded-full","text-xs","font-medium"],[1,"text-lg","font-semibold","text-blue-400"],[1,"text-sm","text-blue-400","mt-1"],[1,"text-blue-400","font-medium"],[1,"mb-6"],[1,"bg-blue-900/20","border","border-blue-500/30","rounded-lg","p-4","mb-6"],[1,"flex","items-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","text-blue-400","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","text-blue-300"],[1,"flex","justify-between","items-center"],["type","button",1,"text-gray-400","hover:text-white","text-sm",3,"click"],[1,"flex","space-x-3"],["type","button",1,"btn-secondary",3,"click"],["type","button",1,"btn-primary",3,"click","disabled"],[1,"mt-4","text-center","text-xs","text-gray-500"],[1,"text-lg","font-semibold","text-white","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2"],[1,"flex","items-center","text-sm","text-gray-300"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4","text-green-400","mr-2","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,n){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),b("click",function(){return n.onClose()}),o(),r(3,"div",3)(4,"div",4)(5,"div",5),w(),r(6,"svg",6),h(7,"path",7),o()(),S(),r(8,"h3",8),s(9),d(10,"translate"),o(),r(11,"p",9),s(12),d(13,"translate"),o()(),r(14,"div",10)(15,"div",11)(16,"div",12)(17,"h4",13),s(18),d(19,"translate"),o(),r(20,"div",14),s(21),d(22,"translate"),o(),r(23,"div",15),s(24),d(25,"translate"),o()(),r(26,"div",16)(27,"div",17)(28,"span",15),s(29),d(30,"translate"),o(),r(31,"span",18),s(32),o()()()(),r(33,"div",19)(34,"div",20)(35,"span",21),s(36),d(37,"translate"),o()(),r(38,"div",12)(39,"h4",22),s(40),d(41,"translate"),o(),r(42,"div",14),s(43),d(44,"translate"),o(),r(45,"div",9),s(46),d(47,"translate"),o(),r(48,"div",23),s(49),d(50,"translate"),o()(),r(51,"div",16)(52,"div",17)(53,"span",15),s(54),d(55,"translate"),o(),r(56,"span",24),s(57),d(58,"translate"),o()()()()(),v(59,St,7,3,"div",25),r(60,"div",26)(61,"div",27),w(),r(62,"svg",28),h(63,"path",29),o(),S(),r(64,"div",30),s(65),d(66,"translate"),o()()(),r(67,"div",31)(68,"button",32),b("click",function(){return n.onClose()}),s(69),d(70,"translate"),o(),r(71,"div",33)(72,"button",34),b("click",function(){return n.onClose()}),s(73),d(74,"translate"),o(),r(75,"button",35),b("click",function(){return n.onUpgrade()}),v(76,yt,5,3)(77,It,2,3),o()()(),r(78,"div",36),s(79),d(80,"translate"),o()()()()),e&2&&(a(9),c(" ",p(10,27,"tiers.upgradeRequired")," "),a(3),c(" ",p(13,29,"tiers.upgradeToAddMoreUsers")," "),a(6),g(p(19,31,"tiers.currentPlan")),a(3),c(" ",p(22,33,"tiers."+n.upgradePrompt.currentTier.id)," "),a(3),G(" ",n.upgradePrompt.currentTier.price," ",n.upgradePrompt.currentTier.currency,"/",p(25,35,"common.year")," "),a(5),g(p(30,37,"users.maxUsers")),a(3),c(" ",n.upgradePrompt.currentTier.limits.users||"\u221E"," "),a(4),c(" ",p(37,39,"tiers.recommended")," "),a(4),g(p(41,41,"tiers.upgradeTo")),a(3),c(" ",p(44,43,"tiers."+n.upgradePrompt.suggestedTier.id)," "),a(3),G(" ",n.upgradePrompt.suggestedTier.price," ",n.upgradePrompt.suggestedTier.currency,"/",p(47,45,"common.year")," "),a(3),G(" +",n.upgradePrompt.priceComparison.additionalCost," ",n.upgradePrompt.suggestedTier.currency,"/",p(50,47,"common.year")," "),a(5),g(p(55,49,"users.maxUsers")),a(3),c(" ",n.upgradePrompt.suggestedTier.limits.users?n.upgradePrompt.suggestedTier.limits.users:p(58,51,"tiers.unlimited")," "),a(2),x(n.upgradePrompt.benefits.length>0?59:-1),a(6),c(" ",p(66,53,"tiers.upgradeMessage")," "),a(4),c(" ",p(70,55,"tiers.maybeLater")," "),a(4),c(" ",p(74,57,"common.cancel")," "),a(2),U("disabled",n.upgrading()),a(),x(n.upgrading()?76:77),a(3),c(" ",p(80,59,"tiers.upgradeNote")," "))},dependencies:[P,L],encapsulation:2})};var Mt=(i,t)=>({current:i,limit:t}),Ve=i=>({tier:i}),Et=i=>({role:i}),Tt=i=>({date:i}),De=(i,t)=>t.id;function kt(i,t){if(i&1&&(r(0,"div",28)(1,"div",29),s(2),d(3,"translate"),o(),r(4,"div",30),s(5),o()(),r(6,"div",31),h(7,"div",32),o()),i&2){let e=u(2);a(2),g(p(3,4,"users.remaining")),a(3),c(" ",e.userLimits().limit-e.userLimits().current," "),a(2),fe("width",e.userLimits().current/e.userLimits().limit*100,"%")}}function Bt(i,t){if(i&1){let e=I();r(0,"button",33),b("click",function(){f(e);let l=u(2);return C(l.showUpgradePrompt())}),s(1),d(2,"translate"),o()}i&2&&(a(),c(" ",p(2,1,"tiers.upgrade")," "))}function Vt(i,t){if(i&1&&(r(0,"div",11)(1,"div",15)(2,"div")(3,"h3",16),s(4),d(5,"translate"),d(6,"translate"),o(),r(7,"p",25),s(8),d(9,"translate"),o()(),r(10,"div",26),v(11,kt,8,6),v(12,Bt,3,3,"button",27),o()()()),i&2){let e,n=u();a(4),A(" ",p(5,5,"tiers."+(((e=n.stats())==null||e.tierInfo==null||e.tierInfo.current==null?null:e.tierInfo.current.id)||"solo"))," ",p(6,7,"tiers.plan")," "),a(4),c(" ",T(9,9,"users.currentUsage",te(12,Mt,n.userLimits().current,n.userLimits().limit||"\u221E"))," "),a(3),x(n.userLimits().limit!==null?11:-1),a(),x(n.userLimits().nextTier?12:-1)}}function Dt(i,t){if(i&1){let e=I();r(0,"button",41),b("click",function(){f(e);let l=u(2);return C(l.showUpgradePrompt())}),s(1),d(2,"translate"),o()}if(i&2){let e,n=u(2);a(),c(" ",T(2,1,"tiers.upgradeTo",D(4,Ve,((e=n.userLimits().nextTier)==null?null:e.id)||"professional"))," ")}}function Pt(i,t){if(i&1&&(r(0,"div",12)(1,"div",34),w(),r(2,"svg",35),h(3,"path",36),o(),S(),r(4,"div",37)(5,"h3",38),s(6),d(7,"translate"),o(),r(8,"p",39),s(9),d(10,"translate"),o(),v(11,Dt,3,6,"button",40),o()()()),i&2){let e,n=u();a(6),c(" ",p(7,3,"users.limitReached")," "),a(3),c(" ",T(10,5,"users.limitReachedDescription",D(8,Ve,((e=n.stats())==null||e.tierInfo==null||e.tierInfo.current==null?null:e.tierInfo.current.name)||"Solo"))," "),a(2),x(n.userLimits().nextTier?11:-1)}}function Lt(i,t){if(i&1&&h(0,"app-user-stats",13),i&2){let e=u();U("stats",e.stats())}}function At(i,t){if(i&1){let e=I();r(0,"div",46)(1,"button",47),b("click",function(){f(e);let l=u(2);return C(l.openInviteModal())}),w(),r(2,"svg",6),h(3,"path",10),o(),s(4),d(5,"translate"),o()()}i&2&&(a(4),c(" ",p(5,1,"users.inviteFirstUser")," "))}function jt(i,t){if(i&1&&(r(0,"div",22),w(),r(1,"svg",42),h(2,"path",43),o(),S(),r(3,"h3",44),s(4),d(5,"translate"),o(),r(6,"p",45),s(7),d(8,"translate"),o(),v(9,At,6,3,"div",46),o()),i&2){let e,n=u();a(4),g(p(5,3,"users.noUsersFound")),a(3),g(p(8,5,"users.noUsersDescription")),a(2),x((e=n.userLimits())!=null&&e.canAddUser?9:-1)}}function Rt(i,t){if(i&1){let e=I();r(0,"app-user-card",51),b("updateRole",function(l){f(e);let m=u(2);return C(m.updateUserRole(l.userId,l.role))})("updateStatus",function(l){f(e);let m=u(2);return C(m.updateUserStatus(l.userId,l.status))})("removeUser",function(l){f(e);let m=u(2);return C(m.removeUser(l))}),o()}if(i&2){let e=t.$implicit,n=u(2);U("user",e)("currentUser",n.currentUser())}}function Nt(i,t){if(i&1){let e=I();r(0,"div",54)(1,"div")(2,"div",55),s(3),o(),r(4,"div",29),s(5),d(6,"translate"),d(7,"translate"),d(8,"date"),d(9,"translate"),o()(),r(10,"div",56)(11,"button",57),b("click",function(){let l=f(e).$implicit,m=u(3);return C(m.resendInvitation(l.id))}),s(12),d(13,"translate"),o(),r(14,"button",58),b("click",function(){let l=f(e).$implicit,m=u(3);return C(m.cancelInvitation(l.id))}),s(15),d(16,"translate"),o()()()}if(i&2){let e=t.$implicit;a(3),g(e.email),a(2),A(" ",T(7,7,"users.invitedAs",D(19,Et,p(6,5,"roles."+e.role)))," \u2022 ",T(9,12,"users.invitedOn",D(21,Tt,p(8,10,e.invitedAt)))," "),a(7),c(" ",p(13,15,"users.resend")," "),a(3),c(" ",p(16,17,"common.cancel")," ")}}function Ft(i,t){if(i&1&&(r(0,"div",50)(1,"h3",52),s(2),d(3,"translate"),r(4,"span",17),s(5),o()(),r(6,"div",53),M(7,Nt,17,23,"div",54,De),o()()),i&2){let e=u(2);a(2),c(" ",p(3,2,"users.pendingInvitations")," "),a(3),c(" (",e.pendingInvitations().length,") "),a(2),E(e.pendingInvitations())}}function zt(i,t){if(i&1&&(r(0,"div",48),M(1,Rt,1,2,"app-user-card",49,De),o(),v(3,Ft,9,4,"div",50)),i&2){let e=u();a(),E(e.filteredUsers()),a(2),x(e.pendingInvitations().length>0?3:-1)}}function Ot(i,t){if(i&1){let e=I();r(0,"app-user-invite-modal",59),b("close",function(){f(e);let l=u();return C(l.showInviteModal.set(!1))})("invite",function(l){f(e);let m=u();return C(m.inviteUser(l))}),o()}if(i&2){let e=u();U("userLimits",e.userLimits())}}function Gt(i,t){if(i&1){let e=I();r(0,"app-upgrade-prompt-modal",60),b("close",function(){f(e);let l=u();return C(l.showUpgradeModal.set(!1))})("upgrade",function(l){f(e);let m=u();return C(m.handleUpgrade(l))}),o()}if(i&2){let e=u();U("upgradePrompt",e.upgradePromptData())}}var Be=class i{userService=Z(se);subscriptionService=Z(oe);router=Z(Ce);users=y([]);currentUser=y(null);stats=y(null);userLimits=y(null);invitations=y([]);loading=y(!1);showInviteModal=y(!1);showUpgradeModal=y(!1);upgradePromptData=y(null);searchTerm="";showTierInfo=!1;filteredUsers=xe(()=>{let t=this.users(),e=this.searchTerm.toLowerCase();return e?t.filter(n=>n.fullName.toLowerCase().includes(e)||n.email.toLowerCase().includes(e)||n.role.toLowerCase().includes(e)):t});pendingInvitations=xe(()=>this.invitations().filter(t=>t.status==="pending"));ngOnInit(){this.loadData()}loadData(){this.loading.set(!0),this.userService.getUsers().subscribe({next:t=>this.users.set(t),error:t=>console.error("Error loading users:",t)}),this.userService.getCurrentUser().subscribe({next:t=>this.currentUser.set(t),error:t=>console.error("Error loading current user:",t)}),this.userService.getUserStats().subscribe({next:t=>{this.stats.set(t),this.loading.set(!1)},error:t=>{console.error("Error loading stats:",t),this.loading.set(!1)}}),this.userService.getUserLimits().subscribe({next:t=>this.userLimits.set(t),error:t=>console.error("Error loading limits:",t)}),this.userService.invitations$.subscribe({next:t=>this.invitations.set(t),error:t=>console.error("Error loading invitations:",t)})}onSearchChange(t){this.searchTerm=t}openInviteModal(){if(!this.userLimits()?.canAddUser){this.showUpgradePrompt();return}this.showInviteModal.set(!0)}inviteUser(t){this.userService.inviteUser(t).subscribe({next:()=>{this.showInviteModal.set(!1),this.loadData()},error:e=>{console.error("Error inviting user:",e),e.message.includes("User limit reached")&&this.showUpgradePrompt()}})}updateUserRole(t,e){this.userService.updateUserRole(t,e).subscribe({next:()=>this.loadData(),error:n=>console.error("Error updating user role:",n)})}updateUserStatus(t,e){this.userService.updateUserStatus(t,e).subscribe({next:()=>this.loadData(),error:n=>console.error("Error updating user status:",n)})}removeUser(t){confirm("Are you sure you want to remove this user?")&&this.userService.removeUser(t).subscribe({next:()=>this.loadData(),error:e=>console.error("Error removing user:",e)})}resendInvitation(t){this.userService.resendInvitation(t).subscribe({next:()=>this.loadData(),error:e=>console.error("Error resending invitation:",e)})}cancelInvitation(t){this.userService.cancelInvitation(t).subscribe({next:()=>this.loadData(),error:e=>console.error("Error cancelling invitation:",e)})}showUpgradePrompt(){this.subscriptionService.getTierComparison().subscribe({next:t=>{if(t.recommendedTierId){let e=t.tiers.find(l=>l.id===t.currentTierId),n=t.tiers.find(l=>l.id===t.recommendedTierId);this.upgradePromptData.set({currentTier:e,suggestedTier:n,benefits:this.getUpgradeBenefits(t.currentTierId,t.recommendedTierId),priceComparison:{currentPrice:e.price,newPrice:n.price,additionalCost:n.price-e.price}}),this.showUpgradeModal.set(!0)}}})}handleUpgrade(t){this.subscriptionService.upgradeTo(t).subscribe({next:()=>{this.showUpgradeModal.set(!1),this.loadData()},error:e=>console.error("Error upgrading:",e)})}getUpgradeBenefits(t,e){return t==="solo"&&e==="starter"?["Add up to 5 team members","Advanced reports and analytics","Mobile app access","Email notifications","Priority support"]:t==="starter"&&e==="professional"?["Unlimited team members","Team collaboration tools","API access","Custom integrations","Priority phone support"]:[]}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=B({type:i,selectors:[["app-users"]],decls:41,vars:27,consts:[[1,"p-6","space-y-6"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between"],[1,"text-2xl","font-bold","text-white"],[1,"mt-1","text-sm","text-gray-300"],[1,"mt-4","sm:mt-0","flex","space-x-3"],[1,"btn-secondary",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"hidden","sm:inline"],[1,"btn-primary",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"glass-card","p-4"],[1,"bg-red-900/20","border","border-red-500/30","rounded-lg","p-4"],[3,"stats"],[1,"space-y-4"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-white"],[1,"ml-2","text-sm","font-normal","text-gray-400"],[1,"relative"],["type","text",1,"w-64","px-4","py-2","pl-10","bg-gray-800/50","border","border-gray-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel","placeholder"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"absolute","left-3","top-2.5","h-4","w-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"text-center","py-12"],[3,"userLimits"],[3,"upgradePrompt"],[1,"text-sm","text-gray-300"],[1,"flex","items-center","space-x-4"],[1,"btn-secondary","text-xs"],[1,"text-right"],[1,"text-sm","text-gray-400"],[1,"text-lg","font-bold","text-white"],[1,"w-32","bg-gray-700","rounded-full","h-2"],[1,"bg-blue-600","h-2","rounded-full","transition-all","duration-300"],[1,"btn-secondary","text-xs",3,"click"],[1,"flex","items-start"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","text-red-400","mt-0.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.98-.833-2.75 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"ml-3"],[1,"text-sm","font-medium","text-red-400"],[1,"mt-1","text-sm","text-red-300"],[1,"mt-2","btn-primary","text-sm"],[1,"mt-2","btn-primary","text-sm",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"mt-2","text-sm","font-medium","text-white"],[1,"mt-1","text-sm","text-gray-400"],[1,"mt-6"],[1,"btn-primary",3,"click"],[1,"grid","gap-4","grid-cols-1","lg:grid-cols-2","xl:grid-cols-3"],[3,"user","currentUser"],[1,"mt-8"],[3,"updateRole","updateStatus","removeUser","user","currentUser"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"space-y-2"],[1,"glass-card","p-4","flex","items-center","justify-between"],[1,"text-white","font-medium"],[1,"flex","space-x-2"],[1,"btn-secondary","text-sm",3,"click"],[1,"btn-danger","text-sm",3,"click"],[3,"close","invite","userLimits"],[3,"close","upgrade","upgradePrompt"]],template:function(e,n){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),s(4),d(5,"translate"),o(),r(6,"p",3),s(7),d(8,"translate"),o()(),r(9,"div",4)(10,"button",5),b("click",function(){return n.showTierInfo=!n.showTierInfo}),w(),r(11,"svg",6),h(12,"path",7),o(),S(),r(13,"span",8),s(14),d(15,"translate"),o()(),r(16,"button",9),b("click",function(){return n.openInviteModal()}),w(),r(17,"svg",6),h(18,"path",10),o(),S(),r(19,"span",8),s(20),d(21,"translate"),o()()()(),v(22,Vt,13,15,"div",11),v(23,Pt,12,10,"div",12),v(24,Lt,1,1,"app-user-stats",13),r(25,"div",14)(26,"div",15)(27,"h2",16),s(28),d(29,"translate"),r(30,"span",17),s(31),o()(),r(32,"div",18)(33,"input",19),d(34,"translate"),z("ngModelChange",function(m){return F(n.searchTerm,m)||(n.searchTerm=m),m}),b("ngModelChange",function(m){return n.onSearchChange(m)}),o(),w(),r(35,"svg",20),h(36,"path",21),o()()(),v(37,jt,10,7,"div",22)(38,zt,4,1),o()(),v(39,Ot,1,1,"app-user-invite-modal",23),v(40,Gt,1,1,"app-upgrade-prompt-modal",24)),e&2){let l,m;a(4),c(" ",p(5,15,"users.teamManagement")," "),a(3),c(" ",p(8,17,"users.manageTeamMembers")," "),a(7),g(p(15,19,"users.tierInfo")),a(2),U("disabled",!((l=n.userLimits())!=null&&l.canAddUser)),a(4),g(p(21,21,"users.inviteUser")),a(2),x(n.showTierInfo&&n.userLimits()?22:-1),a(),x((m=n.userLimits())!=null&&m.canAddUser?-1:23),a(),x(n.stats()?24:-1),a(4),c(" ",p(29,23,"users.teamMembers")," "),a(3),c(" (",n.users().length,") "),a(2),N("ngModel",n.searchTerm),U("placeholder",p(34,25,"users.searchUsers")),a(4),x(n.filteredUsers().length===0&&!n.loading()?37:38),a(2),x(n.showInviteModal()?39:-1),a(),x(n.showUpgradeModal()&&n.upgradePromptData()?40:-1)}},dependencies:[P,H,he,ae,ie,ne,re,L,le,pe,ce,me],encapsulation:2})};export{Be as UsersComponent};
