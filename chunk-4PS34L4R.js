import{E as c,a as p,b as m,f as n,h as s,u as S}from"./chunk-JES5V5RQ.js";var h=class k{partsSubject=new n([]);parts$=this.partsSubject.asObservable();suppliersSubject=new n([]);suppliers$=this.suppliersSubject.asObservable();stockMovementsSubject=new n([]);stockMovements$=this.stockMovementsSubject.asObservable();ordersSubject=new n([]);orders$=this.ordersSubject.asObservable();alertsSubject=new n([]);alerts$=this.alertsSubject.asObservable();searchQuery=c("");selectedCategory=c("all");selectedSupplier=c("all");selectedStockStatus=c("all");mockSuppliers=[{id:"supplier1",name:"Auto Parts Tunisia",contactPerson:"Karim Bouaziz",phone:"+216-70-123-456",email:"contact@autoparts.tn",address:"Avenue Habib Bourguiba, Tunis",paymentTerms:"30 days",deliveryTime:3,isActive:!0,createdAt:new Date(2024,0,15)},{id:"supplier2",name:"European Auto Supply",contactPerson:"Marc Dubois",phone:"+216-71-654-321",email:"info@euroautosupply.tn",address:"Zone Industrielle, Sfax",paymentTerms:"15 days",deliveryTime:5,isActive:!0,createdAt:new Date(2024,1,20)},{id:"supplier3",name:"Maghreb Motors Parts",contactPerson:"Amina Khelifi",phone:"+216-72-987-654",email:"sales@maghrebmotors.tn",address:"Route de Sousse, Monastir",paymentTerms:"45 days",deliveryTime:2,isActive:!0,createdAt:new Date(2024,2,10)}];mockParts=[{id:"part1",name:"Engine Oil 5W-30",partNumber:"EO-5W30-5L",description:"Synthetic engine oil for modern engines",category:"fluids",supplierId:"supplier1",brand:"Total",price:45.5,currency:"TND",stockLevel:12,minStockLevel:5,maxStockLevel:50,unit:"bottle",location:"Shelf A-1",isActive:!0,createdAt:new Date(2024,0,15),updatedAt:new Date(2025,7,20),stockStatus:"in-stock",totalUsageThisMonth:8,averageMonthlyUsage:10,daysUntilReorder:15},{id:"part2",name:"Brake Pads Front Set",partNumber:"BP-FRONT-BMW-X5",description:"Front brake pads for BMW X5 series",category:"brakes",supplierId:"supplier2",brand:"Bosch",price:180,currency:"TND",stockLevel:2,minStockLevel:4,maxStockLevel:20,unit:"set",location:"Shelf B-3",isActive:!0,createdAt:new Date(2024,1,10),updatedAt:new Date(2025,7,18),stockStatus:"low-stock",totalUsageThisMonth:3,averageMonthlyUsage:4,daysUntilReorder:7},{id:"part3",name:"Air Filter",partNumber:"AF-UNIVERSAL-001",description:"Universal air filter for most car models",category:"filters",supplierId:"supplier1",brand:"Mann",price:25.9,currency:"TND",stockLevel:0,minStockLevel:8,maxStockLevel:40,unit:"piece",location:"Shelf A-5",isActive:!0,createdAt:new Date(2024,1,5),updatedAt:new Date(2025,7,25),stockStatus:"out-of-stock",totalUsageThisMonth:6,averageMonthlyUsage:8,daysUntilReorder:0},{id:"part4",name:"Spark Plugs Set",partNumber:"SP-4CYL-NGK",description:"NGK spark plugs for 4-cylinder engines",category:"engine",supplierId:"supplier3",brand:"NGK",price:65,currency:"TND",stockLevel:8,minStockLevel:6,maxStockLevel:30,unit:"set",location:"Shelf C-2",isActive:!0,createdAt:new Date(2024,2,1),updatedAt:new Date(2025,7,22),stockStatus:"in-stock",totalUsageThisMonth:2,averageMonthlyUsage:3,daysUntilReorder:20},{id:"part5",name:"Tire 205/55R16",partNumber:"TR-205-55-16-MX",description:"Michelin tire 205/55R16 for sedans",category:"tires",supplierId:"supplier2",brand:"Michelin",price:320,currency:"TND",stockLevel:16,minStockLevel:8,maxStockLevel:40,unit:"piece",location:"Tire Rack 1",isActive:!0,createdAt:new Date(2024,2,15),updatedAt:new Date(2025,7,19),stockStatus:"in-stock",totalUsageThisMonth:4,averageMonthlyUsage:6,daysUntilReorder:25}];mockStockMovements=[{id:"movement1",partId:"part1",type:"out",quantity:2,reason:"Used in service job #SJ001",reference:"SJ001",performedBy:"mechanic1",createdAt:new Date(2025,7,25),notes:"Oil change for BMW X5"},{id:"movement2",partId:"part2",type:"out",quantity:1,reason:"Used in service job #SJ002",reference:"SJ002",performedBy:"mechanic2",createdAt:new Date(2025,7,24),notes:"Brake pad replacement"},{id:"movement3",partId:"part3",type:"in",quantity:10,reason:"Stock replenishment",reference:"PO001",performedBy:"admin1",createdAt:new Date(2025,7,20),notes:"Restocked air filters"}];mockAlerts=[{id:"alert1",partId:"part3",type:"out-of-stock",message:"Air Filter is out of stock",severity:"critical",isRead:!1,createdAt:new Date(2025,7,25)},{id:"alert2",partId:"part2",type:"low-stock",message:"Brake Pads Front Set stock is low (2 remaining)",severity:"warning",isRead:!1,createdAt:new Date(2025,7,24)}];constructor(){this.partsSubject.next(this.mockParts),this.suppliersSubject.next(this.mockSuppliers),this.stockMovementsSubject.next(this.mockStockMovements),this.alertsSubject.next(this.mockAlerts)}getParts(){return this.parts$}getPartById(t){return this.mockParts.find(e=>e.id===t)}createPart(t){let e=m(p({},t),{id:Date.now().toString(),createdAt:new Date,updatedAt:new Date,stockStatus:this.calculateStockStatus(t.stockLevel,t.minStockLevel),totalUsageThisMonth:0,averageMonthlyUsage:0,daysUntilReorder:this.calculateDaysUntilReorder(t.stockLevel,0)});return this.mockParts.push(e),this.partsSubject.next([...this.mockParts]),s(e)}updatePart(t,e){let r=this.mockParts.findIndex(o=>o.id===t);if(r!==-1){let o=m(p(p({},this.mockParts[r]),e),{updatedAt:new Date,stockStatus:this.calculateStockStatus(e.stockLevel??this.mockParts[r].stockLevel,e.minStockLevel??this.mockParts[r].minStockLevel)});return this.mockParts[r]=o,this.partsSubject.next([...this.mockParts]),s(o)}throw new Error("Part not found")}deletePart(t){let e=this.mockParts.findIndex(r=>r.id===t);return e!==-1?(this.mockParts.splice(e,1),this.partsSubject.next([...this.mockParts]),s(!0)):s(!1)}adjustStock(t,e,r,o){let l=this.getPartById(t);if(!l)throw new Error("Part not found");let u={id:Date.now().toString(),partId:t,type:e>0?"in":"out",quantity:Math.abs(e),reason:r,performedBy:o,createdAt:new Date},d=l.stockLevel+e;return this.updatePart(t,{stockLevel:d}),this.mockStockMovements.push(u),this.stockMovementsSubject.next([...this.mockStockMovements]),this.checkAndCreateAlerts(t,d),s(u)}getStockMovements(t){let e=t?this.mockStockMovements.filter(r=>r.partId===t):this.mockStockMovements;return s(e.sort((r,o)=>o.createdAt.getTime()-r.createdAt.getTime()))}getSuppliers(){return this.suppliers$}getSupplierById(t){return this.mockSuppliers.find(e=>e.id===t)}getPartsByCategory(t){let e=this.mockParts.filter(r=>r.category===t);return s(e)}getPartsBySupplier(t){let e=this.mockParts.filter(r=>r.supplierId===t);return s(e)}getPartsByStockStatus(t){let e=this.mockParts.filter(r=>r.stockStatus===t);return s(e)}searchParts(t){let e=this.mockParts.filter(r=>r.name.toLowerCase().includes(t.toLowerCase())||r.partNumber.toLowerCase().includes(t.toLowerCase())||r.brand.toLowerCase().includes(t.toLowerCase())||r.description?.toLowerCase().includes(t.toLowerCase()));return s(e)}getAlerts(){return this.alerts$}markAlertAsRead(t){let e=this.mockAlerts.findIndex(r=>r.id===t);return e!==-1?(this.mockAlerts[e].isRead=!0,this.alertsSubject.next([...this.mockAlerts]),s(!0)):s(!1)}getInventoryStats(){let t=this.mockParts.length,e=this.mockParts.reduce((a,i)=>a+i.price*i.stockLevel,0),r=this.mockParts.filter(a=>a.stockStatus==="low-stock").length,o=this.mockParts.filter(a=>a.stockStatus==="out-of-stock").length,l=this.mockParts.reduce((a,i)=>(a[i.category]=(a[i.category]||0)+1,a),{}),u=[...this.mockParts].sort((a,i)=>i.totalUsageThisMonth-a.totalUsageThisMonth).slice(0,5),d=[...this.mockStockMovements].sort((a,i)=>i.createdAt.getTime()-a.createdAt.getTime()).slice(0,10);return s({totalParts:t,totalValue:e,lowStockCount:r,outOfStockCount:o,pendingOrdersCount:0,categoryCounts:l,topUsedParts:u,recentMovements:d})}getAvailableCategories(){return["engine","transmission","brakes","suspension","electrical","filters","fluids","tires","body","accessories","consumables"]}getStockStatusColor(t){return{"in-stock":"text-green-600","low-stock":"text-amber-600","out-of-stock":"text-red-600",ordered:"text-blue-600"}[t]||"text-gray-600"}getStockStatusBadgeClass(t){return{"in-stock":"badge badge-in-stock","low-stock":"badge badge-low-stock","out-of-stock":"badge badge-out-of-stock",ordered:"badge badge-ordered"}[t]||"badge badge-ordered"}getCategoryIcon(t){return{engine:"engine",transmission:"gears",brakes:"disc",suspension:"spring",electrical:"zap",filters:"filter",fluids:"droplet",tires:"circle",body:"car",accessories:"tool",consumables:"package"}[t]||"package"}calculateStockStatus(t,e){return t===0?"out-of-stock":t<=e?"low-stock":"in-stock"}calculateDaysUntilReorder(t,e){return e===0?999:Math.floor(t/(e/30))}checkAndCreateAlerts(t,e){let r=this.getPartById(t);r&&(this.mockAlerts=this.mockAlerts.filter(o=>o.partId!==t),e===0?this.mockAlerts.push({id:Date.now().toString(),partId:t,type:"out-of-stock",message:`${r.name} is out of stock`,severity:"critical",isRead:!1,createdAt:new Date}):e<=r.minStockLevel&&this.mockAlerts.push({id:Date.now().toString(),partId:t,type:"low-stock",message:`${r.name} stock is low (${e} remaining)`,severity:"warning",isRead:!1,createdAt:new Date}),this.alertsSubject.next([...this.mockAlerts]))}static \u0275fac=function(e){return new(e||k)};static \u0275prov=S({token:k,factory:k.\u0275fac,providedIn:"root"})};export{h as a};
