import{Fa as m,Ib as v,P as c,U as u,ca as L,ec as S,ga as b,j as g,m as d,q as f,y as h}from"./chunk-BYA6T2VX.js";var p=class s{STORAGE_KEY="opauth_language";supportedLanguages=[{code:"en",name:"English",nativeName:"English",flag:"\u{1F1FA}\u{1F1F8}"},{code:"fr",name:"French",nativeName:"Fran\xE7ais",flag:"\u{1F1EB}\u{1F1F7}"},{code:"ar",name:"Arabic",nativeName:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",flag:"\u{1F1F8}\u{1F1E6}"}];currentLanguageSubject=new g("en");currentLanguage$=this.currentLanguageSubject.asObservable();currentLanguage=b("en");constructor(){let e=this.getStoredLanguage();this.currentLanguage.set(e),this.currentLanguageSubject.next(e),this.setLanguage(e,!1)}setLanguage(e,t=!0){this.currentLanguage.set(e),this.currentLanguageSubject.next(e),t&&localStorage.setItem(this.STORAGE_KEY,e),this.updateDocumentDirection(e),document.documentElement.lang=e}getCurrentLanguage(){return this.currentLanguage()}getLanguageOption(e){return this.supportedLanguages.find(t=>t.code===e)}getNextLanguage(){let t=(this.supportedLanguages.findIndex(a=>a.code===this.currentLanguage())+1)%this.supportedLanguages.length;return this.supportedLanguages[t].code}cycleLanguage(){let e=this.getNextLanguage();this.setLanguage(e)}getStoredLanguage(){if(typeof window>"u")return"en";let e=localStorage.getItem(this.STORAGE_KEY),t=["en","fr","ar"];if(e&&t.includes(e))return e;let a=navigator.language.substr(0,2);return t.includes(a)?a:"en"}updateDocumentDirection(e){document.documentElement.dir="ltr",document.documentElement.setAttribute("data-direction","ltr")}isRTL(){return!1}formatText(e,t=e){return t}static \u0275fac=function(t){return new(t||s)};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};var l=class s{http=u(S);languageService=u(p);document=u(L);translationsSubject=new g({});translations$=this.translationsSubject.asObservable();loadedLanguages=new Set;translationsCache=new Map;constructor(){this.loadedLanguages.clear(),this.translationsCache.clear(),this.languageService.currentLanguage$.subscribe(e=>{this.loadTranslations(e)}),this.loadTranslations(this.languageService.getCurrentLanguage())}loadTranslations(e){if(this.loadedLanguages.has(e)){let i=this.translationsCache.get(e)||{};this.translationsSubject.next(i);return}let a=(this.document.getElementsByTagName("base")[0]?.getAttribute("href")||"/")+"assets/i18n/"+e+".json";this.http.get(a).pipe(h(i=>(console.warn(`Failed to load translations for ${e}:`,i),d({})))).subscribe(i=>{this.loadedLanguages.add(e),this.translationsCache.set(e,i),this.translationsSubject.next(i)})}translate(e,t){return this.translations$.pipe(f(a=>{let i=e.split("."),n=a;for(let r of i)if(n&&typeof n=="object"&&r in n)n=n[r];else return e;let o=typeof n=="string"?n:e;return t&&typeof o=="string"&&Object.keys(t).forEach(r=>{o=o.replace(new RegExp(`{{${r}}}`,"g"),t[r])}),o}))}forceReloadTranslations(){this.loadedLanguages.clear(),this.translationsCache.clear(),this.loadTranslations(this.languageService.getCurrentLanguage())}instant(e,t){let a=this.translationsSubject.value,i=e.split("."),n=a;for(let r of i)if(n&&typeof n=="object"&&r in n)n=n[r];else return e;let o=typeof n=="string"?n:e;return t&&typeof o=="string"&&Object.keys(t).forEach(r=>{o=o.replace(new RegExp(`{{${r}}}`,"g"),t[r])}),o}static \u0275fac=function(t){return new(t||s)};static \u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})};var j=class s{translationService=u(l);cdr=u(v);subscription;lastValue="";transform(e,t){if(!e)return"";this.subscription||(this.subscription=this.translationService.translations$.subscribe(()=>{this.cdr.markForCheck()}));let a=this.translationService.instant(e,t);return this.lastValue=a,a}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static \u0275fac=function(t){return new(t||s)};static \u0275pipe=m({name:"translate",type:s,pure:!1})};export{p as a,l as b,j as c};
