import{a as ne}from"./chunk-TTDXOVRM.js";import{a as re}from"./chunk-TZY2F7BG.js";import{b as q,c as g,d as R,e as G,f as j,i as $,j as H,l as W,o as z,p as Y,q as U,r as K,s as X,t as J,w as Q,x as Z,z as ee}from"./chunk-PAUVK7IQ.js";import{b as te,c as ie}from"./chunk-DWWTKPBQ.js";import{c as V,e as L}from"./chunk-FBP5ODJ6.js";import{$ as T,$a as b,Ab as s,Ca as M,Fb as F,Ha as x,U as y,Vb as B,Wb as D,Xb as N,Ya as m,Z as C,Za as o,_ as S,_a as n,_b as A,aa as O,ab as w,bb as I,cb as h,ga as _,kb as l,lb as u,mb as v,nb as k,ob as E,sa as r,tb as P,zb as c}from"./chunk-BYA6T2VX.js";function ae(d,e){if(d&1&&(o(0,"option",52),l(1),n()),d&2){let t=e.$implicit;m("value",t.id),r(),k(" ",t.name," - ",t.phone," ")}}function le(d,e){d&1&&(o(0,"div",53),l(1),c(2,"translate"),n()),d&2&&(r(),v(" ",s(2,1,"invoicing.create.customerRequired")," "))}function ce(d,e){if(d&1&&(o(0,"option",52),l(1),n()),d&2){let t=e.$implicit;m("value",t.id),r(),E(" ",t.make," ",t.model," (",t.licensePlate,") ")}}function se(d,e){d&1&&(o(0,"div",53),l(1),c(2,"translate"),n()),d&2&&(r(),v(" ",s(2,1,"invoicing.create.vehicleRequired")," "))}function de(d,e){if(d&1&&(o(0,"option",52),l(1),c(2,"titlecase"),n()),d&2){let t=e.$implicit;m("value",t),r(),v(" ",s(2,2,t)," ")}}function pe(d,e){if(d&1&&(o(0,"option",52),l(1),n()),d&2){let t=e.$implicit,i=h(3);m("value",t.id),r(),E(" ",t.name," - ",t.brand," (",i.formatCurrency(t.price),") ")}}function me(d,e){if(d&1){let t=w();o(0,"div",68)(1,"label",58),l(2),c(3,"translate"),n(),o(4,"select",69),I("change",function(a){C(t);let p=h().index,f=h();return S(f.onPartSelect(p,a.target.value))}),o(5,"option",17),l(6),c(7,"translate"),n(),x(8,pe,2,4,"option",18),n()()}if(d&2){let t=h(2);r(2),u(s(3,3,"invoicing.create.selectPart")),r(4),u(s(7,5,"invoicing.create.selectPartOptional")),r(2),m("ngForOf",t.parts())}}function ue(d,e){if(d&1&&(o(0,"option",52),l(1),n()),d&2){let t=e.$implicit,i=h(3);m("value",t.serviceCode),r(),k(" ",t.serviceName," (",i.formatCurrency(t.basePrice),") ")}}function ve(d,e){if(d&1){let t=w();o(0,"div",68)(1,"label",58),l(2),c(3,"translate"),n(),o(4,"select",70),I("change",function(a){C(t);let p=h().index,f=h();return S(f.onServiceSelect(p,a.target.value))}),o(5,"option",17),l(6),c(7,"translate"),n(),x(8,ue,2,3,"option",18),n()()}if(d&2){let t=h(2);r(2),u(s(3,3,"invoicing.create.selectService")),r(4),u(s(7,5,"invoicing.create.selectServiceOptional")),r(2),m("ngForOf",t.serviceRates())}}function ge(d,e){if(d&1){let t=w();o(0,"div",54)(1,"div",55)(2,"h4",37),l(3),c(4,"translate"),n(),o(5,"button",56),I("click",function(){let a=C(t).index,p=h();return S(p.removeLineItem(a))}),l(6," \u2715 "),n()(),o(7,"div",57)(8,"div")(9,"label",58),l(10),c(11,"translate"),n(),o(12,"select",59),I("change",function(){let a=C(t).index,p=h();return S(p.onLineItemTypeChange(a))}),x(13,de,3,4,"option",18),n()(),o(14,"div",60)(15,"label",58),l(16),c(17,"translate"),n(),b(18,"input",61),c(19,"translate"),n(),x(20,me,9,7,"div",62)(21,ve,9,7,"div",62),o(22,"div")(23,"label",58),l(24),c(25,"translate"),n(),b(26,"input",63),n(),o(27,"div")(28,"label",58),l(29),c(30,"translate"),n(),b(31,"input",64),c(32,"translate"),n(),o(33,"div")(34,"label",58),l(35),c(36,"translate"),n(),b(37,"input",65),n()(),o(38,"div",66)(39,"span",67),l(40),c(41,"translate"),n()()()}if(d&2){let t,i,a=e.$implicit,p=e.index,f=h();m("formGroup",a),r(3),k("",s(4,17,"invoicing.create.item")," ",p+1),r(7),u(s(11,19,"invoicing.create.type")),r(3),m("ngForOf",f.lineItemTypes),r(3),u(s(17,21,"invoicing.create.description")),r(2),m("placeholder",P(s(19,23,"invoicing.create.itemDescription"))),r(2),m("ngIf",((t=a.get("type"))==null?null:t.value)==="part"),r(),m("ngIf",((i=a.get("type"))==null?null:i.value)==="service"),r(3),u(s(25,25,"invoicing.create.quantity")),r(5),u(s(30,27,"invoicing.create.unit")),r(2),m("placeholder",P(s(32,29,"invoicing.create.unitPlaceholder"))),r(4),u(s(36,31,"invoicing.create.unitPrice")),r(5),k(" ",s(41,33,"invoicing.create.total"),": ",f.formatCurrency(f.calculateLineItemTotal(p))," ")}}function fe(d,e){if(d&1&&(o(0,"div",71)(1,"div",72)(2,"div")(3,"span",37),l(4),n()(),o(5,"div",8),l(6),n(),o(7,"div",8),l(8),n(),o(9,"div",8),l(10),n()()()),d&2){let t,i,a,p,f=h();r(4),u((t=f.getSelectedCustomer())==null?null:t.name),r(2),v(" ",(i=f.getSelectedCustomer())==null?null:i.phone," "),r(2),E(" ",(a=f.getSelectedCar())==null?null:a.make," ",(a=f.getSelectedCar())==null?null:a.model," (",(a=f.getSelectedCar())==null?null:a.year,") "),r(2),v(" ",(p=f.getSelectedCar())==null?null:p.licensePlate," ")}}function be(d,e){d&1&&b(0,"div",73)}function xe(d,e){d&1&&(o(0,"div",74)(1,"div",75),b(2,"div",76),o(3,"span",77),l(4),c(5,"translate"),n()()()),d&2&&(r(4),u(s(5,1,"invoicing.create.loadingFormData")))}var oe=class d{fb=y(Z);router=y(L);route=y(V);invoiceService=y(re);partService=y(ne);translationService=y(te);invoiceForm;isLoading=_(!1);isSubmitting=_(!1);isEditMode=_(!1);currentInvoice=_(null);customers=_([]);cars=_([]);parts=_([]);serviceRates=_([]);suppliers=_([]);subtotal=F(()=>this.calculateSubtotal());taxAmount=F(()=>this.calculateTaxAmount());discountAmount=F(()=>this.calculateDiscountAmount());totalAmount=F(()=>this.calculateTotalAmount());lineItemTypes=["service","part","labor","misc"];constructor(){this.invoiceForm=this.fb.group({customerId:["",g.required],carId:["",g.required],issueDate:[new Date().toISOString().split("T")[0],g.required],dueDate:[this.getDefaultDueDate(),g.required],currency:["TND",g.required],taxRate:[19,[g.required,g.min(0),g.max(100)]],discountPercentage:[0,[g.min(0),g.max(100)]],paymentTerms:["Payment due within 30 days",g.required],notes:[""],lineItems:this.fb.array([])})}ngOnInit(){this.loadReferenceData();let e=this.route.snapshot.paramMap.get("id");e?this.loadInvoiceForEdit(e):this.addLineItem()}get lineItems(){return this.invoiceForm.get("lineItems")}loadReferenceData(){this.isLoading.set(!0),this.partService.getParts().subscribe({next:e=>this.parts.set(e),error:e=>console.error("Failed to load parts:",e)}),this.partService.getSuppliers().subscribe({next:e=>this.suppliers.set(e),error:e=>console.error("Failed to load suppliers:",e)}),this.invoiceService.getServiceRates().subscribe({next:e=>this.serviceRates.set(e),error:e=>console.error("Failed to load service rates:",e)}),this.customers.set([{id:"customer1",name:"Ahmed Ben Ali",phone:"+216-20-123-456",email:"ahmed.benali@email.tn"},{id:"customer2",name:"Fatma Trabelsi",phone:"+216-25-789-123",email:"fatma.trabelsi@email.tn"},{id:"customer3",name:"Mohamed Khemir",phone:"+216-22-456-789",email:"mohamed.khemir@email.tn"}]),this.cars.set([{id:"car1",licensePlate:"123 TUN 2024",make:"BMW",model:"X5",year:2020,customerId:"customer1"},{id:"car2",licensePlate:"456 TUN 2019",make:"Honda",model:"Civic",year:2019,customerId:"customer2"},{id:"car4",licensePlate:"321 TUN 2022",make:"Mercedes",model:"C-Class",year:2022,customerId:"customer3"}]),this.isLoading.set(!1)}loadInvoiceForEdit(e){let t=this.invoiceService.getInvoiceById(e);t&&(this.isEditMode.set(!0),this.currentInvoice.set(t),this.populateFormWithInvoice(t))}populateFormWithInvoice(e){this.invoiceForm.patchValue({customerId:e.customerId,carId:e.carId,issueDate:e.issueDate.toISOString().split("T")[0],dueDate:e.dueDate.toISOString().split("T")[0],currency:e.currency,taxRate:e.taxRate,discountPercentage:e.discountPercentage,paymentTerms:e.paymentTerms,notes:e.notes});let t=this.lineItems;t.clear(),e.lineItems.forEach(i=>{t.push(this.createLineItemGroup(i))})}createLineItemGroup(e){return this.fb.group({type:[e?.type||"service",g.required],description:[e?.description||"",g.required],quantity:[e?.quantity||1,[g.required,g.min(.01)]],unit:[e?.unit||"piece",g.required],unitPrice:[e?.unitPrice||0,[g.required,g.min(0)]],partId:[e?.partId||""],serviceCode:[e?.serviceCode||""],mechanicId:[e?.mechanicId||""],laborHours:[e?.laborHours||0],discountPercentage:[e?.discountPercentage||0,[g.min(0),g.max(100)]],taxable:[e?.taxable??!0]})}addLineItem(){this.lineItems.push(this.createLineItemGroup())}removeLineItem(e){this.lineItems.removeAt(e)}onLineItemTypeChange(e){let t=this.lineItems.at(e),i=t.get("type")?.value;t.patchValue({partId:"",serviceCode:"",mechanicId:"",laborHours:0}),i==="labor"?t.patchValue({unit:"hour",unitPrice:80,description:"Mechanic Labor"}):i==="service"&&t.patchValue({unit:"service",description:"Service"})}onPartSelect(e,t){let i=this.parts().find(a=>a.id===t);i&&this.lineItems.at(e).patchValue({description:`${i.name} - ${i.brand}`,unit:i.unit,unitPrice:i.price})}onServiceSelect(e,t){let i=this.serviceRates().find(a=>a.serviceCode===t);i&&this.lineItems.at(e).patchValue({description:i.serviceName,unit:"service",unitPrice:i.basePrice,laborHours:i.laborHours})}onCustomerChange(){let e=this.invoiceForm.get("customerId")?.value;if(e){let t=this.cars().filter(i=>i.customerId===e);t.length===1&&this.invoiceForm.patchValue({carId:t[0].id})}}getCustomerCars(){let e=this.invoiceForm.get("customerId")?.value;return e?this.cars().filter(t=>t.customerId===e):[]}calculateLineItemTotal(e){let t=this.lineItems.at(e),i=t.get("quantity")?.value||0,a=t.get("unitPrice")?.value||0,p=t.get("discountPercentage")?.value||0;return this.invoiceService.calculateLineItemTotal(i,a,p)}calculateSubtotal(){let e=0;for(let t=0;t<this.lineItems.length;t++)e+=this.calculateLineItemTotal(t);return e}calculateDiscountAmount(){let e=this.subtotal(),t=this.invoiceForm.get("discountPercentage")?.value||0;return e*t/100}calculateTaxAmount(){let e=this.subtotal()-this.discountAmount(),t=this.invoiceForm.get("taxRate")?.value||0;return e*t/100}calculateTotalAmount(){return this.subtotal()-this.discountAmount()+this.taxAmount()}onSubmit(){if(this.invoiceForm.valid&&!this.isSubmitting()){this.isSubmitting.set(!0);let e=this.invoiceForm.value,t=e.lineItems.map((a,p)=>({id:`line_${Date.now()}_${p}`,type:a.type,description:a.description,quantity:a.quantity,unit:a.unit,unitPrice:a.unitPrice,totalPrice:this.calculateLineItemTotal(p),partId:a.partId||void 0,serviceCode:a.serviceCode||void 0,mechanicId:a.mechanicId||void 0,laborHours:a.laborHours||void 0,discountPercentage:a.discountPercentage||void 0,taxable:a.taxable})),i={customerId:e.customerId,carId:e.carId,issueDate:new Date(e.issueDate),dueDate:new Date(e.dueDate),status:"draft",currency:e.currency,taxRate:e.taxRate,discountPercentage:e.discountPercentage,paidAmount:0,lineItems:t,notes:e.notes,paymentTerms:e.paymentTerms,createdBy:"current-user"};if(this.isEditMode()){let a=this.currentInvoice()?.id;a&&this.invoiceService.updateInvoice(a,i).subscribe({next:p=>{this.router.navigate(["/invoices",p.id])},error:p=>{console.error("Failed to update invoice:",p),this.isSubmitting.set(!1)}})}else this.invoiceService.createInvoice(i).subscribe({next:a=>{this.router.navigate(["/invoices",a.id])},error:a=>{console.error("Failed to create invoice:",a),this.isSubmitting.set(!1)}})}else this.markFormGroupTouched(this.invoiceForm)}onSaveAsDraft(){this.invoiceForm.get("customerId")?.valid&&this.invoiceForm.get("carId")?.valid&&this.onSubmit()}onCancel(){this.router.navigate(["/invoices"])}markFormGroupTouched(e){Object.keys(e.controls).forEach(t=>{let i=e.get(t);i?.markAsTouched(),(i instanceof j||i instanceof Q)&&this.markFormGroupTouched(i)})}getDefaultDueDate(){let e=new Date;return e.setDate(e.getDate()+30),e.toISOString().split("T")[0]}formatCurrency(e){return this.invoiceService.formatCurrency(e)}getSelectedCustomer(){let e=this.invoiceForm.get("customerId")?.value;return this.customers().find(t=>t.id===e)}getSelectedCar(){let e=this.invoiceForm.get("carId")?.value;return this.cars().find(t=>t.id===e)}static \u0275fac=function(t){return new(t||d)};static \u0275cmp=M({type:d,selectors:[["app-invoice-form"]],decls:129,vars:92,consts:[[1,"min-h-screen","invoice-form-container","p-4","lg:p-6"],[1,"glass-card","invoice-form-header"],[1,"flex","items-center","gap-4"],[1,"btn-tertiary","btn-icon",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"flex-1"],[1,"text-2xl","lg:text-3xl","font-bold","text-white","mb-1"],[1,"text-gray-300"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","space-y-6"],[1,"glass-card"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-300","mb-2"],["formControlName","customerId",1,"form-select",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","text-red-500 text-xs mt-1",4,"ngIf"],["formControlName","carId",1,"form-select"],["type","date","formControlName","issueDate",1,"form-input","w-full","px-3","py-2","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-white","backdrop-blur-sm"],["type","date","formControlName","dueDate",1,"form-input","w-full","px-3","py-2","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-white","backdrop-blur-sm"],[1,"mt-4"],[1,"block","text-sm","font-medium","text-white","mb-2"],["type","text","formControlName","paymentTerms",1,"form-input","w-full","px-3","py-2","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-white","placeholder-gray-400","backdrop-blur-sm",3,"placeholder"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-white"],["type","button",1,"btn-primary","btn-sm",3,"click"],[1,"space-y-4"],["class","line-item p-4 rounded-lg",3,"formGroup",4,"ngFor","ngForOf"],["formControlName","notes","rows","4",1,"form-input","w-full","px-3","py-2","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-white","placeholder-gray-400","backdrop-blur-sm","resize-none",3,"placeholder"],[1,"space-y-6"],[1,"glass-card","sticky-summary"],["class","customer-info mb-6 p-4 rounded-lg",4,"ngIf"],[1,"space-y-3"],[1,"flex","justify-between","text-sm"],[1,"font-medium","text-white"],[1,"flex","items-center","gap-2"],["type","number","formControlName","discountPercentage","min","0","max","100","step","0.1",1,"form-input","w-16","px-2","py-1","text-xs","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-white","backdrop-blur-sm"],[1,"text-xs","text-gray-300"],["type","number","formControlName","taxRate","min","0","max","100","step","0.1",1,"form-input","w-16","px-2","py-1","text-xs","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-white","backdrop-blur-sm"],[1,"border-gray-500"],[1,"flex","justify-between"],[1,"font-semibold","text-white"],[1,"total-amount","font-bold","text-xl"],[1,"mt-6","space-y-3"],["type","submit",1,"btn-primary","w-full","px-4","py-3","font-medium","flex","items-center","justify-center","gap-2",3,"disabled"],["class","animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full",4,"ngIf"],["type","button",1,"btn-warning","w-full","px-4","py-2","font-medium",3,"click","disabled"],["type","button",1,"btn-tertiary","w-full","px-4","py-2",3,"click"],["class","loading-overlay fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50",4,"ngIf"],[3,"value"],[1,"text-red-500","text-xs","mt-1"],[1,"line-item","p-4","rounded-lg",3,"formGroup"],[1,"flex","items-center","justify-between","mb-3"],["type","button",1,"remove-item-btn","p-1","rounded",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-3"],[1,"block","text-xs","font-medium","text-gray-300","mb-1"],["formControlName","type",1,"form-select","text-sm",3,"change"],[1,"md:col-span-2"],["type","text","formControlName","description",1,"form-input","w-full","px-2","py-1","text-sm","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-white","placeholder-gray-400","backdrop-blur-sm",3,"placeholder"],["class","md:col-span-3",4,"ngIf"],["type","number","formControlName","quantity","min","0.01","step","0.01",1,"form-input","w-full","px-2","py-1","text-sm","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-white","backdrop-blur-sm"],["type","text","formControlName","unit",1,"form-input","w-full","px-2","py-1","text-sm","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-white","placeholder-gray-400","backdrop-blur-sm",3,"placeholder"],["type","number","formControlName","unitPrice","min","0","step","0.01",1,"form-input","w-full","px-2","py-1","text-sm","rounded","focus:outline-none","focus:ring-1","focus:ring-blue-500","text-white","backdrop-blur-sm"],[1,"mt-3","text-right"],[1,"text-sm","font-medium","text-white"],[1,"md:col-span-3"],["formControlName","partId",1,"form-select","text-sm",3,"change"],["formControlName","serviceCode",1,"form-select","text-sm",3,"change"],[1,"customer-info","mb-6","p-4","rounded-lg"],[1,"space-y-2","text-sm"],[1,"animate-spin","h-4","w-4","border-2","border-white","border-t-transparent","rounded-full"],[1,"loading-overlay","fixed","inset-0","bg-black/20","backdrop-blur-sm","flex","items-center","justify-center","z-50"],[1,"glass-card","flex","items-center","gap-3"],[1,"animate-spin","h-5","w-5","border-2","border-blue-400","border-t-transparent","rounded-full"],[1,"text-white"]],template:function(t,i){if(t&1&&(o(0,"div",0)(1,"header",1)(2,"div",2)(3,"button",3),I("click",function(){return i.onCancel()}),T(),o(4,"svg",4),b(5,"path",5),n()(),O(),o(6,"div",6)(7,"h1",7),l(8),c(9,"translate"),c(10,"translate"),n(),o(11,"p",8),l(12),c(13,"translate"),c(14,"translate"),n()()()(),o(15,"form",9),I("ngSubmit",function(){return i.onSubmit()}),o(16,"div",10)(17,"div",11)(18,"div",12)(19,"h2",13),l(20),c(21,"translate"),n(),o(22,"div",14)(23,"div")(24,"label",15),l(25),c(26,"translate"),n(),o(27,"select",16),I("change",function(){return i.onCustomerChange()}),o(28,"option",17),l(29),c(30,"translate"),n(),x(31,ae,2,3,"option",18),n(),x(32,le,3,3,"div",19),n(),o(33,"div")(34,"label",15),l(35),c(36,"translate"),n(),o(37,"select",20)(38,"option",17),l(39),c(40,"translate"),n(),x(41,ce,2,4,"option",18),n(),x(42,se,3,3,"div",19),n(),o(43,"div")(44,"label",15),l(45),c(46,"translate"),n(),b(47,"input",21),n(),o(48,"div")(49,"label",15),l(50),c(51,"translate"),n(),b(52,"input",22),n()(),o(53,"div",23)(54,"label",24),l(55),c(56,"translate"),n(),b(57,"input",25),c(58,"translate"),n()(),o(59,"div",12)(60,"div",26)(61,"h2",27),l(62),c(63,"translate"),n(),o(64,"button",28),I("click",function(){return i.addLineItem()}),l(65),c(66,"translate"),n()(),o(67,"div",29),x(68,ge,42,35,"div",30),n()(),o(69,"div",12)(70,"h2",13),l(71),c(72,"translate"),n(),o(73,"textarea",31),c(74,"translate"),l(75,"          "),n()()(),o(76,"div",32)(77,"div",33)(78,"h3",13),l(79),c(80,"translate"),n(),x(81,fe,11,6,"div",34),o(82,"div",35)(83,"div",36)(84,"span",8),l(85),c(86,"translate"),n(),o(87,"span",37),l(88),n()(),o(89,"div",36)(90,"span",8),l(91),c(92,"translate"),n(),o(93,"div",38),b(94,"input",39),o(95,"span",40),l(96,"%"),n(),o(97,"span",37),l(98),n()()(),o(99,"div",36)(100,"span",8),l(101),c(102,"translate"),n(),o(103,"div",38),b(104,"input",41),o(105,"span",40),l(106,"%"),n(),o(107,"span",37),l(108),n()()(),b(109,"hr",42),o(110,"div",43)(111,"span",44),l(112),c(113,"translate"),n(),o(114,"span",45),l(115),n()()(),o(116,"div",46)(117,"button",47),x(118,be,1,0,"div",48),l(119),c(120,"translate"),c(121,"translate"),n(),o(122,"button",49),I("click",function(){return i.onSaveAsDraft()}),l(123),c(124,"translate"),n(),o(125,"button",50),I("click",function(){return i.onCancel()}),l(126),c(127,"translate"),n()()()()()(),x(128,xe,6,3,"div",51),n()),t&2){let a,p;r(8),v(" ",i.isEditMode()?s(9,40,"invoicing.create.editTitle"):s(10,42,"invoicing.create.title")," "),r(4),v(" ",i.isEditMode()?s(13,44,"invoicing.create.editSubtitle"):s(14,46,"invoicing.create.subtitle")," "),r(3),m("formGroup",i.invoiceForm),r(5),u(s(21,48,"invoicing.create.invoiceDetails")),r(5),v(" ",s(26,50,"invoicing.create.customer")," * "),r(4),u(s(30,52,"invoicing.create.selectCustomer")),r(2),m("ngForOf",i.customers()),r(),m("ngIf",((a=i.invoiceForm.get("customerId"))==null?null:a.errors)&&((a=i.invoiceForm.get("customerId"))==null?null:a.touched)),r(3),v(" ",s(36,54,"invoicing.create.vehicle")," * "),r(4),u(s(40,56,"invoicing.create.selectVehicle")),r(2),m("ngForOf",i.getCustomerCars()),r(),m("ngIf",((p=i.invoiceForm.get("carId"))==null?null:p.errors)&&((p=i.invoiceForm.get("carId"))==null?null:p.touched)),r(3),v(" ",s(46,58,"invoicing.create.issueDate")," * "),r(5),v(" ",s(51,60,"invoicing.create.dueDate")," * "),r(5),v(" ",s(56,62,"invoicing.create.paymentTerms")," "),r(2),m("placeholder",P(s(58,64,"invoicing.create.paymentTermsPlaceholder"))),r(5),u(s(63,66,"invoicing.create.lineItems")),r(3),v(" + ",s(66,68,"invoicing.create.addItem")," "),r(3),m("ngForOf",i.lineItems.controls),r(3),u(s(72,70,"invoicing.create.additionalNotes")),r(2),m("placeholder",P(s(74,72,"invoicing.create.notesPlaceholder"))),r(6),u(s(80,74,"invoicing.create.invoiceSummary")),r(2),m("ngIf",i.getSelectedCustomer()&&i.getSelectedCar()),r(4),v("",s(86,76,"invoicing.create.subtotal"),":"),r(3),u(i.formatCurrency(i.subtotal())),r(3),v("",s(92,78,"invoicing.create.discount"),":"),r(7),u(i.formatCurrency(i.discountAmount())),r(3),v("",s(102,80,"invoicing.create.tax"),":"),r(7),u(i.formatCurrency(i.taxAmount())),r(4),v("",s(113,82,"invoicing.create.total"),":"),r(3),u(i.formatCurrency(i.totalAmount())),r(2),m("disabled",!i.invoiceForm.valid||i.isSubmitting()),r(),m("ngIf",i.isSubmitting()),r(),v(" ",i.isEditMode()?s(120,84,"invoicing.create.updateInvoice"):s(121,86,"invoicing.create.createInvoice")," "),r(3),m("disabled",i.isSubmitting()),r(),v(" ",s(124,88,"invoicing.create.saveAsDraft")," "),r(3),v(" ",s(127,90,"common.cancel")," "),r(2),m("ngIf",i.isLoading())}},dependencies:[A,B,D,N,ee,$,U,K,q,H,Y,R,G,J,X,W,z,ie],styles:[".invoice-form-container[_ngcontent-%COMP%]{min-height:100vh;background:transparent}.glass-card[_ngcontent-%COMP%]{background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.6);border-radius:20px;padding:1.5rem;box-shadow:0 8px 32px #000000b3;transition:all .3s cubic-bezier(.4,0,.2,1);margin-bottom:1rem}.glass-card[_ngcontent-%COMP%]:hover{background:#1f2937fa;box-shadow:0 12px 40px #000c;border-color:#3b82f6b3;transform:translateY(-2px)}.form-section[_ngcontent-%COMP%]{background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.6);border-radius:20px;padding:1.5rem;box-shadow:0 8px 32px #000000b3;margin-bottom:1rem}.form-input[_ngcontent-%COMP%]{background:#37415166!important;border:1px solid rgba(75,85,99,.6)!important;-webkit-backdrop-filter:blur(8px)!important;backdrop-filter:blur(8px)!important;color:#fff!important;transition:all .2s ease!important}.form-input[_ngcontent-%COMP%]:focus{background:#374151b3!important;border-color:#60a5fa!important;box-shadow:0 0 0 3px #60a5fa33!important}.line-item[_ngcontent-%COMP%]{background:#3741514d;border:1px solid rgba(75,85,99,.6);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);transition:all .2s ease}.line-item[_ngcontent-%COMP%]:hover{background:#37415180;border-color:#4b5563cc}.summary-sidebar[_ngcontent-%COMP%]{background:#ffffffe6;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.3)}.dark[_ngcontent-%COMP%]   .summary-sidebar[_ngcontent-%COMP%]{background:#1f2937e6;border:1px solid rgba(75,85,99,.4)}.sticky-summary[_ngcontent-%COMP%]{position:sticky;top:1.5rem}.customer-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f61a,#93c5fd0d);border:1px solid rgba(59,130,246,.2)}.dark[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f633,#93c5fd1a);border:1px solid rgba(59,130,246,.3)}.total-amount[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:800;text-shadow:none}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1d4ed8);box-shadow:0 4px 14px #3b82f64d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#1d4ed8,#1e40af);box-shadow:0 6px 20px #3b82f666;transform:translateY(-1px)}.btn-primary[_ngcontent-%COMP%]:disabled{background:#9ca3af;box-shadow:none;transform:none}.add-item-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669);transition:all .2s ease}.add-item-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#059669,#047857);transform:translateY(-1px);box-shadow:0 4px 12px #10b9814d}.remove-item-btn[_ngcontent-%COMP%]{transition:all .2s ease}.remove-item-btn[_ngcontent-%COMP%]:hover{background:#ef44441a;color:#dc2626;transform:scale(1.1)}@media (max-width: 768px){.sticky-summary[_ngcontent-%COMP%]{position:static}.form-grid[_ngcontent-%COMP%], .line-item-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.loading-overlay[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.form-input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ef4444;background-color:#fef2f280}.dark[_ngcontent-%COMP%]   .form-input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#f87171;background-color:#7f1d1d33}.form-input.ng-valid.ng-touched[_ngcontent-%COMP%]{border-color:#10b981}.dark[_ngcontent-%COMP%]   .form-input.ng-valid.ng-touched[_ngcontent-%COMP%]{border-color:#34d399}.error-text[_ngcontent-%COMP%]{color:#ef4444;font-size:.75rem;margin-top:.25rem}.dark[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{color:#fca5a5}input[type=number][_ngcontent-%COMP%]{font-variant-numeric:tabular-nums}.line-item[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.form-input[_ngcontent-%COMP%]:focus-visible{outline:2px solid #3b82f6;outline-offset:2px}"]})};export{oe as InvoiceFormComponent};
