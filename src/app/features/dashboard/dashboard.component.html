<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="dashboard-title text-4xl font-bold text-primary-700 dark:text-primary-300 mb-4">OpAuto Dashboard</h1>
        <p class="dashboard-subtitle text-lg text-gray-600 dark:text-gray-300">{{ getCurrentDate() }}</p>
      </div>
      <div class="header-actions">
        <app-language-toggle></app-language-toggle>
        <app-theme-toggle></app-theme-toggle>
      </div>
    </div>
  </header>

  <!-- Critical Overview Cards -->
  <div class="overview-grid mb-8">
    <!-- Today's Schedule -->
    <div class="glass-card schedule-card">
      <div class="card-header">
        <h2 class="card-title">Today's Schedule</h2>
        <div class="schedule-summary">
          <span class="text-2xl font-bold text-primary-600">{{ todayAppointments.length }}</span>
          <span class="text-sm text-gray-600 ml-1">appointments</span>
        </div>
      </div>
      <div class="schedule-list">
        @for (appointment of todayAppointments; track appointment.id) {
          <div class="appointment-item" [class.completed]="appointment.status === 'completed'">
            <div class="appointment-time">{{ appointment.time }}</div>
            <div class="appointment-details">
              <div class="customer-info">
                <span class="customer-name">{{ appointment.customerName }}</span>
                <span class="car-info">{{ appointment.carModel }} - {{ appointment.licensePlate }}</span>
              </div>
              <div class="service-info">
                <span class="service-type">{{ appointment.serviceType }}</span>
                <span class="status-badge" [ngClass]="getStatusBadgeClass(appointment.status)">
                  {{ appointment.status | titlecase }}
                </span>
              </div>
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Quick Stats -->
    <div class="glass-card stats-card">
      <h2 class="card-title mb-4">Today's Status</h2>
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-value text-success-600">{{ metrics.carsCompleted }}</div>
          <div class="stat-label">Completed</div>
        </div>
        <div class="stat-item">
          <div class="stat-value text-secondary-600">{{ metrics.carsInProgress }}</div>
          <div class="stat-label">In Progress</div>
        </div>
        <div class="stat-item">
          <div class="stat-value text-error-600">{{ metrics.carsWaitingApproval }}</div>
          <div class="stat-label">Need Approval</div>
        </div>
        <div class="stat-item">
          <div class="stat-value text-primary-600">{{ metrics.availableSlots }}/{{ metrics.totalSlots }}</div>
          <div class="stat-label">Available Slots</div>
        </div>
      </div>
      
      <!-- Revenue -->
      <div class="revenue-section mt-4 pt-4 border-t border-gray-200 dark:border-gray-600">
        <div class="revenue-amount text-2xl font-bold text-success-600 dark:text-success-400">
          {{ formatCurrency(metrics.todayRevenue) }}
        </div>
        <div class="revenue-label text-sm text-gray-600 dark:text-gray-400">Today's Revenue</div>
      </div>
    </div>
  </div>

  <!-- Active Jobs Section -->
  <div class="section-container mb-8">
    <h2 class="section-title">Cars Currently Being Worked On</h2>
    <div class="active-jobs-grid">
      @for (job of activeJobs; track job.id) {
        <div class="glass-card job-card">
          <div class="job-header">
            <div class="car-info">
              <h3 class="customer-name">{{ job.customerName }}</h3>
              <p class="car-details">{{ job.carModel }} - {{ job.licensePlate }}</p>
            </div>
            <span class="status-badge" [ngClass]="getStatusBadgeClass(job.status)">
              {{ job.status.replace('_', ' ') | titlecase }}
            </span>
          </div>
          
          <div class="services-list">
            @for (service of job.services; track service) {
              <span class="service-tag">{{ service }}</span>
            }
          </div>

          <div class="job-progress">
            <div class="progress-header">
              <span class="progress-label">Progress</span>
              <span class="progress-percentage">{{ job.progress }}%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" 
                   [style.width.%]="job.progress" 
                   [ngClass]="getProgressBarClass(job.progress)">
              </div>
            </div>
          </div>

          <div class="job-footer">
            <div class="mechanic-info">
              <span class="mechanic-label">Mechanic:</span>
              <span class="mechanic-name">{{ job.mechanic }}</span>
            </div>
            <div class="time-info">
              <span class="time-label">Est. Complete:</span>
              <span class="completion-time">{{ job.estimatedCompletion }}</span>
            </div>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- Urgent Actions -->
  @if (metrics.carsWaitingApproval > 0) {
    <div class="section-container mb-8">
      <h2 class="section-title text-error-600">ðŸš¨ Urgent Actions Required</h2>
      <div class="glass-card urgent-card">
        <div class="urgent-content">
          <div class="urgent-icon">
            <svg class="w-8 h-8 text-error-500" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
            </svg>
          </div>
          <div class="urgent-text">
            <h3 class="urgent-title">{{ metrics.carsWaitingApproval }} jobs need your approval</h3>
            <p class="urgent-description">Parts purchases and repair estimates are waiting for approval</p>
          </div>
          <div class="urgent-actions">
            <button class="btn btn-error">Review Approvals</button>
          </div>
        </div>
      </div>
    </div>
  }

  <!-- Quick Actions -->
  <div class="section-container">
    <h2 class="section-title">Quick Actions</h2>
    <div class="quick-actions-grid">
      <button class="action-card glass-card" (click)="navigateToNewCar()">
        <div class="action-icon action-icon-primary">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
          </svg>
        </div>
        <div class="action-content">
          <h3 class="action-title">New Car Entry</h3>
          <p class="action-description">Register a walk-in customer</p>
        </div>
      </button>

      <button class="action-card glass-card" (click)="navigateToAppointments()">
        <div class="action-icon action-icon-secondary">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
          </svg>
        </div>
        <div class="action-content">
          <h3 class="action-title">Schedule Appointment</h3>
          <p class="action-description">Book future service</p>
        </div>
      </button>

      <button class="action-card glass-card" (click)="navigateToInvoiceCreate()">
        <div class="action-icon action-icon-success">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 2 2h10c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/>
          </svg>
        </div>
        <div class="action-content">
          <h3 class="action-title">Generate Invoice</h3>
          <p class="action-description">Create bill for completed job</p>
        </div>
      </button>

      <button class="action-card glass-card" (click)="navigateToMaintenanceActive()">
        <div class="action-icon action-icon-automotive">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
        </div>
        <div class="action-content">
          <h3 class="action-title">Quality Check</h3>
          <p class="action-description">Mark job as completed</p>
        </div>
      </button>
    </div>
  </div>
</div>