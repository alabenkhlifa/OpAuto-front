import{a as ce}from"./chunk-5P3BWFFY.js";import{b as ie,d as ae,g as re,o as oe,p as le,q as se,v as W}from"./chunk-VYILSR5J.js";import{$ as F,A as f,Aa as z,B as x,Ba as A,C as D,E as w,Ea as U,F as Y,J as o,La as $,M as y,Ma as K,Na as X,Oa as Z,Pa as k,R as Q,S as j,Ua as ee,W as _,Wa as te,X as C,Xa as ne,_ as S,a as O,aa as M,ba as i,ca as a,da as h,ea as v,fa as m,ga as d,la as q,ma as V,na as u,oa as l,pa as g,qa as p,ra as N,ta as E,ua as T,va as P,x as J,z as b,za as I}from"./chunk-JES5V5RQ.js";function ge(r,t){if(r&1&&(i(0,"span",9),l(1),a()),r&2){let n=d();o(),p(" ",n.job.approvalRequests.length," pending ")}}function ue(r,t){if(r&1&&(i(0,"div",13)(1,"div",24)(2,"span",25),l(3,"Progress"),a(),i(4,"span",26),l(5),a()(),i(6,"div",27),h(7,"div",28),a()()),r&2){let n=d();o(5),p("",n.getTaskProgress(n.job),"%"),o(2),q("width",n.getTaskProgress(n.job),"%")}}function be(r,t){if(r&1&&(i(0,"p",17),l(1),a()),r&2){let n=d();o(),g(n.job.description)}}function fe(r,t){if(r&1&&(i(0,"span"),l(1),I(2,"date"),a()),r&2){let n=d();o(),p("Completed: ",A(2,1,n.job.completionDate,"short"))}}function he(r,t){if(r&1&&(i(0,"span"),l(1),I(2,"date"),a()),r&2){let n=d();o(),p("Started: ",A(2,1,n.job.startDate,"short"))}}function _e(r,t){if(r&1){let n=v();i(0,"button",20),m("click",function(){b(n);let c=d();return f(c.edit.emit(c.job.id))}),l(1," Edit "),a()}if(r&2){let n=d();u(n.view==="list"?"btn-warning btn-sm":"flex-1 btn-warning")}}function Ce(r,t){if(r&1){let n=v();i(0,"button",29),m("click",function(){b(n);let c=d();return f(c.changeStatus("in-progress"))}),x(),i(1,"svg",30),h(2,"path",31),a()()}if(r&2){let n=d();u(n.view==="list"?"btn-success btn-sm btn-icon":"btn-success btn-icon"),o(),u(n.view==="list"?"w-3 h-3":"w-4 h-4")}}function ve(r,t){if(r&1){let n=v();i(0,"button",32),m("click",function(){b(n);let c=d();return f(c.changeStatus("completed"))}),x(),i(1,"svg",30),h(2,"path",33),a()()}if(r&2){let n=d();u(n.view==="list"?"btn-success btn-sm btn-icon":"btn-success btn-icon"),o(),u(n.view==="list"?"w-3 h-3":"w-4 h-4")}}var R=class r{job;view="grid";statusChange=new j;edit=new j;viewDetails=new j;getStatusLabel(t){return{waiting:"Waiting","in-progress":"In Progress","waiting-approval":"Needs Approval","waiting-parts":"Waiting for Parts",completed:"Completed",cancelled:"Cancelled"}[t]||t}getStatusColor(t){return{waiting:"bg-yellow-400","in-progress":"bg-blue-500","waiting-approval":"bg-orange-500","waiting-parts":"bg-purple-500",completed:"bg-green-500",cancelled:"bg-gray-500"}[t]||"bg-gray-500"}getStatusTextColor(t){return{waiting:"text-yellow-700 dark:text-yellow-300","in-progress":"text-blue-700 dark:text-blue-300","waiting-approval":"text-orange-700 dark:text-orange-300","waiting-parts":"text-purple-700 dark:text-purple-300",completed:"text-green-700 dark:text-green-300",cancelled:"text-gray-700 dark:text-gray-300"}[t]||"text-gray-700 dark:text-gray-300"}getPriorityBadgeClass(t){return{low:"badge badge-priority-low",medium:"badge badge-priority-medium",high:"badge badge-priority-high",urgent:"badge badge-priority-urgent"}[t]||"badge badge-priority-medium"}getTaskProgress(t){if(t.tasks.length===0)return 0;let n=t.tasks.filter(e=>e.status==="completed").length;return Math.round(n/t.tasks.length*100)}formatCurrency(t){return new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND",minimumFractionDigits:0}).format(t)}changeStatus(t){this.statusChange.emit({jobId:this.job.id,status:t})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=y({type:r,selectors:[["app-maintenance-job-card"]],inputs:{job:"job",view:"view"},outputs:{statusChange:"statusChange",edit:"edit",viewDetails:"viewDetails"},decls:53,vars:33,consts:[[1,"glass-card"],[1,"flex","items-start","justify-between","mb-4"],[1,"flex-1","min-w-0"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-500","dark:text-gray-400","mt-1"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center"],[1,"w-3","h-3","rounded-full","mr-2"],[1,"text-sm","font-medium"],[1,"approval-badge"],[1,"grid","grid-cols-2","gap-4","mb-4"],[1,"text-xs","text-gray-500","dark:text-gray-400","uppercase","tracking-wide"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mb-4"],[1,"grid","grid-cols-2","gap-4","mb-4","text-sm"],[1,"text-gray-500","dark:text-gray-400"],[1,"font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-600","dark:text-gray-300","mb-4"],[1,"flex","justify-between","text-xs","text-gray-500","dark:text-gray-400","mb-4"],[1,"flex","space-x-2"],[3,"click"],[3,"class"],["title","Start Job",3,"class"],["title","Complete Job",3,"class"],[1,"flex","justify-between","text-sm","mb-1"],[1,"text-gray-600","dark:text-gray-400"],[1,"text-gray-900","dark:text-white"],[1,"w-full","bg-gray-200","dark:bg-gray-700","rounded-full","h-2"],[1,"bg-gradient-to-r","from-blue-500","to-green-500","h-2","rounded-full","transition-all"],["title","Start Job",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h8m-3-5h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["title","Complete Job",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),l(4),a(),i(5,"p",4),l(6),a()(),i(7,"span"),l(8),I(9,"titlecase"),a()(),i(10,"div",5)(11,"div",6),h(12,"div",7),i(13,"span",8),l(14),a()(),_(15,ge,2,1,"span",9),a(),i(16,"div",10)(17,"div")(18,"p",11),l(19,"Customer"),a(),i(20,"p",12),l(21),a()(),i(22,"div")(23,"p",11),l(24,"Mechanic"),a(),i(25,"p",12),l(26),a()()(),_(27,ue,8,3,"div",13),i(28,"div",14)(29,"div")(30,"p",15),l(31,"Mileage"),a(),i(32,"p",16),l(33),I(34,"number"),a()(),i(35,"div")(36,"p",15),l(37,"Est. Cost"),a(),i(38,"p",16),l(39),a()()(),_(40,be,2,1,"p",17),i(41,"div",18)(42,"span"),l(43),I(44,"date"),a(),_(45,fe,3,4,"span")(46,he,3,4,"span"),a(),i(47,"div",19)(48,"button",20),m("click",function(){return e.viewDetails.emit(e.job.id)}),l(49," View Details "),a(),_(50,_e,2,2,"button",21),_(51,Ce,3,4,"button",22)(52,ve,3,4,"button",23),a()()),n&2){let c;o(4),p(" ",e.job.jobTitle," "),o(2),N(" ",e.job.carDetails," \u2022 ",e.job.licensePlate," "),o(),u(e.getPriorityBadgeClass(e.job.priority)),o(),p(" ",z(9,26,e.job.priority)," "),o(4),u(e.getStatusColor(e.job.status)),o(),u(e.getStatusTextColor(e.job.status)),o(),p(" ",e.getStatusLabel(e.job.status)," "),o(),C(e.job.status==="waiting-approval"&&e.job.approvalRequests.length>0?15:-1),o(6),g(e.job.customerName),o(5),g(e.job.mechanicName),o(),C(e.job.tasks.length>0?27:-1),o(6),p("",z(34,28,e.job.currentMileage)," km"),o(6),g(e.formatCurrency(e.job.estimatedCost)),o(),C(e.view==="list"||e.job.description.length<100?40:-1),o(3),p("Created: ",A(44,30,e.job.createdAt,"short")),o(2),C(e.job.completionDate?45:e.job.startDate?46:-1),o(2),u(e.view==="list"?"justify-end":""),o(),u(e.view==="list"?"btn-tertiary btn-sm":"flex-1 btn-tertiary"),o(2),C(e.job.status!=="completed"&&e.job.status!=="cancelled"?50:-1),o(),C((c=e.job.status)==="waiting"?51:c==="in-progress"?52:-1)}},dependencies:[k,Z,K,X],styles:[".glass-card[_ngcontent-%COMP%]{cursor:pointer}.glass-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d1d5db!important}.glass-card[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-400[_ngcontent-%COMP%]{color:#9ca3af!important}.glass-card[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   .text-gray-600[_ngcontent-%COMP%]{color:#d1d5db!important}.approval-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .75rem;font-size:.75rem;font-weight:600;border-radius:16px;background:linear-gradient(135deg,#f59e0be6,#d97706e6)!important;color:#fff!important;border:1px solid rgba(245,158,11,.6)!important;box-shadow:0 2px 8px #f59e0b66;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.8}}"]})};function xe(r,t){if(r&1&&(i(0,"div",6)(1,"div",1)(2,"div",7)(3,"p",3),l(4,"Avg Completion Time"),a(),i(5,"p",8),l(6),a()()(),i(7,"div",1)(8,"div",7)(9,"p",3),l(10,"Revenue Today"),a(),i(11,"p",8),l(12),a()()(),i(13,"div",1)(14,"div",7)(15,"p",3),l(16,"Weekly Efficiency"),a(),i(17,"p",8),l(18),a()()()()),r&2){let n=d();o(6),p("",((n.stats==null?null:n.stats.averageCompletionTime)||0).toFixed(1),"h"),o(6),g(n.formatCurrency((n.stats==null?null:n.stats.revenueToday)||0)),o(6),p("",((n.stats==null?null:n.stats.efficiency)||0).toFixed(1),"%")}}var L=class r{stats=null;view="grid";formatCurrency(t){return new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND",minimumFractionDigits:0}).format(t)}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=y({type:r,selectors:[["app-maintenance-stats"]],inputs:{stats:"stats",view:"view"},decls:38,vars:5,consts:[[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"glass-card"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-300"],[1,"text-2xl","font-bold","text-white"],[1,"text-2xl"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mt-4"],[1,"text-center"],[1,"text-xl","font-bold","text-white"]],template:function(n,e){n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"p",3),l(5,"Total Jobs"),a(),i(6,"p",4),l(7),a()(),i(8,"div",5),l(9,"\u{1F4CB}"),a()()(),i(10,"div",1)(11,"div",2)(12,"div")(13,"p",3),l(14,"Active Jobs"),a(),i(15,"p",4),l(16),a()(),i(17,"div",5),l(18,"\u23F1\uFE0F"),a()()(),i(19,"div",1)(20,"div",2)(21,"div")(22,"p",3),l(23,"Completed Today"),a(),i(24,"p",4),l(25),a()(),i(26,"div",5),l(27,"\u2705"),a()()(),i(28,"div",1)(29,"div",2)(30,"div")(31,"p",3),l(32,"Pending Approvals"),a(),i(33,"p",4),l(34),a()(),i(35,"div",5),l(36,"\u26A0\uFE0F"),a()()()(),_(37,xe,19,3,"div",6)),n&2&&(o(7),g((e.stats==null?null:e.stats.totalJobs)||0),o(9),g((e.stats==null?null:e.stats.activeJobs)||0),o(9),g((e.stats==null?null:e.stats.completedToday)||0),o(9),g((e.stats==null?null:e.stats.pendingApprovals)||0),o(3),C(e.view==="list"||e.view==="dashboard"?37:-1))},dependencies:[k],encapsulation:2})};var de=(r,t)=>t.value,Me=(r,t)=>t.id,we=(r,t)=>t.label;function ye(r,t){if(r&1&&(i(0,"option",11),l(1),a()),r&2){let n=t.$implicit;M("value",n.value),o(),g(n.label)}}function Se(r,t){if(r&1&&(i(0,"option",11),l(1),a()),r&2){let n=t.$implicit;M("value",n.value),o(),g(n.label)}}function Fe(r,t){if(r&1&&(i(0,"option",11),l(1),a()),r&2){let n=t.$implicit;M("value",n.id),o(),g(n.name)}}function ke(r,t){if(r&1){let n=v();i(0,"button",17),m("click",function(){let c=b(n).$implicit,s=d();return f(s.applyQuickFilter(c))}),l(1),a()}if(r&2){let n=t.$implicit,e=d();u(e.isQuickFilterActive(n)?"btn-filter-chip active":"btn-filter-chip"),o(),p(" ",n.label," ")}}var B=class r{filters={};filtersChange=new j;localFilters={};selectedStatus="";selectedPriority="";startDate="";endDate="";statusOptions=[{value:"waiting",label:"Waiting"},{value:"in-progress",label:"In Progress"},{value:"waiting-approval",label:"Needs Approval"},{value:"waiting-parts",label:"Waiting for Parts"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}];priorityOptions=[{value:"urgent",label:"Urgent"},{value:"high",label:"High"},{value:"medium",label:"Medium"},{value:"low",label:"Low"}];mechanicOptions=[{id:"mechanic-001",name:"Mohamed Trabelsi"},{id:"mechanic-002",name:"Ali Sassi"},{id:"mechanic-003",name:"Ahmed Bouzid"}];quickFilters=[{label:"High Priority",filter:{priority:["high","urgent"]}},{label:"Needs Approval",filter:{status:["waiting-approval"]}},{label:"In Progress",filter:{status:["in-progress"]}},{label:"Today",filter:{dateRange:this.getTodayRange()}},{label:"This Week",filter:{dateRange:this.getThisWeekRange()}}];ngOnInit(){this.localFilters=O({},this.filters),this.initializeFormFields()}ngOnChanges(){this.localFilters=O({},this.filters),this.initializeFormFields()}initializeFormFields(){this.selectedStatus=this.localFilters.status?.[0]||"",this.selectedPriority=this.localFilters.priority?.[0]||"",this.localFilters.dateRange&&(this.startDate=this.formatDateForInput(this.localFilters.dateRange.start),this.endDate=this.formatDateForInput(this.localFilters.dateRange.end))}onFilterChange(){this.filtersChange.emit(this.localFilters)}onStatusChange(t){t?this.localFilters.status=[t]:delete this.localFilters.status,this.onFilterChange()}onPriorityChange(t){t?this.localFilters.priority=[t]:delete this.localFilters.priority,this.onFilterChange()}onDateRangeChange(){this.startDate&&this.endDate?this.localFilters.dateRange={start:new Date(this.startDate),end:new Date(this.endDate)}:delete this.localFilters.dateRange,this.onFilterChange()}clearFilters(){this.localFilters={},this.selectedStatus="",this.selectedPriority="",this.startDate="",this.endDate="",this.onFilterChange()}applyQuickFilter(t){this.localFilters=O({},t.filter),this.initializeFormFields(),this.onFilterChange()}isQuickFilterActive(t){return t.filter.status?this.localFilters.status?.includes(t.filter.status[0])||!1:t.filter.priority&&this.localFilters.priority?.some(n=>t.filter.priority.includes(n))||!1}getTodayRange(){let t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59);return{start:n,end:e}}getThisWeekRange(){let t=new Date,n=new Date(t);n.setDate(t.getDate()-t.getDay()),n.setHours(0,0,0,0);let e=new Date(n);return e.setDate(n.getDate()+6),e.setHours(23,59,59,999),{start:n,end:e}}formatDateForInput(t){return t.toISOString().split("T")[0]}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=y({type:r,selectors:[["app-maintenance-filters"]],inputs:{filters:"filters"},outputs:{filtersChange:"filtersChange"},features:[Y],decls:49,vars:6,consts:[[1,"glass-card"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-medium","text-white"],[1,"btn-clear-filters",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-300","mb-1"],["type","text","placeholder","Job title, customer, license plate...",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"mt-4","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:text-white","text-sm",3,"ngModelChange","ngModel"],[1,"mt-4","flex","flex-wrap","gap-2"],[3,"class"],[3,"click"]],template:function(n,e){n&1&&(i(0,"div",0)(1,"div",1)(2,"h3",2),l(3,"Filters"),a(),i(4,"button",3),m("click",function(){return e.clearFilters()}),x(),i(5,"svg",4),h(6,"path",5),a(),l(7," Clear All "),a()(),D(),i(8,"div",6)(9,"div")(10,"label",7),l(11," Search "),a(),i(12,"input",8),P("ngModelChange",function(s){return T(e.localFilters.searchTerm,s)||(e.localFilters.searchTerm=s),s}),m("ngModelChange",function(){return e.onFilterChange()}),a()(),i(13,"div")(14,"label",7),l(15," Status "),a(),i(16,"select",9),P("ngModelChange",function(s){return T(e.selectedStatus,s)||(e.selectedStatus=s),s}),m("ngModelChange",function(s){return e.onStatusChange(s)}),i(17,"option",10),l(18,"All Statuses"),a(),S(19,ye,2,2,"option",11,de),a()(),i(21,"div")(22,"label",7),l(23," Priority "),a(),i(24,"select",9),P("ngModelChange",function(s){return T(e.selectedPriority,s)||(e.selectedPriority=s),s}),m("ngModelChange",function(s){return e.onPriorityChange(s)}),i(25,"option",10),l(26,"All Priorities"),a(),S(27,Se,2,2,"option",11,de),a()(),i(29,"div")(30,"label",7),l(31," Mechanic "),a(),i(32,"select",9),P("ngModelChange",function(s){return T(e.localFilters.mechanicId,s)||(e.localFilters.mechanicId=s),s}),m("ngModelChange",function(){return e.onFilterChange()}),i(33,"option",10),l(34,"All Mechanics"),a(),S(35,Fe,2,2,"option",11,Me),a()()(),i(37,"div",12)(38,"div")(39,"label",13),l(40," From Date "),a(),i(41,"input",14),P("ngModelChange",function(s){return T(e.startDate,s)||(e.startDate=s),s}),m("ngModelChange",function(){return e.onDateRangeChange()}),a()(),i(42,"div")(43,"label",13),l(44," To Date "),a(),i(45,"input",14),P("ngModelChange",function(s){return T(e.endDate,s)||(e.endDate=s),s}),m("ngModelChange",function(){return e.onDateRangeChange()}),a()()(),i(46,"div",15),S(47,ke,2,3,"button",16,we),a()()),n&2&&(o(12),E("ngModel",e.localFilters.searchTerm),o(4),E("ngModel",e.selectedStatus),o(3),F(e.statusOptions),o(5),E("ngModel",e.selectedPriority),o(3),F(e.priorityOptions),o(5),E("ngModel",e.localFilters.mechanicId),o(3),F(e.mechanicOptions),o(6),E("ngModel",e.startDate),o(4),E("ngModel",e.endDate),o(2),F(e.quickFilters))},dependencies:[k,W,le,se,ie,oe,ae,re],styles:[".glass-card[_ngcontent-%COMP%]{background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.6);border-radius:20px;padding:1.5rem;box-shadow:0 8px 32px #000000b3;transition:all .3s cubic-bezier(.4,0,.2,1);margin-bottom:1rem}.glass-card[_ngcontent-%COMP%]:hover{background:#1f2937fa;box-shadow:0 12px 40px #000c;border-color:#3b82f6b3;transform:translateY(-2px)}.glass-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   .text-gray-700[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-600[_ngcontent-%COMP%]{color:#d1d5db!important}.glass-card[_ngcontent-%COMP%]   .text-gray-300[_ngcontent-%COMP%]{color:#9ca3af!important}"]})};var Ee=(r,t)=>t.value,Te=(r,t)=>t.id;function Pe(r,t){if(r&1){let n=v();i(0,"div",21)(1,"app-maintenance-filters",22),m("filtersChange",function(c){b(n);let s=d();return f(s.onFiltersChange(c))}),a()()}if(r&2){let n=d();o(),M("filters",n.filters())}}function De(r,t){if(r&1){let n=v();i(0,"button",23),m("click",function(){let c=b(n).$implicit,s=d();return f(s.setView(c.value))}),l(1),a()}if(r&2){let n=t.$implicit,e=d();V("active",e.currentView()===n.value),o(),p(" ",n.label," ")}}function je(r,t){r&1&&(i(0,"div",19),x(),i(1,"svg",24),h(2,"path",25),a(),D(),i(3,"h3",26),l(4,"No maintenance jobs"),a(),i(5,"p",27),l(6,'Use the "New Job" button in the top right to create a new maintenance job.'),a()())}function Ie(r,t){if(r&1){let n=v();i(0,"app-maintenance-job-card",30),m("statusChange",function(c){b(n);let s=d(2);return f(s.onStatusChange(c))})("edit",function(c){b(n);let s=d(2);return f(s.editJob(c))})("viewDetails",function(c){b(n);let s=d(2);return f(s.viewJob(c))}),a()}if(r&2){let n=t.$implicit,e=d(2);M("job",n)("view",e.getViewForCard())}}function Oe(r,t){if(r&1&&(i(0,"div",28),S(1,Ie,1,2,"app-maintenance-job-card",29,Te),a()),r&2){let n=d();u(n.getGridClasses()),o(),F(n.filteredJobs())}}var me=class r{maintenanceService=J(ce);router=J(te);route=J(ee);maintenanceJobs=w([]);stats=w(null);filters=w({});showFilters=w(!1);currentView=w("grid");loading=w(!1);isMobile=w(!1);viewOptions=[{value:"grid",label:"Grid"},{value:"list",label:"List"}];filteredJobs=U(()=>{let t=this.maintenanceJobs(),n=this.filters(),e=this.getViewFilter(),c=t.filter(s=>!(e.status&&!e.status.includes(s.status)));return this.applyAdditionalFilters(c,n)});ngOnInit(){this.loadMaintenanceData(),this.loadStats(),this.checkMobileView();let t=this.route.snapshot.url[1]?.path;t&&this.setViewFromRoute(t),typeof window<"u"&&window.addEventListener("resize",()=>this.checkMobileView())}checkMobileView(){typeof window<"u"&&this.isMobile.set(window.innerWidth<1024)}loadMaintenanceData(){this.loading.set(!0),this.maintenanceService.getMaintenanceJobs(this.filters()).subscribe({next:t=>{this.maintenanceJobs.set(t),this.loading.set(!1)},error:t=>{console.error("Error loading maintenance jobs:",t),this.loading.set(!1)}})}loadStats(){this.maintenanceService.getMaintenanceStats().subscribe({next:t=>this.stats.set(t),error:t=>console.error("Error loading stats:",t)})}setViewFromRoute(t){switch(t){case"active":this.filters.set({status:["waiting","in-progress","waiting-approval","waiting-parts"]});break;case"history":this.filters.set({status:["completed"]}),this.currentView.set("list");break;case"schedule":this.filters.set({status:["waiting"]});break}}getViewFilter(){switch(this.route.snapshot.url[1]?.path){case"active":return{status:["waiting","in-progress","waiting-approval","waiting-parts"]};case"history":return{status:["completed","cancelled"]};case"schedule":return{status:["waiting"]};default:return{}}}applyAdditionalFilters(t,n){return t.filter(e=>{if(n.priority&&n.priority.length>0&&!n.priority.includes(e.priority)||n.mechanicId&&e.mechanicId!==n.mechanicId)return!1;if(n.searchTerm){let c=n.searchTerm.toLowerCase();if(![e.jobTitle,e.description,e.licensePlate,e.customerName].join(" ").toLowerCase().includes(c))return!1}return!0})}getPageTitle(){switch(this.route.snapshot.url[1]?.path){case"active":return"Active Maintenance Jobs";case"history":return"Maintenance History";case"schedule":return"Scheduled Maintenance";default:return"Maintenance Management"}}getPageDescription(){switch(this.route.snapshot.url[1]?.path){case"active":return"Monitor ongoing repairs and services";case"history":return"View completed maintenance records";case"schedule":return"Manage upcoming maintenance appointments";default:return"Manage vehicle maintenance and repairs"}}getJobsTitle(){switch(this.route.snapshot.url[1]?.path){case"active":return"Active Jobs";case"history":return"Completed Jobs";case"schedule":return"Scheduled Jobs";default:return"All Jobs"}}setView(t){this.currentView.set(t)}getGridClasses(){return this.isMobile()?"grid-cols-1":this.currentView()==="grid"?"grid-cols-1 lg:grid-cols-2 xl:grid-cols-3":"grid-cols-1"}getViewForCard(){return this.isMobile()?"list":this.currentView()}onFiltersChange(t){this.filters.set(t),this.loadMaintenanceData()}onStatusChange(t){this.maintenanceService.updateJobStatus(t.jobId,t.status).subscribe({next:()=>this.loadMaintenanceData(),error:n=>console.error("Error updating job status:",n)})}createNewJob(){this.router.navigate(["/maintenance/new"])}editJob(t){this.router.navigate(["/maintenance/edit",t])}viewJob(t){this.router.navigate(["/maintenance/details",t])}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=y({type:r,selectors:[["app-maintenance"]],decls:31,vars:12,consts:[[1,"min-h-screen","maintenance-container","p-4","lg:p-6"],[1,"glass-card","maintenance-header"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4"],[1,"flex-1"],[1,"text-2xl","lg:text-3xl","font-bold","text-white","mb-1"],[1,"text-gray-300"],[1,"flex","items-center","gap-3"],[1,"btn-filter-toggle",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],[1,"btn-primary",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["class","glass-card filters-panel",4,"ngIf"],[1,"glass-card"],[3,"stats","view"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-white"],[1,"view-toggle"],[1,"view-toggle-btn",3,"active"],[1,"empty-state","text-center","py-12"],[1,"grid","gap-4",3,"class"],[1,"glass-card","filters-panel"],[3,"filtersChange","filters"],[1,"view-toggle-btn",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"mt-2","text-sm","font-medium","text-white"],[1,"mt-1","text-sm","text-gray-300"],[1,"grid","gap-4"],[3,"job","view"],[3,"statusChange","edit","viewDetails","job","view"]],template:function(n,e){n&1&&(i(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"h1",4),l(5),a(),i(6,"p",5),l(7),a()(),i(8,"div",6)(9,"button",7),m("click",function(){return e.showFilters.set(!e.showFilters())}),x(),i(10,"svg",8),h(11,"path",9),a(),D(),i(12,"span"),l(13,"Filters"),a()(),i(14,"button",10),m("click",function(){return e.createNewJob()}),x(),i(15,"svg",8),h(16,"path",11),a(),D(),i(17,"span"),l(18,"New Job"),a()()()()(),Q(19,Pe,2,1,"div",12),i(20,"div",13),h(21,"app-maintenance-stats",14),a(),i(22,"div",13)(23,"div",15)(24,"h2",16),l(25),a(),i(26,"div",17),S(27,De,2,3,"button",18,Ee),a()(),_(29,je,7,0,"div",19)(30,Oe,3,2,"div",20),a()()),n&2&&(o(5),p(" ",e.getPageTitle()," "),o(2),g(e.getPageDescription()),o(2),V("active",e.showFilters()),o(10),M("ngIf",e.showFilters()),o(2),M("stats",e.stats())("view",e.currentView()),o(4),N(" ",e.getJobsTitle()," (",e.filteredJobs().length,") "),o(),V("hidden",e.isMobile()),o(),F(e.viewOptions),o(2),C(e.filteredJobs().length===0?29:30))},dependencies:[k,$,ne,W,R,L,B],styles:[".maintenance-container[_ngcontent-%COMP%]{min-height:100vh;background:transparent}.glass-card[_ngcontent-%COMP%]{background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.6);border-radius:20px;padding:1.5rem;box-shadow:0 8px 32px #000000b3;transition:all .3s cubic-bezier(.4,0,.2,1);margin-bottom:1rem}.glass-card[_ngcontent-%COMP%]:hover{background:#1f2937fa;box-shadow:0 12px 40px #000c;border-color:#3b82f6b3;transform:translateY(-2px)}.filters-panel[_ngcontent-%COMP%]{background:#111827e6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.4);border-radius:20px;box-shadow:0 8px 32px #00000080;transition:all .3s cubic-bezier(.4,0,.2,1)}.filters-panel[_ngcontent-%COMP%]:hover{transform:translateY(-2px);background:#1f2937f2;box-shadow:0 12px 40px #0009}.view-toggle[_ngcontent-%COMP%]{display:flex;background:#1f293799;border-radius:12px;padding:.25rem;gap:.25rem}.view-toggle.hidden[_ngcontent-%COMP%]{display:none!important}.view-toggle-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem;font-weight:500;border-radius:8px;transition:all .2s ease;color:#9ca3af;cursor:pointer}.view-toggle-btn.active[_ngcontent-%COMP%]{background:#3b82f6cc;color:#fff;box-shadow:0 2px 8px #3b82f64d}.view-toggle-btn[_ngcontent-%COMP%]:not(.active):hover{background:#4b556366;color:#d1d5db}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff!important}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d1d5db!important}"]})};export{me as MaintenanceComponent};
