import{a as ue}from"./chunk-BGMVLO5C.js";import{b as R}from"./chunk-KSNCH7NH.js";import{a as ge}from"./chunk-UJO3757W.js";import{b as se,d as le,h as ce,p as pe,q as de,r as me,y as z}from"./chunk-O3CTDYVO.js";import{b as N,c as D}from"./chunk-ECECQ7NF.js";import{c as ae,e as re,f as oe}from"./chunk-5NENZ4M5.js";import{$ as S,$a as y,$b as ie,Ab as c,Bb as W,Ca as F,Fb as Z,Ha as q,Ja as J,Sa as v,Ta as h,U as C,Wa as T,Xa as E,Xb as ee,Ya as w,Z as x,Za as a,Zb as te,_,_a as r,_b as ne,a as L,aa as B,ab as M,ac as I,bb as f,cb as g,ga as k,hb as U,ia as Y,ib as A,jb as b,kb as s,lb as m,mb as u,nb as P,qb as j,rb as O,sa as i,sb as V,tb as X,zb as l}from"./chunk-DMTVNCDT.js";function be(o,n){if(o&1&&(a(0,"span",9),s(1),l(2,"translate"),r()),o&2){let e=g();i(),P(" ",e.job.approvalRequests.length," ",c(2,2,"maintenance.pending")," ")}}function xe(o,n){if(o&1&&(a(0,"div",13)(1,"div",22)(2,"span",23),s(3),l(4,"translate"),r(),a(5,"span",24),s(6),r()(),a(7,"div",25),y(8,"div",26),r()()),o&2){let e=g();i(3),m(c(4,4,"maintenance.progress")),i(3),u("",e.getTaskProgress(e.job),"%"),i(2),U("width",e.getTaskProgress(e.job),"%")}}function _e(o,n){if(o&1&&(a(0,"div",14)(1,"div")(2,"p",27),s(3),l(4,"translate"),r(),a(5,"p",28),s(6),l(7,"number"),r()(),a(8,"div")(9,"p",27),s(10),l(11,"translate"),r(),a(12,"p",28),s(13),r()()()),o&2){let e=g();i(3),m(c(4,4,"maintenance.mileage")),i(3),u("",c(7,6,e.job.currentMileage)," km"),i(4),m(c(11,8,"maintenance.estimatedCost")),i(3),m(e.formatCurrency(e.job.estimatedCost))}}function Ce(o,n){if(o&1&&(a(0,"div",15)(1,"div")(2,"p",27),s(3),l(4,"translate"),r(),a(5,"p",28),s(6),l(7,"number"),r()()()),o&2){let e=g();i(3),m(c(4,2,"maintenance.mileage")),i(3),u("",c(7,4,e.job.currentMileage)," km")}}function we(o,n){if(o&1&&(a(0,"p",16),s(1),r()),o&2){let e=g();i(),m(e.job.description)}}function ye(o,n){if(o&1&&(a(0,"span"),s(1),l(2,"translate"),l(3,"date"),r()),o&2){let e=g();i(),P("",c(2,2,"maintenance.completed"),": ",W(3,4,e.job.completionDate,"short"))}}function Me(o,n){if(o&1&&(a(0,"span"),s(1),l(2,"translate"),l(3,"date"),r()),o&2){let e=g();i(),P("",c(2,2,"maintenance.started"),": ",W(3,4,e.job.startDate,"short"))}}function Se(o,n){if(o&1){let e=M();a(0,"button",19),f("click",function(){x(e);let p=g();return _(p.edit.emit(p.job.id))}),s(1),l(2,"translate"),r()}if(o&2){let e=g();b(e.view==="list"?"btn-warning btn-sm":"flex-1 btn-warning"),i(),u(" ",c(2,3,"maintenance.actions.edit")," ")}}function ke(o,n){if(o&1){let e=M();a(0,"button",29),l(1,"translate"),f("click",function(){x(e);let p=g();return _(p.changeStatus("in-progress"))}),S(),a(2,"svg",30),y(3,"path",31),r()()}if(o&2){let e=g();b(e.view==="list"?"btn-success btn-sm btn-icon":"btn-success btn-icon"),w("title",c(1,5,"maintenance.startJob")),i(2),b(e.view==="list"?"w-3 h-3":"w-4 h-4")}}function Fe(o,n){if(o&1){let e=M();a(0,"button",29),l(1,"translate"),f("click",function(){x(e);let p=g();return _(p.changeStatus("completed"))}),S(),a(2,"svg",30),y(3,"path",32),r()()}if(o&2){let e=g();b(e.view==="list"?"btn-success btn-sm btn-icon":"btn-success btn-icon"),w("title",c(1,5,"maintenance.completeJob")),i(2),b(e.view==="list"?"w-3 h-3":"w-4 h-4")}}var G=class o{translationService=C(N);authService=C(R);job;view="grid";statusChange=new J;edit=new J;viewDetails=new J;getStatusLabel(n){let t={waiting:"waiting","in-progress":"inProgress","waiting-approval":"needsApproval","waiting-parts":"waitingParts",completed:"completed",cancelled:"cancelled"}[n]||"completed";return this.translationService.instant(`maintenance.status.${t}`)}getStatusColor(n){return{waiting:"bg-yellow-400","in-progress":"bg-blue-500","waiting-approval":"bg-orange-500","waiting-parts":"bg-purple-500",completed:"bg-green-500",cancelled:"bg-gray-500"}[n]||"bg-gray-500"}getStatusTextColor(n){return{waiting:"text-yellow-700 dark:text-yellow-300","in-progress":"text-blue-700 dark:text-blue-300","waiting-approval":"text-orange-700 dark:text-orange-300","waiting-parts":"text-purple-700 dark:text-purple-300",completed:"text-green-700 dark:text-green-300",cancelled:"text-gray-700 dark:text-gray-300"}[n]||"text-gray-700 dark:text-gray-300"}getPriorityBadgeClass(n){return{low:"badge badge-priority-low",medium:"badge badge-priority-medium",high:"badge badge-priority-high",urgent:"badge badge-priority-urgent"}[n]||"badge badge-priority-medium"}getTaskProgress(n){if(n.tasks.length===0)return 0;let e=n.tasks.filter(t=>t.status==="completed").length;return Math.round(e/n.tasks.length*100)}formatCurrency(n){return new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND",minimumFractionDigits:0}).format(n)}changeStatus(n){this.statusChange.emit({jobId:this.job.id,status:n})}getServiceName(n){let e=`serviceNames.${n}`,t=this.translationService.instant(e);return t===e?n:t}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=F({type:o,selectors:[["app-maintenance-job-card"]],inputs:{job:"job",view:"view"},outputs:{statusChange:"statusChange",edit:"edit",viewDetails:"viewDetails"},decls:47,vars:42,consts:[[1,"glass-card"],[1,"flex","items-start","justify-between","mb-4"],[1,"flex-1","min-w-0"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-500","dark:text-gray-400","mt-1"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","items-center"],[1,"w-3","h-3","rounded-full","mr-2"],[1,"text-sm","font-medium"],[1,"approval-badge"],[1,"grid","grid-cols-2","gap-4","mb-4"],[1,"text-xs","text-gray-500","dark:text-gray-400","uppercase","tracking-wide"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mb-4"],[1,"grid","grid-cols-2","gap-4","mb-4","text-sm"],[1,"mb-4","text-sm"],[1,"text-sm","text-gray-600","dark:text-gray-300","mb-4"],[1,"flex","justify-between","text-xs","text-gray-500","dark:text-gray-400","mb-4"],[1,"flex","space-x-2"],[3,"click"],[3,"class"],[3,"class","title"],[1,"flex","justify-between","text-sm","mb-1"],[1,"text-gray-600","dark:text-gray-400"],[1,"text-gray-900","dark:text-white"],[1,"w-full","bg-gray-200","dark:bg-gray-700","rounded-full","h-2"],[1,"bg-gradient-to-r","from-blue-500","to-green-500","h-2","rounded-full","transition-all"],[1,"text-gray-500","dark:text-gray-400"],[1,"font-medium","text-gray-900","dark:text-white"],[3,"click","title"],["fill","none","viewBox","0 0 24 24","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h8m-3-5h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(e,t){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),s(4),r(),a(5,"p",4),s(6),r()(),a(7,"span"),s(8),l(9,"translate"),r()(),a(10,"div",5)(11,"div",6),y(12,"div",7),a(13,"span",8),s(14),r()(),v(15,be,3,4,"span",9),r(),a(16,"div",10)(17,"div")(18,"p",11),s(19),l(20,"translate"),r(),a(21,"p",12),s(22),r()(),a(23,"div")(24,"p",11),s(25),l(26,"translate"),r(),a(27,"p",12),s(28),r()()(),v(29,xe,9,6,"div",13),v(30,_e,14,10,"div",14)(31,Ce,8,6,"div",15),v(32,we,2,1,"p",16),a(33,"div",17)(34,"span"),s(35),l(36,"translate"),l(37,"date"),r(),v(38,ye,4,7,"span")(39,Me,4,7,"span"),r(),a(40,"div",18)(41,"button",19),f("click",function(){return t.viewDetails.emit(t.job.id)}),s(42),l(43,"translate"),r(),v(44,Se,3,5,"button",20),v(45,ke,4,7,"button",21)(46,Fe,4,7,"button",21),r()()),e&2){let p;i(4),u(" ",t.getServiceName(t.job.jobTitle)," "),i(2),P(" ",t.job.carDetails," \u2022 ",t.job.licensePlate," "),i(),b(t.getPriorityBadgeClass(t.job.priority)),i(),u(" ",c(9,29,"maintenance.priority."+t.job.priority)," "),i(4),b(t.getStatusColor(t.job.status)),i(),b(t.getStatusTextColor(t.job.status)),i(),u(" ",t.getStatusLabel(t.job.status)," "),i(),h(t.job.status==="waiting-approval"&&t.job.approvalRequests.length>0?15:-1),i(4),m(c(20,31,"maintenance.customer")),i(3),m(t.job.customerName),i(3),m(c(26,33,"maintenance.mechanic")),i(3),m(t.job.mechanicName),i(),h(t.job.tasks.length>0?29:-1),i(),h(t.authService.isOwner()?30:31),i(2),h(t.view==="list"||t.job.description.length<100?32:-1),i(3),P("",c(36,35,"maintenance.created"),": ",W(37,37,t.job.createdAt,"short")),i(3),h(t.job.completionDate?38:t.job.startDate?39:-1),i(2),b(t.view==="list"?"justify-end":""),i(),b(t.view==="list"?"btn-tertiary btn-sm":"flex-1 btn-tertiary"),i(),u(" ",c(43,40,"maintenance.actions.viewDetails")," "),i(2),h(t.job.status!=="completed"&&t.job.status!=="cancelled"?44:-1),i(),h((p=t.job.status)==="waiting"?45:p==="in-progress"?46:-1)}},dependencies:[I,ie,ne,D],styles:[".glass-card[_ngcontent-%COMP%]{cursor:pointer}.glass-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d1d5db!important}.glass-card[_ngcontent-%COMP%]   .text-gray-500[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-400[_ngcontent-%COMP%]{color:#9ca3af!important}.glass-card[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   .text-gray-600[_ngcontent-%COMP%]{color:#d1d5db!important}.approval-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .75rem;font-size:.75rem;font-weight:600;border-radius:16px;background:linear-gradient(135deg,#f59e0be6,#d97706e6)!important;color:#fff!important;border:1px solid rgba(245,158,11,.6)!important;box-shadow:0 2px 8px #f59e0b66;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.8}}"]})};function Te(o,n){if(o&1&&(a(0,"div",1)(1,"div",7)(2,"p",3),s(3),l(4,"translate"),r(),a(5,"p",8),s(6),r()()()),o&2){let e=g(2);i(3),m(c(4,2,"maintenance.revenueToday")),i(3),m(e.formatCurrency((e.stats==null?null:e.stats.revenueToday)||0))}}function Ee(o,n){if(o&1&&(a(0,"div",6)(1,"div",1)(2,"div",7)(3,"p",3),s(4),l(5,"translate"),r(),a(6,"p",8),s(7),r()()(),v(8,Te,7,4,"div",1),a(9,"div",1)(10,"div",7)(11,"p",3),s(12),l(13,"translate"),r(),a(14,"p",8),s(15),r()()()()),o&2){let e=g();i(4),m(c(5,5,"maintenance.avgCompletionTime")),i(3),u("",((e.stats==null?null:e.stats.averageCompletionTime)||0).toFixed(1),"h"),i(),h(e.authService.isOwner()?8:-1),i(4),m(c(13,7,"maintenance.weeklyEfficiency")),i(3),u("",((e.stats==null?null:e.stats.efficiency)||0).toFixed(1),"%")}}var H=class o{authService=C(R);stats=null;view="grid";formatCurrency(n){return new Intl.NumberFormat("fr-TN",{style:"currency",currency:"TND",minimumFractionDigits:0}).format(n)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=F({type:o,selectors:[["app-maintenance-stats"]],inputs:{stats:"stats",view:"view"},decls:42,vars:17,consts:[[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"glass-card"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-gray-300"],[1,"text-2xl","font-bold","text-white"],[1,"text-2xl"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mt-4"],[1,"text-center"],[1,"text-xl","font-bold","text-white"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"p",3),s(5),l(6,"translate"),r(),a(7,"p",4),s(8),r()(),a(9,"div",5),s(10,"\u{1F4CB}"),r()()(),a(11,"div",1)(12,"div",2)(13,"div")(14,"p",3),s(15),l(16,"translate"),r(),a(17,"p",4),s(18),r()(),a(19,"div",5),s(20,"\u23F1\uFE0F"),r()()(),a(21,"div",1)(22,"div",2)(23,"div")(24,"p",3),s(25),l(26,"translate"),r(),a(27,"p",4),s(28),r()(),a(29,"div",5),s(30,"\u2705"),r()()(),a(31,"div",1)(32,"div",2)(33,"div")(34,"p",3),s(35),l(36,"translate"),r(),a(37,"p",4),s(38),r()(),a(39,"div",5),s(40,"\u26A0\uFE0F"),r()()()(),v(41,Ee,16,9,"div",6)),e&2&&(i(5),m(c(6,9,"maintenance.totalJobs")),i(3),m((t.stats==null?null:t.stats.totalJobs)||0),i(7),m(c(16,11,"maintenance.activeJobs")),i(3),m((t.stats==null?null:t.stats.activeJobs)||0),i(7),m(c(26,13,"maintenance.completedToday")),i(3),m((t.stats==null?null:t.stats.completedToday)||0),i(7),m(c(36,15,"maintenance.pendingApprovals")),i(3),m((t.stats==null?null:t.stats.pendingApprovals)||0),i(3),h(t.view==="list"||t.view==="dashboard"||t.view==="history"?41:-1))},dependencies:[I,D],encapsulation:2})};var fe=(o,n)=>n.value,Pe=(o,n)=>n.key,Ie=(o,n)=>n.id;function De(o,n){if(o&1&&(a(0,"option",11),s(1),r()),o&2){let e=n.$implicit,t=g();w("value",e.value),i(),m(t.getStatusLabel(e.value))}}function je(o,n){if(o&1&&(a(0,"option",11),s(1),r()),o&2){let e=n.$implicit,t=g();w("value",e.value),i(),m(t.getPriorityLabel(e.value))}}function Oe(o,n){if(o&1&&(a(0,"option",11),s(1),r()),o&2){let e=n.$implicit;w("value",e.id),i(),m(e.name)}}function Ve(o,n){if(o&1){let e=M();a(0,"div")(1,"label",7),s(2),l(3,"translate"),r(),a(4,"select",9),V("ngModelChange",function(p){x(e);let d=g();return O(d.localFilters.mechanicId,p)||(d.localFilters.mechanicId=p),_(p)}),f("ngModelChange",function(){x(e);let p=g();return _(p.onFilterChange())}),a(5,"option",10),s(6),l(7,"translate"),r(),T(8,Oe,2,2,"option",11,Ie),r()()}if(o&2){let e=g();i(2),u(" ",c(3,3,"maintenance.filters.mechanic")," "),i(2),j("ngModel",e.localFilters.mechanicId),i(2),m(c(7,5,"maintenance.filters.allMechanics")),i(2),E(e.mechanicOptions)}}function Be(o,n){if(o&1){let e=M();a(0,"button",17),f("click",function(){let p=x(e).$implicit,d=g();return _(d.applyQuickFilter(p))}),s(1),r()}if(o&2){let e=n.$implicit,t=g();b(t.isQuickFilterActive(e)?"btn-filter-chip active":"btn-filter-chip"),i(),u(" ",t.getQuickFilterLabel(e.key)," ")}}var K=class o{translationService=C(N);subscriptionService=C(ge);filters={};filtersChange=new J;localFilters={};selectedStatus="";selectedPriority="";startDate="";endDate="";statusOptions=[{value:"waiting",key:"waiting"},{value:"in-progress",key:"inProgress"},{value:"waiting-approval",key:"needsApproval"},{value:"waiting-parts",key:"waitingParts"},{value:"completed",key:"completed"},{value:"cancelled",key:"cancelled"}];priorityOptions=[{value:"urgent",key:"urgent"},{value:"high",key:"high"},{value:"medium",key:"medium"},{value:"low",key:"low"}];mechanicOptions=[{id:"mechanic-001",name:"Mohamed Trabelsi"},{id:"mechanic-002",name:"Ali Sassi"},{id:"mechanic-003",name:"Ahmed Bouzid"}];quickFilters=[{key:"highPriority",filter:{priority:["high","urgent"]}},{key:"needsApproval",filter:{status:["waiting-approval"]}},{key:"inProgress",filter:{status:["in-progress"]}},{key:"today",filter:{dateRange:this.getTodayRange()}},{key:"thisWeek",filter:{dateRange:this.getThisWeekRange()}}];ngOnInit(){this.localFilters=L({},this.filters),this.initializeFormFields()}ngOnChanges(){this.localFilters=L({},this.filters),this.initializeFormFields()}initializeFormFields(){this.selectedStatus=this.localFilters.status?.[0]||"",this.selectedPriority=this.localFilters.priority?.[0]||"",this.localFilters.dateRange&&(this.startDate=this.formatDateForInput(this.localFilters.dateRange.start),this.endDate=this.formatDateForInput(this.localFilters.dateRange.end))}onFilterChange(){this.filtersChange.emit(this.localFilters)}onStatusChange(n){n?this.localFilters.status=[n]:delete this.localFilters.status,this.onFilterChange()}onPriorityChange(n){n?this.localFilters.priority=[n]:delete this.localFilters.priority,this.onFilterChange()}onDateRangeChange(){this.startDate&&this.endDate?this.localFilters.dateRange={start:new Date(this.startDate),end:new Date(this.endDate)}:delete this.localFilters.dateRange,this.onFilterChange()}clearFilters(){this.localFilters={},this.selectedStatus="",this.selectedPriority="",this.startDate="",this.endDate="",this.onFilterChange()}applyQuickFilter(n){this.localFilters=L({},n.filter),this.initializeFormFields(),this.onFilterChange()}isQuickFilterActive(n){return n.filter.status?this.localFilters.status?.includes(n.filter.status[0])||!1:n.filter.priority&&this.localFilters.priority?.some(e=>n.filter.priority.includes(e))||!1}getTodayRange(){let n=new Date,e=new Date(n.getFullYear(),n.getMonth(),n.getDate()),t=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59);return{start:e,end:t}}getThisWeekRange(){let n=new Date,e=new Date(n);e.setDate(n.getDate()-n.getDay()),e.setHours(0,0,0,0);let t=new Date(e);return t.setDate(e.getDate()+6),t.setHours(23,59,59,999),{start:e,end:t}}formatDateForInput(n){return n.toISOString().split("T")[0]}getStatusLabel(n){let t={waiting:"waiting","in-progress":"inProgress","waiting-approval":"needsApproval","waiting-parts":"waitingParts",completed:"completed",cancelled:"cancelled"}[n]||"completed";return this.translationService.instant(`maintenance.status.${t}`)}getPriorityLabel(n){let t={urgent:"urgent",high:"high",medium:"medium",low:"low"}[n]||"medium";return this.translationService.instant(`maintenance.priority.${t}`)}getQuickFilterLabel(n){return this.translationService.instant(`maintenance.filters.quickFilters.${n}`)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=F({type:o,selectors:[["app-maintenance-filters"]],inputs:{filters:"filters"},outputs:{filtersChange:"filtersChange"},features:[Y],decls:52,vars:37,consts:[[1,"glass-card"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-medium","text-white"],[1,"btn-clear-filters",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-gray-300","mb-1"],["type","text",1,"form-input",3,"ngModelChange","ngModel","placeholder"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"mt-4","grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","shadow-sm","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:text-white","text-sm",3,"ngModelChange","ngModel"],[1,"mt-4","flex","flex-wrap","gap-2"],[3,"class"],[3,"click"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"div",1)(2,"h3",2),s(3),l(4,"translate"),r(),a(5,"button",3),f("click",function(){return t.clearFilters()}),S(),a(6,"svg",4),y(7,"path",5),r(),s(8),l(9,"translate"),r()(),B(),a(10,"div",6)(11,"div")(12,"label",7),s(13),l(14,"translate"),r(),a(15,"input",8),l(16,"translate"),V("ngModelChange",function(d){return O(t.localFilters.searchTerm,d)||(t.localFilters.searchTerm=d),d}),f("ngModelChange",function(){return t.onFilterChange()}),r()(),a(17,"div")(18,"label",7),s(19),l(20,"translate"),r(),a(21,"select",9),V("ngModelChange",function(d){return O(t.selectedStatus,d)||(t.selectedStatus=d),d}),f("ngModelChange",function(d){return t.onStatusChange(d)}),a(22,"option",10),s(23),l(24,"translate"),r(),T(25,De,2,2,"option",11,fe),r()(),a(27,"div")(28,"label",7),s(29),l(30,"translate"),r(),a(31,"select",9),V("ngModelChange",function(d){return O(t.selectedPriority,d)||(t.selectedPriority=d),d}),f("ngModelChange",function(d){return t.onPriorityChange(d)}),a(32,"option",10),s(33),l(34,"translate"),r(),T(35,je,2,2,"option",11,fe),r()(),v(37,Ve,10,7,"div"),r(),a(38,"div",12)(39,"div")(40,"label",13),s(41),l(42,"translate"),r(),a(43,"input",14),V("ngModelChange",function(d){return O(t.startDate,d)||(t.startDate=d),d}),f("ngModelChange",function(){return t.onDateRangeChange()}),r()(),a(44,"div")(45,"label",13),s(46),l(47,"translate"),r(),a(48,"input",14),V("ngModelChange",function(d){return O(t.endDate,d)||(t.endDate=d),d}),f("ngModelChange",function(){return t.onDateRangeChange()}),r()()(),a(49,"div",15),T(50,Be,2,3,"button",16,Pe),r()()),e&2&&(i(3),m(c(4,17,"maintenance.filters.title")),i(5),u(" ",c(9,19,"maintenance.filters.clearAll")," "),i(5),u(" ",c(14,21,"maintenance.filters.search")," "),i(2),w("placeholder",X(c(16,23,"maintenance.filters.searchPlaceholder"))),j("ngModel",t.localFilters.searchTerm),i(4),u(" ",c(20,25,"maintenance.filters.status")," "),i(2),j("ngModel",t.selectedStatus),i(2),m(c(24,27,"maintenance.filters.allStatuses")),i(2),E(t.statusOptions),i(4),u(" ",c(30,29,"maintenance.filters.priority")," "),i(2),j("ngModel",t.selectedPriority),i(2),m(c(34,31,"maintenance.filters.allPriorities")),i(2),E(t.priorityOptions),i(2),h(t.subscriptionService.currentTier()!=="solo"?37:-1),i(4),u(" ",c(42,33,"maintenance.filters.fromDate")," "),i(2),j("ngModel",t.startDate),i(3),u(" ",c(47,35,"maintenance.filters.toDate")," "),i(2),j("ngModel",t.endDate),i(2),E(t.quickFilters))},dependencies:[I,z,de,me,se,pe,le,ce,D],styles:[".glass-card[_ngcontent-%COMP%]{background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.6);border-radius:20px;padding:1.5rem;box-shadow:0 8px 32px #000000b3;transition:all .3s cubic-bezier(.4,0,.2,1);margin-bottom:1rem}.glass-card[_ngcontent-%COMP%]:hover{background:#1f2937fa;box-shadow:0 12px 40px #000c;border-color:#3b82f6b3;transform:translateY(-2px)}.glass-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-900[_ngcontent-%COMP%]{color:#fff!important}.glass-card[_ngcontent-%COMP%]   .text-gray-700[_ngcontent-%COMP%], .glass-card[_ngcontent-%COMP%]   .text-gray-600[_ngcontent-%COMP%]{color:#d1d5db!important}.glass-card[_ngcontent-%COMP%]   .text-gray-300[_ngcontent-%COMP%]{color:#9ca3af!important}"]})};var Je=(o,n)=>n.value,Ne=(o,n)=>n.id;function Le(o,n){if(o&1){let e=M();a(0,"div",21)(1,"app-maintenance-filters",22),f("filtersChange",function(p){x(e);let d=g();return _(d.onFiltersChange(p))}),r()()}if(o&2){let e=g();i(),w("filters",e.filters())}}function Ae(o,n){if(o&1){let e=M();a(0,"button",23),f("click",function(){let p=x(e).$implicit,d=g();return _(d.setView(p.value))}),s(1),l(2,"titlecase"),l(3,"translate"),r()}if(o&2){let e=n.$implicit,t=g();A("active",t.currentView()===e.value),i(),u(" ",c(3,5,"maintenance.view"+c(2,3,e.value))," ")}}function We(o,n){o&1&&(a(0,"div",19),S(),a(1,"svg",24),y(2,"path",25),r(),B(),a(3,"h3",26),s(4),l(5,"translate"),r(),a(6,"p",27),s(7),l(8,"translate"),r()()),o&2&&(i(4),m(c(5,2,"maintenance.noJobs")),i(3),m(c(8,4,"maintenance.noJobsMessage")))}function Re(o,n){if(o&1){let e=M();a(0,"app-maintenance-job-card",30),f("statusChange",function(p){x(e);let d=g(2);return _(d.onStatusChange(p))})("edit",function(p){x(e);let d=g(2);return _(d.editJob(p))})("viewDetails",function(p){x(e);let d=g(2);return _(d.viewJob(p))}),r()}if(o&2){let e=n.$implicit,t=g(2);w("job",e)("view",t.getViewForCard())}}function ze(o,n){if(o&1&&(a(0,"div",28),T(1,Re,1,2,"app-maintenance-job-card",29,Ne),r()),o&2){let e=g();b(e.getGridClasses()),i(),E(e.filteredJobs())}}var ve=class o{maintenanceService=C(ue);router=C(re);route=C(ae);translationService=C(N);maintenanceJobs=k([]);stats=k(null);filters=k({});showFilters=k(!1);currentView=k("grid");loading=k(!1);isMobile=k(!1);viewOptions=[{value:"grid",label:"Grid"},{value:"list",label:"List"}];filteredJobs=Z(()=>{let n=this.maintenanceJobs(),e=this.filters(),t=this.getViewFilter(),p=n.filter(d=>!(t.status&&!t.status.includes(d.status)));return this.applyAdditionalFilters(p,e)});ngOnInit(){this.loadMaintenanceData(),this.loadStats(),this.checkMobileView();let n=this.route.snapshot.url[1]?.path;n&&this.setViewFromRoute(n),typeof window<"u"&&window.addEventListener("resize",()=>this.checkMobileView())}checkMobileView(){typeof window<"u"&&this.isMobile.set(window.innerWidth<1024)}loadMaintenanceData(){this.loading.set(!0),this.maintenanceService.getMaintenanceJobs(this.filters()).subscribe({next:n=>{this.maintenanceJobs.set(n),this.loading.set(!1)},error:n=>{console.error("Error loading maintenance jobs:",n),this.loading.set(!1)}})}loadStats(){this.maintenanceService.getMaintenanceStats().subscribe({next:n=>this.stats.set(n),error:n=>console.error("Error loading stats:",n)})}setViewFromRoute(n){switch(n){case"active":this.filters.set({status:["waiting","in-progress","waiting-approval","waiting-parts"]});break;case"history":this.filters.set({status:["completed"]}),this.currentView.set("list");break;case"schedule":this.filters.set({status:["waiting"]});break}}getViewFilter(){switch(this.route.snapshot.url[1]?.path){case"active":return{status:["waiting","in-progress","waiting-approval","waiting-parts"]};case"history":return{status:["completed","cancelled"]};case"schedule":return{status:["waiting"]};default:return{}}}applyAdditionalFilters(n,e){return n.filter(t=>{if(e.priority&&e.priority.length>0&&!e.priority.includes(t.priority)||e.mechanicId&&t.mechanicId!==e.mechanicId)return!1;if(e.searchTerm){let p=e.searchTerm.toLowerCase();if(![t.jobTitle,t.description,t.licensePlate,t.customerName].join(" ").toLowerCase().includes(p))return!1}return!0})}getPageTitle(){switch(this.route.snapshot.url[1]?.path){case"active":return this.translationService.instant("maintenance.activeTitle");case"history":return this.translationService.instant("maintenance.historyTitle");case"schedule":return this.translationService.instant("maintenance.scheduleTitle");default:return this.translationService.instant("maintenance.title")}}getPageDescription(){switch(this.route.snapshot.url[1]?.path){case"active":return this.translationService.instant("maintenance.activeSubtitle");case"history":return this.translationService.instant("maintenance.historySubtitle");case"schedule":return this.translationService.instant("maintenance.scheduleSubtitle");default:return this.translationService.instant("maintenance.subtitle")}}getJobsTitle(){switch(this.route.snapshot.url[1]?.path){case"active":return this.translationService.instant("maintenance.activeJobs");case"history":return this.translationService.instant("maintenance.completedJobs");case"schedule":return this.translationService.instant("maintenance.scheduledJobs");default:return this.translationService.instant("maintenance.allJobs")}}getStatsView(){switch(this.route.snapshot.url[1]?.path){case"history":return"history";case"active":return"list";case"schedule":return"list";default:return this.currentView()}}setView(n){this.currentView.set(n)}getGridClasses(){return this.isMobile()?"grid-cols-1":this.currentView()==="grid"?"grid-cols-1 lg:grid-cols-2 xl:grid-cols-3":"grid-cols-1"}getViewForCard(){return this.isMobile()?"list":this.currentView()}onFiltersChange(n){this.filters.set(n),this.loadMaintenanceData()}onStatusChange(n){this.maintenanceService.updateJobStatus(n.jobId,n.status).subscribe({next:()=>this.loadMaintenanceData(),error:e=>console.error("Error updating job status:",e)})}createNewJob(){this.router.navigate(["/maintenance/new"])}editJob(n){this.router.navigate(["/maintenance/edit",n])}viewJob(n){this.router.navigate(["/maintenance/details",n])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=F({type:o,selectors:[["app-maintenance"]],decls:33,vars:18,consts:[[1,"min-h-screen","maintenance-container","p-4","lg:p-6"],[1,"glass-card","maintenance-header"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between","gap-4"],[1,"flex-1"],[1,"text-2xl","lg:text-3xl","font-bold","text-white","mb-1"],[1,"text-gray-300"],[1,"flex","items-center","gap-3"],[1,"btn-filter-toggle",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],[1,"btn-primary",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["class","glass-card filters-panel",4,"ngIf"],[1,"glass-card"],[3,"stats","view"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-lg","font-semibold","text-white"],[1,"view-toggle"],[1,"view-toggle-btn",3,"active"],[1,"empty-state","text-center","py-12"],[1,"grid","gap-4",3,"class"],[1,"glass-card","filters-panel"],[3,"filtersChange","filters"],[1,"view-toggle-btn",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"mt-2","text-sm","font-medium","text-white"],[1,"mt-1","text-sm","text-gray-300"],[1,"grid","gap-4"],[3,"job","view"],[3,"statusChange","edit","viewDetails","job","view"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"h1",4),s(5),r(),a(6,"p",5),s(7),r()(),a(8,"div",6)(9,"button",7),f("click",function(){return t.showFilters.set(!t.showFilters())}),S(),a(10,"svg",8),y(11,"path",9),r(),B(),a(12,"span"),s(13),l(14,"translate"),r()(),a(15,"button",10),f("click",function(){return t.createNewJob()}),S(),a(16,"svg",8),y(17,"path",11),r(),B(),a(18,"span"),s(19),l(20,"translate"),r()()()()(),q(21,Le,2,1,"div",12),a(22,"div",13),y(23,"app-maintenance-stats",14),r(),a(24,"div",13)(25,"div",15)(26,"h2",16),s(27),r(),a(28,"div",17),T(29,Ae,4,7,"button",18,Je),r()(),v(31,We,9,6,"div",19)(32,ze,3,2,"div",20),r()()),e&2&&(i(5),u(" ",t.getPageTitle()," "),i(2),m(t.getPageDescription()),i(2),A("active",t.showFilters()),i(4),m(c(14,14,"common.filters")),i(6),m(c(20,16,"maintenance.newJob")),i(2),w("ngIf",t.showFilters()),i(2),w("stats",t.stats())("view",t.getStatsView()),i(4),P(" ",t.getJobsTitle()," (",t.filteredJobs().length,") "),i(),A("hidden",t.isMobile()),i(),E(t.viewOptions),i(2),h(t.filteredJobs().length===0?31:32))},dependencies:[I,ee,te,oe,z,G,H,K,D],styles:[".maintenance-container[_ngcontent-%COMP%]{min-height:100vh;background:transparent}.glass-card[_ngcontent-%COMP%]{background:#111827f2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.6);border-radius:20px;padding:1.5rem;box-shadow:0 8px 32px #000000b3;transition:all .3s cubic-bezier(.4,0,.2,1);margin-bottom:1rem}.glass-card[_ngcontent-%COMP%]:hover{background:#1f2937fa;box-shadow:0 12px 40px #000c;border-color:#3b82f6b3;transform:translateY(-2px)}.filters-panel[_ngcontent-%COMP%]{background:#111827e6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(75,85,99,.4);border-radius:20px;box-shadow:0 8px 32px #00000080;transition:all .3s cubic-bezier(.4,0,.2,1)}.filters-panel[_ngcontent-%COMP%]:hover{transform:translateY(-2px);background:#1f2937f2;box-shadow:0 12px 40px #0009}.view-toggle[_ngcontent-%COMP%]{display:flex;background:#1f293799;border-radius:12px;padding:.25rem;gap:.25rem}.view-toggle.hidden[_ngcontent-%COMP%]{display:none!important}.view-toggle-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem;font-weight:500;border-radius:8px;transition:all .2s ease;color:#9ca3af;cursor:pointer}.view-toggle-btn.active[_ngcontent-%COMP%]{background:#3b82f6cc;color:#fff;box-shadow:0 2px 8px #3b82f64d}.view-toggle-btn[_ngcontent-%COMP%]:not(.active):hover{background:#4b556366;color:#d1d5db}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff!important}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#d1d5db!important}"]})};export{ve as MaintenanceComponent};
