import{E as u,a as c,b as m,f as l,h as a,u as h}from"./chunk-JES5V5RQ.js";var g=class d{appointmentsSubject=new l([]);appointments$=this.appointmentsSubject.asObservable();selectedDate=u(new Date);viewMode=u("day");mockAppointments=this.generateMockAppointments();mockCars=[{id:"car1",licensePlate:"123 TUN 2024",make:"BMW",model:"X5",year:2020,customerId:"customer1"},{id:"car2",licensePlate:"456 TUN 2019",make:"Honda",model:"Civic",year:2019,customerId:"customer2"},{id:"car3",licensePlate:"789 TUN 2021",make:"Toyota",model:"Camry",year:2021,customerId:"customer1"},{id:"car4",licensePlate:"321 TUN 2022",make:"Mercedes",model:"C-Class",year:2022,customerId:"customer3"},{id:"car5",licensePlate:"654 TUN 2020",make:"Audi",model:"A4",year:2020,customerId:"customer4"}];mockCustomers=[{id:"customer1",name:"Ahmed Ben Ali",phone:"+216-20-123-456",email:"ahmed.benali@email.tn"},{id:"customer2",name:"Fatma Trabelsi",phone:"+216-25-789-123",email:"fatma.trabelsi@email.tn"},{id:"customer3",name:"Mohamed Khemir",phone:"+216-22-456-789",email:"mohamed.khemir@email.tn"},{id:"customer4",name:"Leila Mansouri",phone:"+216-28-654-321",email:"leila.mansouri@email.tn"}];mockMechanics=[{id:"mechanic1",name:"Karim Mechanic",specialties:["oil-change","inspection","engine"],isAvailable:!0,currentWorkload:2},{id:"mechanic2",name:"Slim Technician",specialties:["brake-repair","transmission","electrical"],isAvailable:!0,currentWorkload:1},{id:"mechanic3",name:"Hedi Expert",specialties:["bodywork","painting","tires"],isAvailable:!1,currentWorkload:3}];generateMockAppointments(){let t=new Date,e=new Date(t);e.setDate(e.getDate()-1);let n=new Date(t);return n.setDate(n.getDate()+1),[{id:"1",carId:"car1",customerId:"customer1",mechanicId:"mechanic1",serviceType:"oil-change",serviceName:"Oil Change & Filter Replacement",scheduledDate:new Date(e.getFullYear(),e.getMonth(),e.getDate(),8,30),estimatedDuration:90,status:"completed",notes:"Regular maintenance - customer requested synthetic oil",priority:"medium",createdAt:new Date,updatedAt:new Date},{id:"2",carId:"car2",customerId:"customer2",mechanicId:"mechanic2",serviceType:"brake-repair",serviceName:"Front Brake Pads Replacement",scheduledDate:new Date(e.getFullYear(),e.getMonth(),e.getDate(),14,0),estimatedDuration:120,status:"completed",notes:"Customer reported squeaking noise",priority:"high",createdAt:new Date,updatedAt:new Date},{id:"3",carId:"car3",customerId:"customer1",mechanicId:"mechanic1",serviceType:"inspection",serviceName:"Annual Technical Inspection",scheduledDate:new Date(t.getFullYear(),t.getMonth(),t.getDate(),9,30),estimatedDuration:60,status:"scheduled",priority:"low",createdAt:new Date,updatedAt:new Date},{id:"4",carId:"car4",customerId:"customer3",mechanicId:"mechanic2",serviceType:"engine",serviceName:"Engine Diagnostic & Tune-up",scheduledDate:new Date(t.getFullYear(),t.getMonth(),t.getDate(),11,0),estimatedDuration:180,status:"in-progress",notes:"Check engine light is on",priority:"high",createdAt:new Date,updatedAt:new Date},{id:"5",carId:"car5",customerId:"customer4",mechanicId:"mechanic1",serviceType:"tires",serviceName:"Tire Rotation & Balancing",scheduledDate:new Date(t.getFullYear(),t.getMonth(),t.getDate(),16,30),estimatedDuration:45,status:"scheduled",priority:"low",createdAt:new Date,updatedAt:new Date},{id:"6",carId:"car2",customerId:"customer2",mechanicId:"mechanic2",serviceType:"transmission",serviceName:"Transmission Fluid Change",scheduledDate:new Date(n.getFullYear(),n.getMonth(),n.getDate(),8,0),estimatedDuration:60,status:"scheduled",notes:"Scheduled maintenance",priority:"medium",createdAt:new Date,updatedAt:new Date},{id:"7",carId:"car1",customerId:"customer1",mechanicId:"mechanic1",serviceType:"electrical",serviceName:"Battery & Alternator Check",scheduledDate:new Date(n.getFullYear(),n.getMonth(),n.getDate(),10,30),estimatedDuration:90,status:"scheduled",notes:"Customer reports starting issues",priority:"high",createdAt:new Date,updatedAt:new Date},{id:"8",carId:"car3",customerId:"customer1",mechanicId:"mechanic3",serviceType:"bodywork",serviceName:"Minor Dent Repair",scheduledDate:new Date(n.getFullYear(),n.getMonth(),n.getDate(),14,0),estimatedDuration:120,status:"scheduled",priority:"low",createdAt:new Date,updatedAt:new Date}]}constructor(){this.appointmentsSubject.next(this.mockAppointments)}getAppointments(){return this.appointments$}getAppointmentsByDate(t){let e=new Date(t);e.setHours(0,0,0,0);let n=new Date(t);n.setHours(23,59,59,999);let i=this.mockAppointments.filter(r=>r.scheduledDate>=e&&r.scheduledDate<=n);return a(i)}createAppointment(t){let e=m(c({},t),{id:Date.now().toString(),createdAt:new Date,updatedAt:new Date});return this.mockAppointments.push(e),this.appointmentsSubject.next([...this.mockAppointments]),a(e)}updateAppointment(t,e){let n=this.mockAppointments.findIndex(i=>i.id===t);if(n!==-1)return this.mockAppointments[n]=m(c(c({},this.mockAppointments[n]),e),{updatedAt:new Date}),this.appointmentsSubject.next([...this.mockAppointments]),a(this.mockAppointments[n]);throw new Error("Appointment not found")}deleteAppointment(t){let e=this.mockAppointments.findIndex(n=>n.id===t);return e!==-1?(this.mockAppointments.splice(e,1),this.appointmentsSubject.next([...this.mockAppointments]),a(!0)):a(!1)}getAvailableSlots(t,e){let n=[],i=new Date(t);i.setHours(8,0,0,0);for(let r=8;r<18;r++)for(let s=0;s<60;s+=30){let o=new Date(i);o.setHours(r,s,0,0);let p=new Date(o);p.setMinutes(o.getMinutes()+e);let A=!this.isSlotConflict(o,p);n.push({startTime:o,endTime:p,isAvailable:A})}return a(n)}isSlotConflict(t,e){return this.mockAppointments.some(n=>{let i=n.scheduledDate,r=new Date(i.getTime()+n.estimatedDuration*6e4);return t<r&&e>i})}getCars(){return a(this.mockCars)}getCustomers(){return a(this.mockCustomers)}getMechanics(){return a(this.mockMechanics)}getGarageCapacity(){return a({totalLifts:5,availableLifts:3,totalMechanics:2,availableMechanics:2,workingHours:{start:"08:00",end:"18:00"}})}searchAppointments(t){let e=this.mockAppointments.filter(n=>n.serviceName.toLowerCase().includes(t.toLowerCase())||n.notes?.toLowerCase().includes(t.toLowerCase()));return a(e)}getAppointmentsByMechanic(t){let e=this.mockAppointments.filter(n=>n.mechanicId===t);return a(e)}getAppointmentsByStatus(t){let e=this.mockAppointments.filter(n=>n.status===t);return a(e)}getCarById(t){return this.mockCars.find(e=>e.id===t)}getCustomerById(t){return this.mockCustomers.find(e=>e.id===t)}getMechanicById(t){return this.mockMechanics.find(e=>e.id===t)}getCustomerByCar(t){let e=this.getCarById(t);return e?this.getCustomerById(e.customerId):void 0}getAppointmentWithDetails(t){let e=this.mockAppointments.find(s=>s.id===t);if(!e)throw new Error("Appointment not found");let n=this.getCarById(e.carId),i=this.getCustomerById(e.customerId),r=this.getMechanicById(e.mechanicId);return a(m(c({},e),{car:n,customer:i,mechanic:r}))}static \u0275fac=function(e){return new(e||d)};static \u0275prov=h({token:d,factory:d.\u0275fac,providedIn:"root"})};export{g as a};
